
R version 3.5.3 (2019-03-11) -- "Great Truth"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "Publish"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> options(pager = "console")
> library('Publish')
Loading required package: prodlim
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("CiTable")
> ### * CiTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: CiTable
> ### Title: CiTable data
> ### Aliases: CiTable
> ### Keywords: datasets
> 
> ### ** Examples
> 
> 
> data(CiTable)
> labellist <- split(CiTable[,c("Dose","Mean","SD","n")],CiTable[,"Drug"])
> labellist
$Bisoprolol
         Dose Mean   SD    n
7   <5 mg/day  4.5 1.00 1700
8  6-9 mg/day  7.5 0.29  337
9  >10 mg/day 14.3 4.20  831
16  <5 mg/day  4.3 1.10 1334
17 6-9 mg/day  7.5 0.30  357
18 >10 mg/day 12.6 3.70  818
25  <5 mg/day  4.3 1.10 1144
26 6-9 mg/day  7.5 0.30  170
27 >10 mg/day 11.9 3.40  774

$Carvedilol
             Dose Mean   SD    n
4    <12.5 mg/day 10.2  3.0 3915
5  12.6-49 mg/day 26.3  6.0 3155
6      >50 mg/day 54.9 11.3 1957
13   <12.5 mg/day 10.4  2.9 2879
14 12.6-49 mg/day 27.5  6.6 3687
15     >50 mg/day 53.9  9.8 2844
22   <12.5 mg/day 10.5  2.9 1634
23 12.6-49 mg/day 28.3  6.9 2747
24     >50 mg/day 53.6  9.4 3336

$Metropolol
             Dose  Mean   SD     n
1     >200 mg/day 200.0  0.0  2989
2     <100 mg/day  64.6 25.8 25049
3  101-199 mg/day 144.3 10.5  4929
10    >200 mg/day 200.0  0.0  2927
11    <100 mg/day  67.4 26.3 19561
12 101-199 mg/day 144.3 10.5  3863
19    >200 mg/day 200.0  0.0  2559
20    <100 mg/day  66.6 27.5 14190
21 101-199 mg/day 145.3  9.8  2133

> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")], labels=labellist)
> 
> 
> 
> 
> 
> cleanEx()
> nameEx("Diabetes")
> ### * Diabetes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Diabetes
> ### Title: Diabetes data of Dr John Schorling
> ### Aliases: Diabetes
> ### Keywords: datasets
> 
> ### ** Examples
> 
> 
> data(Diabetes)
> 
> 
> 
> 
> cleanEx()
> nameEx("SpaceT")
> ### * SpaceT
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SpaceT
> ### Title: A study was made of all 26 astronauts on the first eight space
> ###   shuttle flights (Bungo et.al., 1985). On a voluntary basis 17
> ###   astronauts consumed large quantities of salt and fluid prior to
> ###   landing as a countermeasure to space deconditioning, while nine did
> ###   not.
> ### Aliases: SpaceT
> 
> ### ** Examples
> 
> data(SpaceT)
> 
> 
> 
> cleanEx()
> nameEx("Units")
> ### * Units
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Units
> ### Title: Add units to data set
> ### Aliases: Units
> 
> ### ** Examples
> 
> data(Diabetes)
> Diabetes <- Units(Diabetes,list(BMI="kg/m^2"))
> Units(Diabetes)
$BMI
[1] "kg/m^2"

> Diabetes <- Units(Diabetes,list(bp.1s="mm Hg",bp.2s="mm Hg"))
> Units(Diabetes)
$bp.1s
[1] "mm Hg"

$bp.2s
[1] "mm Hg"

$BMI
[1] "kg/m^2"

> 
> 
> 
> cleanEx()
> nameEx("coxphSeries")
> ### * coxphSeries
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: coxphSeries
> ### Title: Run a series of Cox regression models
> ### Aliases: coxphSeries
> 
> ### ** Examples
> 
> library(survival)
> data(pbc)
> ## collect hazard ratios from three univariate Cox regression analyses
> pbc$edema <- factor(pbc$edema,levels=c("0","0.5","1"),labels=c("0","0.5","1"))
> uni.hr <- coxphSeries(Surv(time,status==2)~1,vars=c("edema","bili","protime"),data=pbc)
> uni.hr
     edema 
[1,] List,7
[2,] List,7
[3,] List,7
> 
> ## control the logistic regression analyses for age and gender
> ## but collect only information on the variables in `vars'.
> controlled.hr <- coxphSeries(Surv(time,status==2)~age+sex,vars=c("edema","bili","protime"),data=pbc)
> controlled.hr
     edema 
[1,] List,7
[2,] List,7
[3,] List,7
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("followupTable")
> ### * followupTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: followupTable
> ### Title: Summary tables for a given followup time point.
> ### Aliases: followupTable
> 
> ### ** Examples
> 
> library(survival)
> data(pbc)
> pbc$edema <- factor(pbc$edema,levels=c("0","0.5","1"),labels=c("0","0.5","1"))
> pbc$sex <- factor(pbc$sex,levels=c("m","f"),labels=c("m","f"))
> followupTable(Hist(time,status)~age+edema+sex,data=pbc,followup.time=1000)
  Variable     Level    1 (n=7)   2 (n=76) unknown (n=8) Event-free (n=327)
1      age mean (sd) 42.2 (6.4) 55.6 (9.4)   48.7 (11.6)        49.9 (10.4)
2    edema         0  7 (100.0)  45 (59.2)     8 (100.0)         294 (89.9)
3                0.5    0 (0.0)  15 (19.7)       0 (0.0)           29 (8.9)
4                  1    0 (0.0)  16 (21.1)       0 (0.0)            4 (1.2)
5      sex         m   2 (28.6)   8 (10.5)       0 (0.0)          34 (10.4)
6                  f   5 (71.4)  68 (89.5)     8 (100.0)         293 (89.6)
  Total (n=418)
1   50.7 (10.4)
2    354 (84.7)
3     44 (10.5)
4      20 (4.8)
5     44 (10.5)
6    374 (89.5)
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("formatCI")
> ### * formatCI
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: formatCI
> ### Title: Formatting confidence intervals
> ### Aliases: formatCI
> 
> ### ** Examples
> 
> 
> x=ci.mean(rnorm(10))
> formatCI(lower=x[3],upper=x[4])
[1] "[-0.43;0.69]"
> formatCI(lower=c(0.001,-2.8413),upper=c(1,3.0008884))
[1] "[0.00;1.00]"  "[-2.84;3.00]"
> # change format
> formatCI(lower=c(0.001,-2.8413),upper=c(1,3.0008884),format="(l, u)")
[1] "(0.00, 1.00)"  "(-2.84, 3.00)"
> # show x
> formatCI(x=x$mean,lower=x$lower,upper=x$upper,format="(l, u)",show.x=TRUE)
[1] "0.13 (-0.43, 0.69)"
> 
> # if the first lower limit is shorter than the second (missing negative sign),
> # then, option trim will make a difference:
> formatCI(lower=c(0.001,-2.8413),upper=c(1,3.0008884),format="l--u",trim=FALSE)
[1] "0.00--1.00"  "-2.84--3.00"
> formatCI(lower=c(0.001,-2.8413),upper=c(1,3.0008884),format="l--u",trim=TRUE)
[1] "0.00--1.00"  "-2.84--3.00"
> 
> # change of handler function
> l <- c(-0.0890139,0.0084736,144.898333,0.000000001)
> u <- c(0.03911392,0.3784706,3338944.8821221,0.00001)
> cbind(format=formatCI(lower=l,upper=u,format="[l;u)",digits=2,nsmall=2,handler="format"),
+       prettyNum=formatCI(lower=l,upper=u,format="[l;u)",digits=2,nsmall=2,handler="prettyNum"),
+       sprintf=formatCI(lower=l,upper=u,format="[l;u)",digits=2,nsmall=2,handler="sprintf"))
     format               prettyNum             sprintf              
[1,] "[-8.9e-02;3.9e-02)" "[-0.089;0.039)"      "[-0.09;0.04)"       
[2,] "[ 8.5e-03;3.8e-01)" "[0.0085;0.38)"       "[0.01;0.38)"        
[3,] "[ 1.4e+02;3.3e+06)" "[144.90;3338944.88)" "[144.90;3338944.88)"
[4,] "[ 1.0e-09;1.0e-05)" "[1e-09;1e-05)"       "[0.00;0.00)"        
> 
> 
> 
> 
> cleanEx()
> nameEx("glmSeries")
> ### * glmSeries
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmSeries
> ### Title: Run a series of generalized linear regression analyses
> ### Aliases: glmSeries
> 
> ### ** Examples
> 
> 
> data(Diabetes)
> Diabetes$hyper1 <- factor(1*(Diabetes$bp.1s>140))
> ## collect odds ratios from three univariate logistic regression analyses
> uni.odds <- glmSeries(hyper1~1,vars=c("chol","hdl","location"),data=Diabetes,family=binomial)
> uni.odds
   Variable      Units Missing OddsRatio     Lower    Upper       Pvalue
1:     chol                  1 1.0083168 1.0034556 1.013202 0.0007822708
2:      hdl                  1 1.0007020 0.9886914 1.012858 0.9093130388
3: location Buckingham       0 1.0000000 1.0000000 1.000000 1.0000000000
4:              Louisa         0.8151139 0.5362587 1.238974 0.3386106778
> ## control the logistic regression analyses for age and gender
> ## but collect only information on the variables in `vars'.
> controlled.odds <- glmSeries(hyper1~age+gender,
+                              vars=c("chol","hdl","location"),
+                              data=Diabetes, family=binomial)
> controlled.odds
   Variable      Units Missing OddsRatio     Lower    Upper     Pvalue
1:     chol                  1 1.0047654 0.9996018 1.009956 0.07053352
2:      hdl                  1 0.9972631 0.9840331 1.010671 0.68752207
3: location Buckingham       0 1.0000000 1.0000000 1.000000 1.00000000
4:              Louisa         0.8250564 0.5219566 1.304166 0.41040466
> 
> 
> 
> cleanEx()
> nameEx("labelUnits")
> ### * labelUnits
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: labelUnits
> ### Title: labelUnits
> ### Aliases: labelUnits
> 
> ### ** Examples
> 
> 
> data(Diabetes)
> tab <- summary(univariateTable(gender~AgeGroups+chol+waist,data=Diabetes))
> publish(tab)
  Variable     Level female (n=234) male (n=169) Total (n=403) p-value 
 AgeGroups       <40      97 (41.5)    63 (37.3)    160 (39.7)         
               40-50      48 (20.5)    34 (20.1)     82 (20.3)         
               50-60      41 (17.5)    28 (16.6)     69 (17.1)         
               60-70      28 (12.0)    28 (16.6)     56 (13.9)         
                 >70       20 (8.5)     16 (9.5)      36 (8.9)  0.7212 
      chol mean (sd)   208.4 (43.7) 207.0 (45.5)  207.8 (44.4)  0.7537 
             missing              0            1             1         
     waist mean (sd)     38.1 (6.0)   37.6 (5.3)    37.9 (5.7)  0.3561 
             missing              1            1             2         
> ltab <- labelUnits(tab,"chol"="Cholesterol (mg/dL)","<40"="younger than 40")
> publish(ltab)
            Variable           Level female (n=234) male (n=169) Total (n=403) p-value 
           AgeGroups younger than 40      97 (41.5)    63 (37.3)    160 (39.7)         
                               40-50      48 (20.5)    34 (20.1)     82 (20.3)         
                               50-60      41 (17.5)    28 (16.6)     69 (17.1)         
                               60-70      28 (12.0)    28 (16.6)     56 (13.9)         
                                 >70       20 (8.5)     16 (9.5)      36 (8.9)  0.7212 
 Cholesterol (mg/dL)       mean (sd)   208.4 (43.7) 207.0 (45.5)  207.8 (44.4)  0.7537 
                             missing              0            1             1         
               waist       mean (sd)     38.1 (6.0)   37.6 (5.3)    37.9 (5.7)  0.3561 
                             missing              1            1             2         
> 
> ## pass labels immediately to utable
> utable(gender~AgeGroups+chol+waist,data=Diabetes,
+       "chol"="Cholesterol (mg/dL)","<40"="younger than 40")
             Variable           Level female (n=234) male (n=169) Total (n=403)
1           AgeGroups younger than 40      97 (41.5)    63 (37.3)    160 (39.7)
2                               40-50      48 (20.5)    34 (20.1)     82 (20.3)
3                               50-60      41 (17.5)    28 (16.6)     69 (17.1)
4                               60-70      28 (12.0)    28 (16.6)     56 (13.9)
5                                 >70       20 (8.5)     16 (9.5)      36 (8.9)
6 Cholesterol (mg/dL)       mean (sd)   208.4 (43.7) 207.0 (45.5)  207.8 (44.4)
7                             missing              0            1             1
8               waist       mean (sd)     38.1 (6.0)   37.6 (5.3)    37.9 (5.7)
9                             missing              1            1             2
  p-value
1        
2        
3        
4        
5  0.7212
6  0.7537
7        
8  0.3561
9        
> 
> ## sometimes useful to state explicitly which variables value
> ## should be re-labelled
> utable(gender~AgeGroups+chol+waist,data=Diabetes,
+       "chol"="Cholesterol (mg/dL)","AgeGroups.<40"="younger than 40")
             Variable           Level female (n=234) male (n=169) Total (n=403)
1           AgeGroups younger than 40      97 (41.5)    63 (37.3)    160 (39.7)
2                               40-50      48 (20.5)    34 (20.1)     82 (20.3)
3                               50-60      41 (17.5)    28 (16.6)     69 (17.1)
4                               60-70      28 (12.0)    28 (16.6)     56 (13.9)
5                                 >70       20 (8.5)     16 (9.5)      36 (8.9)
6 Cholesterol (mg/dL)       mean (sd)   208.4 (43.7) 207.0 (45.5)  207.8 (44.4)
7                             missing              0            1             1
8               waist       mean (sd)     38.1 (6.0)   37.6 (5.3)    37.9 (5.7)
9                             missing              1            1             2
  p-value
1        
2        
3        
4        
5  0.7212
6  0.7537
7        
8  0.3561
9        
> 
> 
> 
> cleanEx()
> nameEx("lazyFactorCoding")
> ### * lazyFactorCoding
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: lazyFactorCoding
> ### Title: Efficient coding of factor levels
> ### Aliases: lazyFactorCoding
> 
> ### ** Examples
> 
> data(Diabetes)
> lazyFactorCoding(Diabetes)
Diabetes$location <- factor(Diabetes$location,levels=c("Buckingham","Louisa"),labels=c("Buckingham","Louisa"))
Diabetes$gender <- factor(Diabetes$gender,levels=c("female","male"),labels=c("female","male"))
Diabetes$frame <- factor(Diabetes$frame,levels=c("large","medium","small"),labels=c("large","medium","small"))
Diabetes$AgeGroups <- factor(Diabetes$AgeGroups,levels=c("<40","40-50","50-60","60-70",">70"),labels=c("<40","40-50","50-60","60-70",">70"))
> 
> 
> 
> 
> cleanEx()
> nameEx("parseInteractionTerms")
> ### * parseInteractionTerms
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: parseInteractionTerms
> ### Title: Parse interaction terms
> ### Aliases: parseInteractionTerms
> 
> ### ** Examples
> 
> 
> tt <- terms(formula(SBP~age+sex*BMI))
> xlev <- list(sex=c("male","female"),BMI=c("normal","overweight","obese"))
> parseInteractionTerms(terms=tt,xlevels=xlev)
$`sex:BMI`
$`sex:BMI`$`sex(male): BMI(overweight vs normal)`
p["BMIoverweight"]

$`sex:BMI`$`sex(male): BMI(obese vs normal)`
p["BMIobese"]

$`sex:BMI`$`sex(female): BMI(overweight vs normal)`
p["BMIoverweight"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`sex(female): BMI(obese vs normal)`
p["BMIobese"] + p["sexfemale:BMIobese"]

$`sex:BMI`$`BMI(normal): sex(female vs male)`
p["sexfemale"]

$`sex:BMI`$`BMI(overweight): sex(female vs male)`
p["sexfemale"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`BMI(obese): sex(female vs male)`
p["sexfemale"] + p["sexfemale:BMIobese"]

attr(,"variables")
[1] "sex" "BMI"

> parseInteractionTerms(terms=tt,xlevels=xlev,format.factor="var level")
$`sex:BMI`
$`sex:BMI`$`sex male: BMI(overweight vs normal)`
p["BMIoverweight"]

$`sex:BMI`$`sex male: BMI(obese vs normal)`
p["BMIobese"]

$`sex:BMI`$`sex female: BMI(overweight vs normal)`
p["BMIoverweight"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`sex female: BMI(obese vs normal)`
p["BMIobese"] + p["sexfemale:BMIobese"]

$`sex:BMI`$`BMI normal: sex(female vs male)`
p["sexfemale"]

$`sex:BMI`$`BMI overweight: sex(female vs male)`
p["sexfemale"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`BMI obese: sex(female vs male)`
p["sexfemale"] + p["sexfemale:BMIobese"]

attr(,"variables")
[1] "sex" "BMI"

> parseInteractionTerms(terms=tt,xlevels=xlev,format.contrast="var(level:ref)")
$`sex:BMI`
$`sex:BMI`$`sex(male): BMI(overweight:normal)`
p["BMIoverweight"]

$`sex:BMI`$`sex(male): BMI(obese:normal)`
p["BMIobese"]

$`sex:BMI`$`sex(female): BMI(overweight:normal)`
p["BMIoverweight"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`sex(female): BMI(obese:normal)`
p["BMIobese"] + p["sexfemale:BMIobese"]

$`sex:BMI`$`BMI(normal): sex(female:male)`
p["sexfemale"]

$`sex:BMI`$`BMI(overweight): sex(female:male)`
p["sexfemale"] + p["sexfemale:BMIoverweight"]

$`sex:BMI`$`BMI(obese): sex(female:male)`
p["sexfemale"] + p["sexfemale:BMIobese"]

attr(,"variables")
[1] "sex" "BMI"

> 
> tt2 <- terms(formula(SBP~age*factor(sex)+BMI))
> xlev2 <- list("factor(sex)"=c("male","female"))
> parseInteractionTerms(terms=tt2,xlevels=xlev2)
$`age:factor(sex)`
$`age:factor(sex)`$`age: factor(sex)(male)`
p["age"]

$`age:factor(sex)`$`age: factor(sex)(female)`
p["age"] + p["age:factor(sex)female"]

attr(,"variables")
[1] "age"         "factor(sex)"

> parseInteractionTerms(terms=tt2,xlevels=xlev2,units=list(age="yrs"))
$`age:factor(sex)`
$`age:factor(sex)`$`age(yrs): factor(sex)(male)`
p["age"]

$`age:factor(sex)`$`age(yrs): factor(sex)(female)`
p["age"] + p["age:factor(sex)female"]

attr(,"variables")
[1] "age"         "factor(sex)"

> 
> 
> data(Diabetes)
> fit <- glm(bp.2s~age*factor(gender)+BMI,data=Diabetes)
> parseInteractionTerms(terms=terms(fit$formula),xlevels=fit$xlevels,
+                       format.scale="var -- level:ref",units=list("age"='years'))
$`age:factor(gender)`
$`age:factor(gender)`$`age(years): factor(gender)(female)`
p["age"]

$`age:factor(gender)`$`age(years): factor(gender)(male)`
p["age"] + p["age:factor(gender)male"]

attr(,"variables")
[1] "age"            "factor(gender)"

> parseInteractionTerms(terms=terms(fit$formula),xlevels=fit$xlevels,
+                       format.scale.unit="var -- level:ref",units=list("age"='years'))
$`age:factor(gender)`
$`age:factor(gender)`$`age -- level:ref: factor(gender)(female)`
p["age"]

$`age:factor(gender)`$`age -- level:ref: factor(gender)(male)`
p["age"] + p["age:factor(gender)male"]

attr(,"variables")
[1] "age"            "factor(gender)"

> it <- parseInteractionTerms(terms=terms(fit$formula),xlevels=fit$xlevels)
> ivars <- unlist(lapply(it,function(x)attr(x,"variables")))
> lava::estimate(fit,function(p)lapply(unlist(it),eval,envir=sys.parent(-1)))
                            Estimate Std.Err   2.5%  97.5%   P-value
age:factor(gender).ag....     0.5006  0.1713 0.1648 0.8364 0.0034833
age:factor(gender).ag.....1   0.5353  0.1450 0.2511 0.8195 0.0002225
> 
> 
> 
> 
> 
> cleanEx()
> nameEx("plot.ci")
> ### * plot.ci
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.ci
> ### Title: Plot confidence intervals
> ### Aliases: plot.ci
> 
> ### ** Examples
> 
> 
> data(Diabetes)
> x=ci.mean(bp.2s~AgeGroups,data=Diabetes)
> plot(x,title.labels="Age groups",xratio=c(0.4,0.3))
> x=ci.mean(bp.2s/500~AgeGroups+gender,data=Diabetes)
> plot(x,xratio=c(0.4,0.2))
> plot(x,xratio=c(0.4,0.2),
+      labels=split(x$labels[,"AgeGroups"],x$labels[,"gender"]),
+      title.labels="Age groups")
> ## Not run: 
> ##D plot(x, leftmargin=0, rightmargin=0)
> ##D plotConfidence(x, leftmargin=0, rightmargin=0)
> ##D 
> ##D data(CiTable)
> ##D with(CiTable,plotConfidence(x=list(HazardRatio),
> ##D                                lower=lower,
> ##D                                upper=upper,
> ##D                                labels=CiTable[,2:6],
> ##D                                factor.reference.pos=c(1,10,19),
> ##D                                format="(u-l)",
> ##D                                points.col="blue",
> ##D                                digits=2))
> ##D 
> ##D with(CiTable,Publish::plot.ci(x=list(HazardRatio),
> ##D                                lower=lower,
> ##D                                upper=upper,
> ##D                                labels=CiTable[,2:6],
> ##D                                factor.reference.pos=c(1,10,19),
> ##D                                format="(u-l)",
> ##D                                points.col="blue",
> ##D                                digits=2,
> ##D                                leftmargin=-2,
> ##D                                title.labels.cex=1.1,
> ##D                                labels.cex=0.8,values.cex=0.8))
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plot.regressionTable")
> ### * plot.regressionTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.regressionTable
> ### Title: Plotting regression coefficients with confidence limits
> ### Aliases: plot.regressionTable
> 
> ### ** Examples
> 
> ## linear regression
> data(Diabetes)
> f <- glm(bp.1s~AgeGroups+chol+gender+location,data=Diabetes)
> rtf <- regressionTable(f,factor.reference = "inline")
> plot(rtf,cex=1.3)
> 
> ## logistic regression
> data(Diabetes)
> f <- glm(I(BMI>25)~bp.1s+AgeGroups+chol+gender+location,data=Diabetes,family=binomial)
> rtf <- regressionTable(f,factor.reference = "inline")
> plot(rtf,cex=1.3)
> 
> ## Poisson regression
> data(trace)
> fit <- glm(dead ~ smoking+ sex+ age+Time+offset(log(ObsTime)), family = poisson,data=trace)
> rtab <- regressionTable(fit,factor.reference = "inline")
> plot(rtab,xlim=c(0.85,1.15),cex=1.8,xaxis.cex=1.5)
> 
> ## Cox regression
> library(survival)
> data(pbc)
> coxfit <- coxph(Surv(time,status!=0)~age+log(bili)+log(albumin)+factor(edema)+sex,data=pbc)
> pubcox <- publish(coxfit)
      Variable Units HazardRatio       CI.95   p-value 
           age              1.02 [1.01;1.04]   0.00254 
     log(bili)              2.35 [2.03;2.73]   < 0.001 
  log(albumin)              0.07 [0.02;0.22]   < 0.001 
 factor(edema)     0         Ref                       
                 0.5        1.45 [0.95;2.21]   0.08504 
                   1        2.97 [1.73;5.09]   < 0.001 
           sex     m         Ref                       
                   f        0.78 [0.51;1.19]   0.24575 
> plot(pubcox,cex=1.5,xratio=c(0.4,0.2))
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("plotConfidence")
> ### * plotConfidence
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotConfidence
> ### Title: Plot confidence intervals
> ### Aliases: plotConfidence
> 
> ### ** Examples
> 
> 
> library(Publish)
> data(CiTable) 
> 
> ## A first draft version of the plot is obtained as follows
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper","p")],
+           labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")])
> 
> ## if argument labels is a named list the table is subdivided:
> labellist <- split(CiTable[,c("Dose","Mean","SD","n")],CiTable[,"Drug"])
> labellist
$Bisoprolol
         Dose Mean   SD    n
7   <5 mg/day  4.5 1.00 1700
8  6-9 mg/day  7.5 0.29  337
9  >10 mg/day 14.3 4.20  831
16  <5 mg/day  4.3 1.10 1334
17 6-9 mg/day  7.5 0.30  357
18 >10 mg/day 12.6 3.70  818
25  <5 mg/day  4.3 1.10 1144
26 6-9 mg/day  7.5 0.30  170
27 >10 mg/day 11.9 3.40  774

$Carvedilol
             Dose Mean   SD    n
4    <12.5 mg/day 10.2  3.0 3915
5  12.6-49 mg/day 26.3  6.0 3155
6      >50 mg/day 54.9 11.3 1957
13   <12.5 mg/day 10.4  2.9 2879
14 12.6-49 mg/day 27.5  6.6 3687
15     >50 mg/day 53.9  9.8 2844
22   <12.5 mg/day 10.5  2.9 1634
23 12.6-49 mg/day 28.3  6.9 2747
24     >50 mg/day 53.6  9.4 3336

$Metropolol
             Dose  Mean   SD     n
1     >200 mg/day 200.0  0.0  2989
2     <100 mg/day  64.6 25.8 25049
3  101-199 mg/day 144.3 10.5  4929
10    >200 mg/day 200.0  0.0  2927
11    <100 mg/day  67.4 26.3 19561
12 101-199 mg/day 144.3 10.5  3863
19    >200 mg/day 200.0  0.0  2559
20    <100 mg/day  66.6 27.5 14190
21 101-199 mg/day 145.3  9.8  2133

> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")], labels=labellist)
> 
> 
> ## The graph consist of at most three columns:
> ##
> ## column 1: labels
> ## column 2: printed values of the confidence intervals
> ## column 3: graphical presentation of the confidence intervals
> ##
> ## NOTE: column 3 appears always, the user decides if also
> ##       column 1, 2 should appear
> ##
> ## The columns are arranged with the function layout
> ## and the default order is 1,3,2 such that the graphical
> ## display of the confidence intervals appears in the middle
> ##
> ## the order of appearance of the three columns can be changed as follows
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                order=c(1,3,2))
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                order=c(2,3,1))
> ## if there are only two columns the order is 1, 2
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                values=FALSE,
+                order=c(2,1))
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                values=FALSE,
+                order=c(1,2))
> 
> 
> 
> ## The relative size of the columns needs to be controlled manually
> ## by using the argument xratio. If there are only two columns
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xratio=c(0.4,0.15))
> 
> ## The amount of space on the left and right margin can be controlled
> ## as follows:
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xratio=c(0.4,0.15),
+                leftmargin=0.1,rightmargin=0.00)
> 
> ## The actual size of the current graphics device determines
> ## the size of the figures and the space between them.
> ## The sizes and line widths are increased as follows:
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                xlab="Hazard ratio",
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                points.cex=3,
+                cex=2,
+                lwd=3,
+                xaxis.lwd=1.3,
+                xaxis.cex=1.3)
> ## Note that 'cex' of axis ticks is controlled via 'par' but
> ## cex of the label via argument 'cex' of 'mtext'.
> ## The sizes and line widths are decreased as follows:
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                cex=0.8,
+                lwd=0.8,
+                xaxis.lwd=0.8,
+                xaxis.cex=0.8)
> 
> ## Another good news is that all figures can be controlled separately
> 
> ## The size of the graphic device can be controlled in the usual way, e.g.:
> ## Not run: 
> ##D     pdf("~/tmp/testCI.pdf",width=8,height=8)
> ##D     plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
> ##D                    labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")])
> ##D     dev.off()
> ## End(Not run)
> 
> ## More control of the x-axis and confidence intervals that
> ## stretch outside the x-range end in an arrow. 
> ## the argument xlab.line adjusts the distance of the x-axis
> ## label from the graph
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                xlab="Hazard ratio",
+                xlab.line=1.8,
+                xaxis.at=c(0.8,1,1.3),
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlim=c(0.8,1.3))
> 
> ## log-scale
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                xlab="Hazard ratio",
+                xlab.line=1.8,
+                xaxis.at=c(0.8,1,1.3),
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlim=c(0.8,1.3),plot.log="x")
> ## More pronounced arrows
> ## Coloured xlab expression
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                xlab=expression(HR[1](s)),
+                xlab.line=1.8,
+                xlab.col="darkred",
+                extremearrows.angle=50,
+                extremearrows.length=0.1,
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlim=c(0.8,1.3))
> 
> ## Controlling the labels and their titles
> ## and the values and their titles
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlab="Hazard ratio",
+                title.values=expression(bold(HR (CI[95]))),
+                title.labels=c("Drug/Time","Dose","Mean","St.dev.","N"),
+                factor.reference.pos=c(1,10,19),
+                factor.reference.pch=16,
+                cex=1.3,
+                xaxis.at=c(0.75,1,1.25,1.5,2))
> 
> ## For factor reference groups, one may want to replace the
> ## confidence intervals by the word Reference, as in the previous example.
> ## To change the word 'Reference' we use the argument factor.reference.label:
> ## To change the plot symbol for the reference lines factor.reference.pch
> ## To remove the plot symbol in the reference lines use 'NA' as follows:
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlab="Hazard ratio",
+                factor.reference.label="Ref",
+                title.values=expression(bold(HR (CI[95]))),
+                title.labels=c("Drug/Time","Dose","Mean","St.dev.","N"),
+                factor.reference.pos=c(1,10,19),
+                factor.reference.pch=NA,
+                cex=1.3,
+                xaxis.at=c(0.75,1,1.25,1.5,2))
> 
> 
> ## changing the style of the graphical confidence intervals
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                xlab="Hazard ratio",
+                factor.reference.pos=c(1,10,19),
+                points.pch=15,
+                points.col=rainbow(27),
+                points.cex=2,
+                arrows.col="darkblue",
+                cex=1.3,
+                order=c(1,3,2),
+                xaxis.at=c(0.75,1,1.25,1.5))
> 
> ## the values column of the graph can have multiple columns as well
> ## to illustrate this we create the confidence intervals
> ## before calling the function and then cbind them
> ## to the pvalues
> HR <- pubformat(CiTable[,6])
> CI95 <- formatCI(lower=CiTable[,7],upper=CiTable[,8],format="(l-u)")
> pval <- format.pval(CiTable[,9],digits=3,eps=10^{-3})
> pval[pval=="NA"] <- ""
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                values=list("HR"=HR,"CI-95"=CI95,"P-value"=pval),
+                cex=1.2,
+                xratio=c(0.5,0.3))
> 
> ## Finally, vertical columns can be delimited with background color
> ## NOTE: this may slow things down and potentially create
> ##       large figures (many bytes)
> col1 <- rep(c(prodlim::dimColor("green",density=22),
+               prodlim::dimColor("green")),length.out=9)
> col2 <- rep(c(prodlim::dimColor("orange",density=22),
+               prodlim::dimColor("orange")),length.out=9)
> col3 <- rep(c(prodlim::dimColor("blue",density=22),
+               prodlim::dimColor("blue")),length.out=9)
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                stripes=c(1,0,1),
+                stripes.col=c(col1,col2,col3))
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                stripes=c(1,1,1),
+                stripes.col=c(col1,col2,col3))
> 
> threegreens <- c(prodlim::dimColor("green",density=55),
+                  prodlim::dimColor("green",density=33),
+                  prodlim::dimColor("green",density=22))
> plotConfidence(x=CiTable[,c("HazardRatio","lower","upper")],
+                labels=CiTable[,c("Drug.Time","Dose","Mean","SD","n")],
+                values=FALSE,
+                xlim=c(0.75,1.5),
+                stripes=c(1,1,1),
+                xratio=c(0.5,0.15),
+                stripes.horizontal=c(0,9,18,27)+0.5,
+                stripes.col=threegreens)
> 
> 
> 
> 
> 
> 
> cleanEx()
> nameEx("print.ci")
> ### * print.ci
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: print.ci
> ### Title: Print confidence intervals
> ### Aliases: print.ci
> 
> ### ** Examples
> 
> library(lava)
> m <- lvm(Y~X)
> m <- categorical(m,Y~X,K=4)
> set.seed(4)
> d <- sim(m,24)
> ci.mean(Y~X,data=d)
 X mean CI-95%      
 0 1.12 [0.14;2.10] 
 1 0.22 [-0.41;0.86]
 2 0.05 [-1.64;1.74]
 3 0.44 [0.02;0.87] 
> x <- ci.mean(Y~X,data=d)
> print(x,format="(l,u)")
 X mean CI-95%      
 0 1.12 (0.14,2.10) 
 1 0.22 (-0.41,0.86)
 2 0.05 (-1.64,1.74)
 3 0.44 (0.02,0.87) 
> 
> 
> 
> cleanEx()

detaching 'package:lava'

> nameEx("print.table2x2")
> ### * print.table2x2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: print.table2x2
> ### Title: print results of 2x2 contingency table analysis
> ### Aliases: print.table2x2
> 
> ### ** Examples
> 
> table2x2(table("marker"=rbinom(100,1,0.4),"response"=rbinom(100,1,0.1)))
_____________________________

2x2 contingency table
_____________________________

            response0     response1     Sum
marker0            55             2      57
marker1            36             7      43
--                 --            --      --
Sum                91             9     100

_____________________________

Statistics
_____________________________


a= 55 
b= 2 
c= 36 
d= 7

p1=a/(a+b)= 0.9649 
p2=c/(c+d)= 0.8372 

_____________________________

Risk difference
_____________________________

Risk difference = RD = p1-p2 = 0.1277
Standard error = SE.RD = sqrt(p1*(1-p1)/(a+b)+p2*(1-p2)/(c+d)) = 0.1277
Lower 95%-confidence limit: = RD - 1.96 * SE.RD = 0.007464
Upper 95%-confidence limit: = RD + 1.96 * SE.RD = 0.2479

The estimated risk difference is 12.8%  (CI_95%: [0.7;24.8]).

_____________________________

Risk ratio
_____________________________

Risk ratio = RR = p1/p2 = 1.1525
Standard error = SE.RR = sqrt((1-p1)/a+(1-p2)/c)= 1.1525
Lower 95%-confidence limit: = RR * exp(- 1.96 * SE.RR) = 1.0012
Upper 95%-confidence limit: = RR * exp(1.96 * SE.RR) = 1.3268

The estimated risk ratio is 1.153 (CI_95%: [1.001;1.327]).

_____________________________

Odds ratio
_____________________________

Odds ratio = OR = (p1/(1-p1))/(p2/(1-p2)) = 5.3472
Standard error = SE.OR = sqrt((1/a+1/b+1/c+1/d)) = 0.8299
Lower 95%-confidence limit: = OR * exp(- 1.96 * SE.OR) = 1.0512
Upper 95%-confidence limit: = OR * exp(1.96 * SE.OR) = 27.2009

The estimated odds ratio is 5.347 (CI_95%: [1.051;27.201]).

_____________________________

Chi-square test
_____________________________

Warning in chisq.test(table2x2) :
  Chi-squared approximation may be incorrect

	Pearson's Chi-squared test with Yates' continuity correction

data:  table2x2
X-squared = 3.4458, df = 1, p-value = 0.06341


_____________________________

Fisher's exact test
_____________________________


	Fisher's Exact Test for Count Data

data:  table2x2
p-value = 0.03641
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  0.9318097 54.6441933
sample estimates:
odds ratio 
  5.260574 

> table2x2(matrix(c(71,18,38,8),ncol=2),stats="table")
_____________________________

2x2 contingency table
_____________________________

                  response: no     response: yes     Sum
exposure: no                71                38     109
exposure: yes               18                 8      26
--                          --                --      --
Sum                         89                46     135

_____________________________

Statistics
_____________________________


a= 71 
b= 38 
c= 18 
d= 8

p1=a/(a+b)= 0.6514 
p2=c/(c+d)= 0.6923 
> table2x2(matrix(c(71,18,38,8),ncol=2),stats=c("rr","fisher"))

_____________________________

Risk ratio
_____________________________

Risk ratio = RR = p1/p2 = 0.9409
Standard error = SE.RR = sqrt((1-p1)/a+(1-p2)/c)= 0.9409
Lower 95%-confidence limit: = RR * exp(- 1.96 * SE.RR) = 0.7035
Upper 95%-confidence limit: = RR * exp(1.96 * SE.RR) = 1.2583

The estimated risk ratio is 0.941 (CI_95%: [0.704;1.258]).

_____________________________

Fisher's exact test
_____________________________


	Fisher's Exact Test for Count Data

data:  table2x2
p-value = 0.8193
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.2851706 2.2411406
sample estimates:
odds ratio 
 0.8315358 

> 
> 
> 
> cleanEx()
> nameEx("pubformat")
> ### * pubformat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pubformat
> ### Title: Format numbers for publication
> ### Aliases: pubformat
> 
> ### ** Examples
> 
> 
> pubformat(c(0.000143,12.8,1))
[1] "0.00"  "12.80" "1.00" 
> pubformat(c(0.000143,12.8,1),handler="format")
[1] "1.4e-04" "1.3e+01" "1.0e+00"
> pubformat(c(0.000143,12.8,1),handler="format",trim=TRUE)
[1] "1.4e-04" "1.3e+01" "1.0e+00"
> pubformat(c(0.000143,12.8,1),handler="prettyNum")
[1] "0.00014" "12.80"   "1.00"   
> 
> 
> 
> cleanEx()
> nameEx("publish.CauseSpecificCox")
> ### * publish.CauseSpecificCox
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.CauseSpecificCox
> ### Title: Tabulizing cause-specific hazard ratio from all causes with
> ###   confidence limits and Wald test p-values.
> ### Aliases: publish.CauseSpecificCox
> 
> ### ** Examples
> 
> library(riskRegression)
Loading required package: data.table
Loading required package: ggplot2
riskRegression version 2019.01.29
> library(prodlim)
> library(pec)

Attaching package: 'pec'

The following objects are masked from 'package:riskRegression':

    ipcw, selectCox

> library(survival)
> data(Melanoma,package="riskRegression")
> fit1 <- CSC(list(Hist(time,status)~sex,Hist(time,status)~invasion+epicel+age),
+             data=Melanoma)
> publish(fit1)
Cause 1 :
  Variable  Units HazardRatio       CI.95  p-value
1      sex Female         Ref                     
2            Male        1.94 [1.15;3.26]   0.0125

Cause 2 :
  Variable       Units HazardRatio       CI.95 p-value
1 invasion     level.0         Ref                    
2              level.1        0.40 [0.11;1.41]   0.154
3              level.2        0.28 [0.03;2.49]   0.253
4   epicel not present         Ref                    
5              present        1.38 [0.45;4.22]   0.572
6      age                    1.10 [1.04;1.16]  <0.001

> publish(fit1,pvalue.stars=TRUE)
Cause 1 :
  Variable  Units HazardRatio       CI.95  p-value signif
1      sex Female         Ref                            
2            Male        1.94 [1.15;3.26]   0.0125      *

Cause 2 :
  Variable       Units HazardRatio       CI.95 p-value signif
1 invasion     level.0         Ref                           
2              level.1        0.40 [0.11;1.41]   0.154       
3              level.2        0.28 [0.03;2.49]   0.253       
4   epicel not present         Ref                           
5              present        1.38 [0.45;4.22]   0.572       
6      age                    1.10 [1.04;1.16]  <0.001    ***

> publish(fit1,factor.reference="inline",units=list("age"="years"))
Cause 1 :
  Variable          Units HazardRatio       CI.95  p-value
1      sex Male vs Female        1.94 [1.15;3.26]   0.0125

Cause 2 :
  Variable                  Units HazardRatio       CI.95 p-value
1 invasion     level.1 vs level.0        0.40 [0.11;1.41]   0.154
2              level.2 vs level.0        0.28 [0.03;2.49]   0.253
3   epicel present vs not present        1.38 [0.45;4.22]   0.572
4      age                  years        1.10 [1.04;1.16]  <0.001

> 
> 
> 
> cleanEx()

detaching 'package:survival', 'package:pec', 'package:riskRegression',
  'package:ggplot2', 'package:data.table'

> nameEx("publish.MIresult")
> ### * publish.MIresult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.MIresult
> ### Title: Present logistic regression and Cox regression obtained with
> ###   mitools::MIcombine based on smcfcs::smcfcs multiple imputation
> ###   analysis
> ### Aliases: publish.MIresult
> 
> ### ** Examples
> 
> 
> ## Not run: 
> ##D ## continuous outcome: linear regression
> ##D # lava some data with missing values
> ##D library(riskRegression)
> ##D set.seed(7)
> ##D d=sampleData(78)
> ##D ## generate missing values
> ##D d[X1==1,X6:=NA] 
> ##D d[X2==1,X3:=NA]
> ##D d=d[,.(X8,X4,X3,X6,X7)]
> ##D sapply(d,function(x)sum(is.na(x)))
> ##D 
> ##D # multiple imputation (should set m to a large value)
> ##D 
> ##D library(smcfcs)
> ##D library(mitools)
> ##D set.seed(17)
> ##D f= smcfcs(d,smtype="lm",
> ##D            smformula=X8~X4+X3+X6+X7,
> ##D            method=c("","","logreg","norm",""),m=3)
> ##D ccfit=lm(X8~X4+X3+X6+X7,data=d)
> ##D mifit=MIcombine(with(imputationList(f$impDatasets),
> ##D                 lm(X8~X4+X3+X6+X7)))
> ##D publish(mifit,fit=ccfit,data=d)
> ##D publish(ccfit)
> ##D 
> ##D ## binary outcome
> ##D # lava some data with missing values
> ##D library(riskRegression)
> ##D set.seed(7)
> ##D db=sampleData(78,outcome="binary")
> ##D ## generate missing values
> ##D db[X1==1,X6:=NA] 
> ##D db[X2==1,X3:=NA]
> ##D db=db[,.(Y,X4,X3,X6,X7)]
> ##D sapply(db,function(x)sum(is.na(x)))
> ##D 
> ##D # multiple imputation (should set m to a large value)
> ##D library(smcfcs)
> ##D library(mitools)
> ##D set.seed(17)
> ##D fb= smcfcs(db,smtype="logistic",
> ##D            smformula=Y~X4+X3+X6+X7,
> ##D            method=c("","","logreg","norm",""),m=2)
> ##D ccfit=glm(Y~X4+X3+X6+X7,family="binomial",data=db)
> ##D mifit=MIcombine(with(imputationList(fb$impDatasets),
> ##D                 glm(Y~X4+X3+X6+X7,family="binomial")))
> ##D publish(mifit,fit=ccfit)
> ##D publish(ccfit)
> ##D 
> ##D ## survival: Cox regression
> ##D library(smcfcs)
> ##D library(mitools)
> ##D library(survival)
> ##D # lava some data with missing values
> ##D library(riskRegression)
> ##D set.seed(7)
> ##D ds=sampleData(78,outcome="survival")
> ##D ## generate missing values
> ##D ds[X5==1,X6:=NA] 
> ##D ds[X2==1,X3:=NA]
> ##D ds=ds[,.(time,event,X4,X3,X6,X7)]
> ##D sapply(ds,function(x)sum(is.na(x)))
> ##D 
> ##D set.seed(17)
> ##D fs= smcfcs(ds,smtype="coxph",
> ##D            smformula="Surv(time,event)~X4+X3+X6+X7",
> ##D            method=c("","","","logreg","norm",""),m=2)
> ##D ccfit=coxph(Surv(time,event)~X4+X3+X6+X7,data=ds)
> ##D mifit=MIcombine(with(imputationList(fs$impDatasets),
> ##D                 coxph(Surv(time,event)~X4+X3+X6+X7)))
> ##D publish(mifit,fit=ccfit,data=ds)
> ##D publish(ccfit)
> ##D 
> ##D ## competing risks: Cause-specific Cox regression 
> ##D library(survival)
> ##D library(smcfcs)
> ##D library(mitools)
> ##D # lava some data with missing values
> ##D library(riskRegression)
> ##D set.seed(7)
> ##D dcr=sampleData(78,outcome="competing.risks")
> ##D ## generate missing values
> ##D dcr[X5==1,X6:=NA] 
> ##D dcr[X2==1,X3:=NA]
> ##D dcr=dcr[,.(time,event,X4,X3,X6,X7)]
> ##D sapply(dcr,function(x)sum(is.na(x)))
> ##D 
> ##D set.seed(17)
> ##D fcr= smcfcs(dcr,smtype="compet",
> ##D            smformula=c("Surv(time,event==1)~X4+X3+X6+X7",
> ##D                        "Surv(time,event==2)~X4+X3+X6+X7"),
> ##D            method=c("","","","logreg","norm",""),m=2)
> ##D ## cause 2 
> ##D ccfit2=coxph(Surv(time,event==2)~X4+X3+X6+X7,data=dcr)
> ##D mifit2=MIcombine(with(imputationList(fcr$impDatasets),
> ##D                 coxph(Surv(time,event==2)~X4+X3+X6+X7)))
> ##D publish(mifit2,fit=ccfit2,data=dcr)
> ##D publish(ccfit2)
> ## End(Not run) 
> 
> 
> 
> 
> cleanEx()
> nameEx("publish.Score")
> ### * publish.Score
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.Score
> ### Title: Publish predictive accuracy results
> ### Aliases: publish.Score
> 
> ### ** Examples
> 
> library(riskRegression)
Loading required package: data.table
Loading required package: ggplot2
riskRegression version 2019.01.29
> library(survival)
> learn = sampleData(100)
> val= sampleData(100)
> f1=CSC(Hist(time,event)~X1+X8,data=learn)
> f2=CSC(Hist(time,event)~X1+X5+X6+X8,learn)
> xs=Score(list(f1,f2),data=val,formula=Hist(time,event)~1)
> publish(xs)

*** Metric AUC:


**** Assessment of predictive accuracy
              model    times       AUC         se     lower     upper 
   CauseSpecificCox 4.602777 0.5700659 0.06615850 0.4403976 0.6997341 
 CauseSpecificCox.1 4.602777 0.8504360 0.04099535 0.7700866 0.9307854 

**** Comparison of predictive accuracy
    times              model        reference delta.AUC         se     lower     upper          p 
 4.602777 CauseSpecificCox.1 CauseSpecificCox 0.2803702 0.06428487 0.1543741 0.4063662 1.2925e-05 

*** Metric Brier:


**** Assessment of predictive accuracy
              model    times     Brier         se se.conservative     lower     upper 
         Null model 4.602777 0.2005021 0.02080125      0.02150550 0.1597324 0.2412718 
   CauseSpecificCox 4.602777 0.2035490 0.02400715      0.02473935 0.1564959 0.2506022 
 CauseSpecificCox.1 4.602777 0.1492695 0.02465245      0.02509044 0.1009516 0.1975874 

**** Comparison of predictive accuracy
    times              model        reference  delta.Brier         se       lower        upper          p 
 4.602777   CauseSpecificCox       Null model  0.003046938 0.01735965 -0.03097735  0.037071229 0.86067231 
 4.602777 CauseSpecificCox.1       Null model -0.051232568 0.02517469 -0.10057406 -0.001891078 0.04184260 
 4.602777 CauseSpecificCox.1 CauseSpecificCox -0.054279506 0.01727853 -0.08814480 -0.020414209 0.00168118 
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival', 'package:riskRegression',
  'package:ggplot2', 'package:data.table'

> nameEx("publish.ci")
> ### * publish.ci
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.ci
> ### Title: Publish tables with confidence intervals
> ### Aliases: publish.ci
> 
> ### ** Examples
> 
> 
> data(Diabetes)
> publish(ci.mean(chol~location+gender,data=Diabetes),org=TRUE)
|  gender |   location |   mean |          CI-95% |
|---------+------------+--------+-----------------|
|  female | Buckingham | 206.21 | [197.90;214.52] |
|  female |     Louisa | 210.55 | [202.81;218.29] |
|    male | Buckingham | 203.55 | [193.88;213.23] |
|    male |     Louisa | 210.58 | [200.49;220.66] |

> 
> 
> 
> 
> cleanEx()
> nameEx("publish.coxph")
> ### * publish.coxph
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.coxph
> ### Title: Tabulize hazard ratios with confidence intervals and p-values.
> ### Aliases: publish.coxph
> 
> ### ** Examples
> 
> library(survival)
> data(pbc)
> pbc$edema <- factor(pbc$edema,
+              levels=c("0","0.5","1"), labels=c("0","0.5","1"))
> fit = coxph(Surv(time,status!=0)~age+sex+edema+log(bili)+log(albumin),
+             data=na.omit(pbc))
> publish(fit)
     Variable Units HazardRatio       CI.95  p-value 
          age              1.02 [1.00;1.03]   0.0658 
          sex     m         Ref                      
                  f        0.63 [0.39;1.03]   0.0645 
        edema     0         Ref                      
                0.5        1.37 [0.80;2.34]   0.2555 
                  1        3.05 [1.63;5.69]   <0.001 
    log(bili)              2.39 [1.97;2.92]   <0.001 
 log(albumin)              0.06 [0.01;0.28]   <0.001 
> ## forest plot
> plot(publish(fit),cex=1.3)
     Variable Units HazardRatio       CI.95  p-value 
          age              1.02 [1.00;1.03]   0.0658 
          sex     m         Ref                      
                  f        0.63 [0.39;1.03]   0.0645 
        edema     0         Ref                      
                0.5        1.37 [0.80;2.34]   0.2555 
                  1        3.05 [1.63;5.69]   <0.001 
    log(bili)              2.39 [1.97;2.92]   <0.001 
 log(albumin)              0.06 [0.01;0.28]   <0.001 
> 
> publish(fit,ci.digits=2,pvalue.eps=0.01,pvalue.digits=2,pvalue.stars=TRUE)
     Variable Units HazardRatio       CI.95 p-value signif 
          age              1.02 [1.00;1.03]   0.066      . 
          sex     m         Ref                            
                  f        0.63 [0.39;1.03]   0.065      . 
        edema     0         Ref                            
                0.5        1.37 [0.80;2.34]   0.256        
                  1        3.05 [1.63;5.69]   <0.01    *** 
    log(bili)              2.39 [1.97;2.92]   <0.01    *** 
 log(albumin)              0.06 [0.01;0.28]   <0.01    *** 
> publish(fit,ci.digits=2,ci.handler="prettyNum",pvalue.eps=0.01,
+         pvalue.digits=2,pvalue.stars=TRUE)
     Variable Units HazardRatio       CI.95 p-value signif 
          age              1.02 [1.00;1.03]   0.066      . 
          sex     m         Ref                            
                  f        0.63 [0.39;1.03]   0.065      . 
        edema     0         Ref                            
                0.5        1.37 [0.80;2.34]   0.256        
                  1        3.05 [1.63;5.69]   <0.01    *** 
    log(bili)              2.39 [1.97;2.92]   <0.01    *** 
 log(albumin)              0.06 [0.01;0.28]   <0.01    *** 
> publish(fit, ci.digits=2, ci.handler="sprintf", pvalue.eps=0.01,
+         pvalue.digits=2,pvalue.stars=TRUE, ci.trim=FALSE)
     Variable Units HazardRatio       CI.95 p-value signif 
          age              1.02 [1.00;1.03]   0.066      . 
          sex     m         Ref                            
                  f        0.63 [0.39;1.03]   0.065      . 
        edema     0         Ref                            
                0.5        1.37 [0.80;2.34]   0.256        
                  1        3.05 [1.63;5.69]   <0.01    *** 
    log(bili)              2.39 [1.97;2.92]   <0.01    *** 
 log(albumin)              0.06 [0.01;0.28]   <0.01    *** 
> 
> fit2 = coxph(Surv(time,status!=0)~age+sex+edema+log(bili,base=2)+log(albumin)+log(protime),
+     data=na.omit(pbc))
> publish(fit2)
            Variable Units HazardRatio        CI.95   p-value 
                 age              1.01  [1.00;1.03]   0.12405 
                 sex     m         Ref                        
                         f        0.63  [0.39;1.02]   0.06221 
               edema     0         Ref                        
                       0.5        1.27  [0.74;2.20]   0.38186 
                         1        2.57  [1.35;4.92]   0.00415 
 log(bili, base = 2)              1.80  [1.57;2.06]   < 0.001 
        log(albumin)              0.06  [0.01;0.27]   < 0.001 
        log(protime)              6.69 [0.77;58.23]   0.08527 
> 
> # with cluster variable
> fit3 = coxph(Surv(time,status!=0)~age+cluster(sex)+edema+log(bili,base=2)
+                                     +log(albumin)+log(protime),
+     data=na.omit(pbc))
> publish(fit3)
            Variable Units HazardRatio       CI.95  p-value 
                 age              1.02 [1.02;1.02]   <0.001 
               edema     0         Ref                      
                       0.5        1.18 [0.59;2.38]   0.6349 
                         1        2.41 [1.16;4.97]   0.0177 
 log(bili, base = 2)              1.82 [1.58;2.08]   <0.001 
        log(albumin)              0.08 [0.02;0.30]   <0.001 
        log(protime)              6.36 [4.18;9.68]   <0.001 
> 
> # with strata and cluster variable
> fit4 = coxph(Surv(time,status!=0)~age+cluster(sex)+strata(edema)+log(bili,base=2)
+                  +log(albumin)+log(protime),
+     data=pbc)
> publish(fit4)
            Variable Units Missing HazardRatio       CI.95 p-value 
                 age             0        1.02 [1.02;1.03]  <0.001 
 log(bili, base = 2)             0        1.76 [1.68;1.85]  <0.001 
        log(albumin)             0        0.08 [0.03;0.26]  <0.001 
        log(protime)             2        5.24 [3.90;7.05]  <0.001 
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("publish.glm")
> ### * publish.glm
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.glm
> ### Title: Tabulize regression coefficients with confidence intervals and
> ###   p-values.
> ### Aliases: publish.glm
> 
> ### ** Examples
> 
> data(Diabetes)
> ## Linear regression
> f = glm(bp.2s~frame+gender+age,data=Diabetes)
> publish(f)
    Variable  Units Coefficient           CI.95  p-value 
 (Intercept)             128.00 [112.52;143.48]   <1e-04 
       frame  large         Ref                          
             medium       -1.38    [-9.79;7.04]   0.7492 
              small       -1.61   [-12.71;9.48]   0.7765 
      gender female         Ref                          
               male       -1.50    [-8.80;5.79]   0.6867 
         age               0.52     [0.28;0.76]   <1e-04 
> publish(f,factor.reference="inline")
    Variable           Units Coefficient           CI.95  p-value 
 (Intercept)                      128.00 [112.52;143.48]   <1e-04 
       frame medium vs large       -1.38    [-9.79;7.04]   0.7492 
              small vs large       -1.61   [-12.71;9.48]   0.7765 
      gender  male vs female       -1.50    [-8.80;5.79]   0.6867 
         age                        0.52     [0.28;0.76]   <1e-04 
> publish(f,pvalue.stars=TRUE)
    Variable  Units Coefficient           CI.95  p-value signif 
 (Intercept)             128.00 [112.52;143.48]   <1e-04    *** 
       frame  large         Ref                                 
             medium       -1.38    [-9.79;7.04]   0.7492        
              small       -1.61   [-12.71;9.48]   0.7765        
      gender female         Ref                                 
               male       -1.50    [-8.80;5.79]   0.6867        
         age               0.52     [0.28;0.76]   <1e-04    *** 
> publish(f,ci.format="(l,u)")
    Variable  Units Coefficient           CI.95  p-value 
 (Intercept)             128.00 (112.52,143.48)   <1e-04 
       frame  large         Ref                          
             medium       -1.38    (-9.79,7.04)   0.7492 
              small       -1.61   (-12.71,9.48)   0.7765 
      gender female         Ref                          
               male       -1.50    (-8.80,5.79)   0.6867 
         age               0.52     (0.28,0.76)   <1e-04 
> 
> ### interaction
> fit = glm(bp.2s~frame+gender*age,data=Diabetes)
> summary(fit)

Call:
glm(formula = bp.2s ~ frame + gender * age, data = Diabetes)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-29.904  -13.246   -5.236   11.450   82.084  

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)    129.53581    9.40658  13.771  < 2e-16 ***
framemedium     -1.47393    4.31958  -0.341  0.73350    
framesmall      -1.78372    5.70929  -0.312  0.75523    
gendermale      -5.38769   13.30675  -0.405  0.68624    
age              0.49342    0.15279   3.229  0.00158 ** 
gendermale:age   0.07737    0.25448   0.304  0.76160    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 432.4405)

    Null deviance: 63881  on 133  degrees of freedom
Residual deviance: 55352  on 128  degrees of freedom
  (269 observations deleted due to missingness)
AIC: 1201.4

Number of Fisher Scoring iterations: 2

> publish(fit)
            Variable  Units Coefficient           CI.95    p-value 
         (Intercept)             129.54 [111.10;147.97]    < 1e-04 
               frame  large         Ref                            
                     medium       -1.47    [-9.94;6.99]   0.733496 
                      small       -1.78   [-12.97;9.41]   0.755227 
 age: gender(female)               0.49     [0.19;0.80]   0.001577 
   age: gender(male)               0.57     [0.17;0.97]   0.005949 
> 
> Fit = glm(bp.2s~frame*gender+age,data=Diabetes)
> publish(Fit)
                               Variable Units Coefficient           CI.95  p-value 
                            (Intercept)            123.52 [105.43;141.60]   <1e-04 
                                    age              0.54     [0.30;0.78]   <1e-04 
   frame(large): gender(male vs female)              4.26   [-9.95;18.47]   0.5541 
  frame(medium): gender(male vs female)             -3.15   [-12.93;6.64]   0.5258 
   frame(small): gender(male vs female)             -5.19  [-23.44;13.07]   0.5748 
 gender(female): frame(medium vs large)              2.91   [-9.88;15.69]   0.6536 
  gender(female): frame(small vs large)              3.31  [-12.35;18.98]   0.6764 
   gender(male): frame(medium vs large)             -4.50   [-16.00;7.00]   0.4405 
    gender(male): frame(small vs large)             -6.14  [-23.08;10.81]   0.4750 
> 
> ## Logistic regression
> Diabetes$hyper1 <- factor(1*(Diabetes$bp.1s>140))
> lrfit <- glm(hyper1~frame+gender+age,data=Diabetes,family=binomial)
> publish(lrfit)
 Variable  Units OddsRatio       CI.95   p-value 
    frame  large       Ref                       
          medium      0.85 [0.49;1.48]   0.57161 
           small      0.45 [0.23;0.90]   0.02281 
   gender female       Ref                       
            male      0.85 [0.52;1.38]   0.51478 
      age             1.06 [1.04;1.07]   < 1e-04 
> 
> ### interaction
> lrfit1 <- glm(hyper1~frame+gender*age,data=Diabetes,family=binomial)
> publish(lrfit1)
            Variable  Units OddsRatio       CI.95   p-value 
               frame  large       Ref                       
                     medium      0.80 [0.45;1.39]   0.42332 
                      small      0.41 [0.20;0.83]   0.01293 
 age: gender(female)             1.09 [1.06;1.11]   < 1e-04 
   age: gender(male)             1.02 [1.00;1.05]   0.05602 
> 
> lrfit2 <- glm(hyper1~frame*gender+age,data=Diabetes,family=binomial)
> publish(lrfit2)
                               Variable Units OddsRatio       CI.95   p-value 
                                    age            1.06 [1.04;1.07]   < 1e-04 
   frame(large): gender(male vs female)            0.55 [0.23;1.31]   0.17745 
  frame(medium): gender(male vs female)            1.02 [0.51;2.03]   0.95775 
   frame(small): gender(male vs female)            1.10 [0.37;3.25]   0.87006 
 gender(female): frame(medium vs large)            0.62 [0.28;1.35]   0.23035 
  gender(female): frame(small vs large)            0.32 [0.13;0.81]   0.01595 
   gender(male): frame(medium vs large)            1.14 [0.52;2.50]   0.74015 
    gender(male): frame(small vs large)            0.64 [0.22;1.81]   0.39616 
> 
> ## Poisson regression
> data(trace)
> trace <- Units(trace,list("age"="years"))
> fit <- glm(dead ~ smoking+sex+age+Time+offset(log(ObsTime)), family="poisson",data=trace)
> rtf <- regressionTable(fit,factor.reference = "inline")
> summary(rtf)
  Variable             Units HazardRatio       CI.95   p-value
1  smoking  Current vs Never        1.09 [1.01;1.19]   0.02863
2          Previous vs Never        1.08 [1.00;1.16]   0.04139
3      sex    Male vs Female        1.09 [1.02;1.16]   0.00632
4      age                          1.07 [1.07;1.08]   < 0.001
5     Time                          1.00 [1.00;1.00]   < 0.001
  Variable             Units HazardRatio       CI.95   p-value
1  smoking  Current vs Never        1.09 [1.01;1.19]   0.02863
2          Previous vs Never        1.08 [1.00;1.16]   0.04139
3      sex    Male vs Female        1.09 [1.02;1.16]   0.00632
4      age                          1.07 [1.07;1.08]   < 0.001
5     Time                          1.00 [1.00;1.00]   < 0.001
> publish(fit)
 Variable    Units HazardRatio       CI.95    p-value 
  smoking    Never         Ref                        
           Current        1.09 [1.01;1.19]   0.028634 
          Previous        1.08 [1.00;1.16]   0.041394 
      sex   Female         Ref                        
              Male        1.09 [1.02;1.16]   0.006317 
      age                 1.07 [1.07;1.08]    < 1e-04 
     Time                 1.00 [1.00;1.00]    < 1e-04 
> 
> ## gls regression
> library(nlme)
> library(lava)
> m <- lvm(Y ~ X1 + gender + group + Interaction)
> distribution(m, ~gender) <- binomial.lvm()
> distribution(m, ~group) <- binomial.lvm(size = 2)
> constrain(m, Interaction ~ gender + group) <- function(x){x[,1]*x[,2]}
> d <- sim(m, 1e2)
> d$gender <- factor(d$gender, labels = letters[1:2])
> d$group <- factor(d$group)
> 
> e.gls <- gls(Y ~ X1 + gender*group, data = d,
+              weights = varIdent(form = ~1|group))
> publish(e.gls)
Error in eval(parse(text = misscall), data) : object 'X1' not found
Error in eval(parse(text = misscall), data) : object 'gender' not found
                 Variable Units Coefficient        CI.95    p-value 
              (Intercept)              0.01 [-0.56;0.58]   0.968595 
                       X1              0.98  [0.79;1.17]    < 1e-04 
 gender(a): group(1 vs 0)              1.07  [0.40;1.73]   0.001706 
 gender(a): group(2 vs 0)              2.30  [1.47;3.13]    < 1e-04 
 gender(b): group(1 vs 0)              2.29  [1.73;2.85]    < 1e-04 
 gender(b): group(2 vs 0)              3.73  [3.13;4.33]    < 1e-04 
 group(0): gender(b vs a)              1.06  [0.37;1.74]   0.002620 
 group(1): gender(b vs a)              2.28  [1.75;2.81]    < 1e-04 
 group(2): gender(b vs a)              2.48  [1.72;3.25]    < 1e-04 
> 
> ## lme
> library(nlme)
> fm1 <- lme(distance ~ age*Sex, 
+             random = ~1|Subject,
+             data = Orthodont) 
> res <- publish(fm1)
Error in eval(parse(text = misscall), data) : object 'age' not found
         Variable Units Coefficient         CI.95 p-value 
      (Intercept)             16.34 [14.39;18.29] < 1e-04 
   age: Sex(Male)              0.78   [0.63;0.94] < 1e-04 
 age: Sex(Female)              0.48   [0.30;0.66] < 1e-04 
> 
> 
> 
> cleanEx()

detaching 'package:lava', 'package:nlme'

> nameEx("publish.htest")
> ### * publish.htest
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.htest
> ### Title: Pretty printing of test results.
> ### Aliases: publish.htest
> 
> ### ** Examples
> 
> data(Diabetes)
> publish(t.test(bp.2s~gender,data=Diabetes))

 The Welch Two Sample t-test to compare the difference in means for bp.2s by gender yields a mean difference of -2.13 (CI-95% = [-4.97;9.23]; p-value = 0.554). 
> publish(wilcox.test(bp.2s~gender,data=Diabetes))

 The Wilcoxon rank sum test with continuity correction to compare the location shift for bp.2s by gender yields a p-value of 0.979. 
> publish(with(Diabetes,t.test(bp.2s,bp.1s,paired=TRUE)))

 The Paired t-test to compare the difference in means for bp.2s and bp.1s yields a mean of the differences of -2.38 (CI-95% = [-4.20;-0.56]; p-value = 0.0109). 
> publish(with(Diabetes,wilcox.test(bp.2s,bp.1s,paired=TRUE)))

 The Wilcoxon signed rank test with continuity correction to compare the location shift for bp.2s and bp.1s yields a p-value of <0.001. 
> 
> 
> 
> 
> cleanEx()
> nameEx("publish.matrix")
> ### * publish.matrix
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.matrix
> ### Title: Publishing a matrix in raw, org, latex, or muse format
> ### Aliases: publish.matrix
> 
> ### ** Examples
> 
> 
> x <- matrix(1:12,ncol=3)
> publish(x)
 1 5  9 
 2 6 10 
 3 7 11 
 4 8 12 
> 
> # rounding the numeric part of data mixtures 
> y <- cbind(matrix(letters[1:12],ncol=3),x,matrix(rnorm(12),ncol=3))
> publish(y,digits=1)
 a e i 1.0 5.0  9.0 -0.6  0.3  0.6 
 b f j 2.0 6.0 10.0  0.2 -0.8 -0.3 
 c g k 3.0 7.0 11.0 -0.8  0.5  1.5 
 d h l 4.0 8.0 12.0  1.6  0.7  0.4 
> 
> publish(x,inter.lines=list("1"="text between line 1 and line 2",
+                           "3"="text between line 3 and line 4"))
 1 5  9 
text between line 1 and line 2 
 2 6 10 
 3 7 11 
text between line 3 and line 4 
 4 8 12 
> 
> 
> 
> 
> cleanEx()
> nameEx("publish.riskRegression")
> ### * publish.riskRegression
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.riskRegression
> ### Title: Publishing results of riskRegression
> ### Aliases: publish.riskRegression
> 
> ### ** Examples
> 
> library(prodlim)
> library(riskRegression)
Loading required package: data.table
Loading required package: ggplot2
riskRegression version 2019.01.29
> library(lava)

Attaching package: 'lava'

The following object is masked from 'package:ggplot2':

    vars

> library(survival)
> set.seed(20)
> d <- SimCompRisk(20)
> f <- ARR(Hist(time,event)~X1+X2,data=d,cause=1)
> publish(f)
 Factor  ARR       CI_95 p-value 
     X1 1.80 [0.89;3.62] 0.09927 
     X2 1.14 [0.84;1.55] 0.39935 
> publish(f,digits=c(1,3))
 Factor ARR     CI_95 p-value 
     X1 1.8 [0.9;3.6] 0.09927 
     X2 1.1 [0.8;1.6] 0.39935 
> 
> 
> 
> cleanEx()

detaching 'package:survival', 'package:lava', 'package:riskRegression',
  'package:ggplot2', 'package:data.table'

> nameEx("publish.summary.aov")
> ### * publish.summary.aov
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.summary.aov
> ### Title: Format summary table of aov results
> ### Aliases: publish.summary.aov
> 
> ### ** Examples
> 
>  
> data(Diabetes)
> f <- glm(bp.1s~age+chol+gender+location,data=Diabetes)
> publish(summary(aov(f)),digits=c(1,2))
 Factor Df F statistic p-value 
 age          1        97.3   <0.01 
 chol         1         5.3   0.022 
 gender       1         0.0   0.910 
 location     1         0.0   0.909 
> 
> 
> 
> 
> cleanEx()
> nameEx("publish.survdiff")
> ### * publish.survdiff
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: publish.survdiff
> ### Title: Alternative summary of survdiff results
> ### Aliases: publish.survdiff
> 
> ### ** Examples
> 
> library(survival)
> data(pbc)
> sd <- survdiff(Surv(time,status!=0)~sex,data=pbc)
> publish(sd)
 Log-rank test      N Observed Expected squared(O-E)/E squared(O-E)/V 
 sex=m  44.00    27.00    19.72           2.69           3.03 
 sex=f 374.00   159.00   166.28           0.32           3.03 

 Chisq= 3  on 1 degrees of freedom, p= 0.08189 
> publish(sd,digits=c(3,2))
 Log-rank test       N Observed Expected squared(O-E)/E squared(O-E)/V 
 sex=m  44.000   27.000   19.717          2.690          3.027 
 sex=f 374.000  159.000  166.283          0.319          3.027 

 Chisq= 3.03  on 1 degrees of freedom, p= 0.082 
> 
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("regressionTable")
> ### * regressionTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: regressionTable
> ### Title: Regression table
> ### Aliases: regressionTable
> 
> ### ** Examples
> 
> # linear regression
> data(Diabetes)
> f1 <- glm(bp.1s~age+gender+frame+chol,data=Diabetes)
> summary(regressionTable(f1))
  Variable  Units Coefficient         CI.95  p-value
1      age               0.55   [0.41;0.68]   <0.001
2   gender female         Ref                       
3            male       -0.32  [-4.55;3.92]   0.8840
4    frame  large         Ref                       
5          medium        0.07  [-5.07;5.21]   0.9790
6           small       -4.79 [-10.66;1.08]   0.1109
7     chol               0.05   [0.00;0.10]   0.0362
  Variable  Units Coefficient         CI.95  p-value
1      age               0.55   [0.41;0.68]   <0.001
2   gender female         Ref                       
3            male       -0.32  [-4.55;3.92]   0.8840
4    frame  large         Ref                       
5          medium        0.07  [-5.07;5.21]   0.9790
6           small       -4.79 [-10.66;1.08]   0.1109
7     chol               0.05   [0.00;0.10]   0.0362
> summary(regressionTable(f1,units=list("chol"="mmol/L","age"="years")))
  Variable  Units Coefficient         CI.95  p-value
1      age  years        0.55   [0.41;0.68]   <0.001
2   gender female         Ref                       
3            male       -0.32  [-4.55;3.92]   0.8840
4    frame  large         Ref                       
5          medium        0.07  [-5.07;5.21]   0.9790
6           small       -4.79 [-10.66;1.08]   0.1109
7     chol mmol/L        0.05   [0.00;0.10]   0.0362
  Variable  Units Coefficient         CI.95  p-value
1      age  years        0.55   [0.41;0.68]   <0.001
2   gender female         Ref                       
3            male       -0.32  [-4.55;3.92]   0.8840
4    frame  large         Ref                       
5          medium        0.07  [-5.07;5.21]   0.9790
6           small       -4.79 [-10.66;1.08]   0.1109
7     chol mmol/L        0.05   [0.00;0.10]   0.0362
> ## with interaction
> f2 <- glm(bp.1s~age*gender+frame+chol,data=Diabetes)
> summary(regressionTable(f2))
             Variable  Units Coefficient         CI.95   p-value
1               frame  large         Ref                        
2                     medium       -0.43  [-5.52;4.66]   0.86905
3                      small       -5.49 [-11.32;0.33]   0.06547
4                chol               0.03  [-0.01;0.08]   0.16751
5 age: gender(female)               0.71   [0.54;0.89]   < 0.001
6   age: gender(male)               0.30   [0.10;0.51]   0.00419
             Variable  Units Coefficient         CI.95   p-value
1               frame  large         Ref                        
2                     medium       -0.43  [-5.52;4.66]   0.86905
3                      small       -5.49 [-11.32;0.33]   0.06547
4                chol               0.03  [-0.01;0.08]   0.16751
5 age: gender(female)               0.71   [0.54;0.89]   < 0.001
6   age: gender(male)               0.30   [0.10;0.51]   0.00419
> #Add reference values
> summary(regressionTable(f2))
             Variable  Units Coefficient         CI.95   p-value
1               frame  large         Ref                        
2                     medium       -0.43  [-5.52;4.66]   0.86905
3                      small       -5.49 [-11.32;0.33]   0.06547
4                chol               0.03  [-0.01;0.08]   0.16751
5 age: gender(female)               0.71   [0.54;0.89]   < 0.001
6   age: gender(male)               0.30   [0.10;0.51]   0.00419
             Variable  Units Coefficient         CI.95   p-value
1               frame  large         Ref                        
2                     medium       -0.43  [-5.52;4.66]   0.86905
3                      small       -5.49 [-11.32;0.33]   0.06547
4                chol               0.03  [-0.01;0.08]   0.16751
5 age: gender(female)               0.71   [0.54;0.89]   < 0.001
6   age: gender(male)               0.30   [0.10;0.51]   0.00419
> f3 <- glm(bp.1s~age+gender*frame+chol,data=Diabetes)
> publish(f3)
                               Variable Units Coefficient          CI.95   p-value 
                            (Intercept)            105.08 [92.52;117.63]   < 1e-04 
                                    age              0.55    [0.42;0.68]   < 1e-04 
                                   chol              0.05    [0.00;0.10]   0.03416 
 gender(female): frame(medium vs large)             -3.55  [-10.83;3.73]   0.33845 
  gender(female): frame(small vs large)            -10.38 [-18.34;-2.41]   0.01079 
   gender(male): frame(medium vs large)              2.67   [-4.53;9.87]   0.46635 
    gender(male): frame(small vs large)              1.83  [-6.88;10.55]   0.67905 
   frame(large): gender(male vs female)             -6.32  [-14.36;1.71]   0.12269 
  frame(medium): gender(male vs female)             -0.10   [-6.29;6.08]   0.97340 
   frame(small): gender(male vs female)              5.89  [-2.53;14.31]   0.16985 
> regressionTable(f3)
$age
  Variable Units Missing Coefficient     Lower     Upper       Pvalue
1      age             0   0.5495559 0.4157932 0.6833187 1.068549e-14

$chol
  Variable Units Missing Coefficient       Lower      Upper     Pvalue
1     chol             0  0.05198229 0.004057613 0.09990697 0.03415868

$`gender:frame`
                                Variable Units Missing Coefficient      Lower
1 gender(female): frame(medium vs large)             0  -3.5483658 -10.827791
2  gender(female): frame(small vs large)             0 -10.3780717 -18.342524
3   gender(male): frame(medium vs large)             0   2.6701759  -4.530150
4    gender(male): frame(small vs large)             0   1.8346995  -6.877295
5   frame(large): gender(male vs female)             0  -6.3235403 -14.360741
6  frame(medium): gender(male vs female)             0  -0.1049986  -6.292633
7   frame(small): gender(male vs female)             0   5.8892309  -2.530575
      Upper     Pvalue
1  3.731059 0.33844548
2 -2.413620 0.01078997
3  9.870502 0.46634944
4 10.546694 0.67904763
5  1.713661 0.12269486
6  6.082636 0.97340061
7 14.309037 0.16985304

attr(,"terms1")
[1] "age"  "chol"
attr(,"terms2")
attr(,"terms2")$`gender:frame`
attr(,"terms2")$`gender:frame`$`gender(female): frame(medium vs large)`
p["framemedium"]

attr(,"terms2")$`gender:frame`$`gender(female): frame(small vs large)`
p["framesmall"]

attr(,"terms2")$`gender:frame`$`gender(male): frame(medium vs large)`
p["framemedium"] + p["gendermale:framemedium"]

attr(,"terms2")$`gender:frame`$`gender(male): frame(small vs large)`
p["framesmall"] + p["gendermale:framesmall"]

attr(,"terms2")$`gender:frame`$`frame(large): gender(male vs female)`
p["gendermale"]

attr(,"terms2")$`gender:frame`$`frame(medium): gender(male vs female)`
p["gendermale"] + p["gendermale:framemedium"]

attr(,"terms2")$`gender:frame`$`frame(small): gender(male vs female)`
p["gendermale"] + p["gendermale:framesmall"]

attr(,"variables")
[1] "gender" "frame" 

attr(,"factornames")
[1] "gender" "frame" 
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Linear regression"
attr(,"class")
[1] "regressionTable"
> 
> # logistic regression
> Diabetes$hyp1 <- factor(1*(Diabetes$bp.1s>140))
> l1 <- glm(hyp1~age+gender+frame+chol,data=Diabetes,family="binomial")
> regressionTable(l1)
$age
  Variable Units Missing OddsRatio    Lower    Upper       Pvalue
1      age             0  1.052822 1.035892 1.070029 4.865745e-10

$gender
  Variable  Units Missing OddsRatio     Lower    Upper    Pvalue
1   gender female       0 1.0000000 1.0000000 1.000000 1.0000000
2            male         0.8955719 0.5494923 1.459618 0.6580937

$frame
  Variable  Units Missing OddsRatio     Lower     Upper     Pvalue
1    frame  large       0 1.0000000 1.0000000 1.0000000 1.00000000
2          medium         0.8161795 0.4675405 1.4247939 0.47488756
3           small         0.4632868 0.2322323 0.9242238 0.02899141

$chol
  Variable Units Missing OddsRatio     Lower    Upper     Pvalue
1     chol             0  1.005118 0.9997744 1.010489 0.06051598

attr(,"terms1")
[1] "age"    "gender" "frame"  "chol"  
attr(,"factornames")
[1] "gender" "frame" 
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Logistic regression"
attr(,"class")
[1] "regressionTable"
> publish(l1)
 Variable  Units OddsRatio       CI.95   p-value 
      age             1.05 [1.04;1.07]   < 1e-04 
   gender female       Ref                       
            male      0.90 [0.55;1.46]   0.65809 
    frame  large       Ref                       
          medium      0.82 [0.47;1.42]   0.47489 
           small      0.46 [0.23;0.92]   0.02899 
     chol             1.01 [1.00;1.01]   0.06052 
> plot(regressionTable(l1))
> 
> ## with interaction
> l2 <- glm(hyp1~age+gender+frame*chol,data=Diabetes,family="binomial")
> regressionTable(l2)
$age
  Variable Units Missing OddsRatio    Lower    Upper       Pvalue
1      age             0  1.053501 1.036359 1.070927 4.765721e-10

$gender
  Variable  Units Missing OddsRatio     Lower    Upper    Pvalue
1   gender female       0 1.0000000 1.0000000 1.000000 1.0000000
2            male         0.8966231 0.5494884 1.463057 0.6622676

$`frame:chol`
             Variable Units Missing OddsRatio     Lower    Upper    Pvalue
1  chol: frame(large)             0  1.008174 0.9980287 1.018423 0.1146597
2 chol: frame(medium)             0  1.003935 0.9968739 1.011047 0.2754686
3  chol: frame(small)             0  1.003844 0.9907574 1.017103 0.5666307

attr(,"terms1")
[1] "age"    "gender"
attr(,"terms2")
attr(,"terms2")$`frame:chol`
attr(,"terms2")$`frame:chol`$`chol: frame(large)`
p["chol"]

attr(,"terms2")$`frame:chol`$`chol: frame(medium)`
p["chol"] + p["framemedium:chol"]

attr(,"terms2")$`frame:chol`$`chol: frame(small)`
p["chol"] + p["framesmall:chol"]

attr(,"variables")
[1] "frame" "chol" 

attr(,"factornames")
[1] "gender" "frame" 
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Logistic regression"
attr(,"class")
[1] "regressionTable"
> l3 <- glm(hyp1~age*gender+frame*chol,data=Diabetes,family="binomial")
> regressionTable(l3)
$`age:gender`
             Variable Units Missing OddsRatio    Lower    Upper       Pvalue
1 age: gender(female)             0  1.082396 1.055167 1.110327 1.122988e-09
2   age: gender(male)             0  1.023968 1.000790 1.047683 4.260094e-02

$`frame:chol`
             Variable Units Missing OddsRatio     Lower    Upper    Pvalue
1  chol: frame(large)             0  1.005060 0.9949852 1.015238 0.3261226
2 chol: frame(medium)             0  1.002805 0.9956172 1.010045 0.4453430
3  chol: frame(small)             0  1.000721 0.9872088 1.014419 0.9172119

attr(,"terms1")
character(0)
attr(,"terms2")
attr(,"terms2")$`age:gender`
attr(,"terms2")$`age:gender`$`age: gender(female)`
p["age"]

attr(,"terms2")$`age:gender`$`age: gender(male)`
p["age"] + p["age:gendermale"]

attr(,"variables")
[1] "age"    "gender"

attr(,"terms2")$`frame:chol`
attr(,"terms2")$`frame:chol`$`chol: frame(large)`
p["chol"]

attr(,"terms2")$`frame:chol`$`chol: frame(medium)`
p["chol"] + p["framemedium:chol"]

attr(,"terms2")$`frame:chol`$`chol: frame(small)`
p["chol"] + p["framesmall:chol"]

attr(,"variables")
[1] "frame" "chol" 

attr(,"factornames")
[1] "gender" "frame" 
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Logistic regression"
attr(,"class")
[1] "regressionTable"
> 
> # Cox regression
> library(survival)
> data(pbc)
> pbc$edema <- factor(pbc$edema,levels=c("0","0.5","1"),labels=c("0","0.5","1"))
> c1 <- coxph(Surv(time,status!=0)~log(bili)+age+protime+sex+edema,data=pbc)
> regressionTable(c1)
$`log(bili)`
   Variable Units Missing HazardRatio   Lower    Upper       Pvalue
1 log(bili)             0    2.418174 2.08531 2.804171 1.499094e-31

$age
  Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1      age             0    1.026457 1.011944 1.041178 0.0003254578

$protime
  Variable Units Missing HazardRatio    Lower    Upper     Pvalue
1  protime             2    1.139161 1.008715 1.286477 0.03574599

$sex
  Variable Units Missing HazardRatio     Lower    Upper   Pvalue
1      sex     m       0   1.0000000 1.0000000 1.000000 1.000000
2              f           0.8176006 0.5351699 1.249081 0.351668

$edema
  Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1    edema     0       0    1.000000 1.000000 1.000000 1.000000e+00
2            0.5            1.658182 1.093306 2.514913 1.732526e-02
3              1            3.623486 2.123927 6.181781 2.314398e-06

attr(,"terms1")
[1] "log(bili)" "age"       "protime"   "sex"       "edema"    
attr(,"factornames")
[1] "sex"   "edema"
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Cox regression"
attr(,"class")
[1] "regressionTable"
> # with interaction
> c2 <- coxph(Surv(time,status!=0)~log(bili)+age+protime*sex+edema,data=pbc)
> regressionTable(c2)
$`log(bili)`
   Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1 log(bili)             0    2.423076 2.088993 2.810588 1.393077e-31

$age
  Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1      age             0    1.026292 1.011761 1.041032 0.0003611322

$edema
  Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1    edema     0       0    1.000000 1.000000 1.000000 1.000000e+00
2            0.5            1.661394 1.095205 2.520287 1.695438e-02
3              1            3.618942 2.120318 6.176782 2.413636e-06

$`protime:sex`
         Variable Units Missing HazardRatio     Lower    Upper     Pvalue
1 protime: sex(m)             2    1.247151 0.7456698 2.085890 0.39999286
2 protime: sex(f)             2    1.133583 0.9997733 1.285301 0.05041489

attr(,"terms1")
[1] "log(bili)" "age"       "edema"    
attr(,"terms2")
attr(,"terms2")$`protime:sex`
attr(,"terms2")$`protime:sex`$`protime: sex(m)`
p["protime"]

attr(,"terms2")$`protime:sex`$`protime: sex(f)`
p["protime"] + p["protime:sexf"]

attr(,"variables")
[1] "protime" "sex"    

attr(,"factornames")
[1] "sex"   "edema"
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Cox regression"
attr(,"class")
[1] "regressionTable"
> c3 <- coxph(Surv(time,status!=0)~edema*log(bili)+age+protime+sex+edema+edema:sex,data=pbc)
> regressionTable(c3)
$age
  Variable Units Missing HazardRatio    Lower    Upper       Pvalue
1      age             0    1.025318 1.010451 1.040404 0.0007931343

$protime
  Variable Units Missing HazardRatio    Lower    Upper     Pvalue
1  protime             2    1.135696 1.006028 1.282076 0.03967499

$`edema:log(bili)`
               Variable Units Missing HazardRatio    Lower    Upper
1   log(bili): edema(0)             0    2.585190 2.185030 3.058635
2 log(bili): edema(0.5)             0    2.376523 1.711196 3.300535
3   log(bili): edema(1)             0    2.229974 1.197099 4.154031
        Pvalue
1 1.761556e-28
2 2.396716e-07
3 1.151192e-02

$`edema:sex`
                 Variable Units Missing HazardRatio      Lower      Upper
1   edema(0): sex(f vs m)             0   1.0502349 0.64780385  1.7026656
2 edema(0.5): sex(f vs m)             0   0.3126828 0.10449416  0.9356556
3   edema(1): sex(f vs m)             0   0.1906415 0.03139927  1.1574847
4 sex(m): edema(0.5 vs 0)             0   5.4286024 1.71882061 17.1453172
5   sex(m): edema(1 vs 0)             0  21.8070663 6.13640596 77.4961998
6 sex(f): edema(0.5 vs 0)             0   1.6162392 0.84884915  3.0773772
7   sex(f): edema(1 vs 0)             0   3.9584778 0.97181811 16.1239500
        Pvalue
1 8.424047e-01
2 3.762720e-02
3 7.169713e-02
4 3.938419e-03
5 1.895401e-06
6 1.439584e-01
7 5.484904e-02

attr(,"terms1")
[1] "age"     "protime"
attr(,"terms2")
attr(,"terms2")$`edema:log(bili)`
attr(,"terms2")$`edema:log(bili)`$`log(bili): edema(0)`
p["log(bili)"]

attr(,"terms2")$`edema:log(bili)`$`log(bili): edema(0.5)`
p["log(bili)"] + p["edema0.5:log(bili)"]

attr(,"terms2")$`edema:log(bili)`$`log(bili): edema(1)`
p["log(bili)"] + p["edema1:log(bili)"]

attr(,"variables")
[1] "edema"     "log(bili)"

attr(,"terms2")$`edema:sex`
attr(,"terms2")$`edema:sex`$`edema(0): sex(f vs m)`
p["sexf"]

attr(,"terms2")$`edema:sex`$`edema(0.5): sex(f vs m)`
p["sexf"] + p["edema0.5:sexf"]

attr(,"terms2")$`edema:sex`$`edema(1): sex(f vs m)`
p["sexf"] + p["edema1:sexf"]

attr(,"terms2")$`edema:sex`$`sex(m): edema(0.5 vs 0)`
p["edema0.5"]

attr(,"terms2")$`edema:sex`$`sex(m): edema(1 vs 0)`
p["edema1"]

attr(,"terms2")$`edema:sex`$`sex(f): edema(0.5 vs 0)`
p["edema0.5"] + p["edema0.5:sexf"]

attr(,"terms2")$`edema:sex`$`sex(f): edema(1 vs 0)`
p["edema1"] + p["edema1:sexf"]

attr(,"variables")
[1] "edema" "sex"  

attr(,"factornames")
[1] "edema" "sex"  
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Cox regression"
attr(,"class")
[1] "regressionTable"
> 
> 
> ## gls regression
> library(nlme)
> library(lava)
> m <- lvm(Y ~ X1 + gender + group + Interaction)
> distribution(m, ~gender) <- binomial.lvm()
> distribution(m, ~group) <- binomial.lvm(size = 2)
> constrain(m, Interaction ~ gender + group) <- function(x){x[,1]*x[,2]}
> d <- sim(m, 1e2)
> d$gender <- factor(d$gender, labels = letters[1:2])
> d$group <- factor(d$group)
> 
> e.gls <- gls(Y ~ X1 + gender*group, data = d,
+              weights = varIdent(form = ~1|group))
> regressionTable(e.gls)
Error in eval(parse(text = misscall), data) : object 'X1' not found
Error in eval(parse(text = misscall), data) : object 'gender' not found
$X1
  Variable Units Missing Coefficient     Lower    Upper       Pvalue
1       X1          <NA>   0.9799182 0.7915513 1.168285 7.891467e-17

$`gender:group`
                  Variable Units Missing Coefficient     Lower    Upper
1 gender(a): group(1 vs 0)            NA    1.067425 0.4005536 1.734297
2 gender(a): group(2 vs 0)            NA    2.301137 1.4675701 3.134705
3 gender(b): group(1 vs 0)            NA    2.289830 1.7331029 2.846557
4 gender(b): group(2 vs 0)            NA    3.728180 3.1273203 4.329040
5 group(0): gender(b vs a)            NA    1.055310 0.3679479 1.742672
6 group(1): gender(b vs a)            NA    2.277714 1.7464522 2.808977
7 group(2): gender(b vs a)            NA    2.482353 1.7187872 3.245918
        Pvalue
1 1.705653e-03
2 6.279429e-08
3 7.544143e-16
4 5.009956e-34
5 2.619873e-03
6 4.349201e-17
7 1.867669e-10

attr(,"terms1")
[1] "X1"
attr(,"terms2")
attr(,"terms2")$`gender:group`
attr(,"terms2")$`gender:group`$`gender(a): group(1 vs 0)`
p["group1"]

attr(,"terms2")$`gender:group`$`gender(a): group(2 vs 0)`
p["group2"]

attr(,"terms2")$`gender:group`$`gender(b): group(1 vs 0)`
p["group1"] + p["genderb:group1"]

attr(,"terms2")$`gender:group`$`gender(b): group(2 vs 0)`
p["group2"] + p["genderb:group2"]

attr(,"terms2")$`gender:group`$`group(0): gender(b vs a)`
p["genderb"]

attr(,"terms2")$`gender:group`$`group(1): gender(b vs a)`
p["genderb"] + p["genderb:group1"]

attr(,"terms2")$`gender:group`$`group(2): gender(b vs a)`
p["genderb"] + p["genderb:group2"]

attr(,"variables")
[1] "gender" "group" 

attr(,"factornames")
[1] "gender" "group" 
attr(,"factor.reference")
[1] "extraline"
attr(,"orderednames")
character(0)
attr(,"model")
[1] "Linear regression"
attr(,"class")
[1] "regressionTable"
> summary(regressionTable(e.gls))
Error in eval(parse(text = misscall), data) : object 'X1' not found
Error in eval(parse(text = misscall), data) : object 'gender' not found
                  Variable Units Coefficient       CI.95   p-value
1                       X1              0.98 [0.79;1.17]   < 0.001
2 gender(a): group(1 vs 0)              1.07 [0.40;1.73]   0.00171
3 gender(a): group(2 vs 0)              2.30 [1.47;3.13]   < 0.001
4 gender(b): group(1 vs 0)              2.29 [1.73;2.85]   < 0.001
5 gender(b): group(2 vs 0)              3.73 [3.13;4.33]   < 0.001
6 group(0): gender(b vs a)              1.06 [0.37;1.74]   0.00262
7 group(1): gender(b vs a)              2.28 [1.75;2.81]   < 0.001
8 group(2): gender(b vs a)              2.48 [1.72;3.25]   < 0.001
                  Variable Units Coefficient       CI.95   p-value
1                       X1              0.98 [0.79;1.17]   < 0.001
2 gender(a): group(1 vs 0)              1.07 [0.40;1.73]   0.00171
3 gender(a): group(2 vs 0)              2.30 [1.47;3.13]   < 0.001
4 gender(b): group(1 vs 0)              2.29 [1.73;2.85]   < 0.001
5 gender(b): group(2 vs 0)              3.73 [3.13;4.33]   < 0.001
6 group(0): gender(b vs a)              1.06 [0.37;1.74]   0.00262
7 group(1): gender(b vs a)              2.28 [1.75;2.81]   < 0.001
8 group(2): gender(b vs a)              2.48 [1.72;3.25]   < 0.001
> 
> 
> 
> cleanEx()

detaching 'package:lava', 'package:nlme', 'package:survival'

> nameEx("spaghettiogram")
> ### * spaghettiogram
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: spaghettiogram
> ### Title: Spaghettiogram
> ### Aliases: spaghettiogram Spaghettiogram
> 
> ### ** Examples
> 
> 
> data(SpaceT)
> Spaghettiogram(HR~Status+id(ID),
+                data=SpaceT)
> 
> 
> 
> cleanEx()
> nameEx("specialFrame")
> ### * specialFrame
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: specialFrame
> ### Title: Special frame
> ### Aliases: specialFrame
> 
> ### ** Examples
> 
> 
> ## Here are some data with an event time and no competing risks
> ## and two covariates X1 and X2.
> ## Suppose we want to declare that variable X1 is treated differently
> ## than variable X2. For example, X1 could be a cluster variable, or
> ## X1 should have a proportional effect on the outcome.
> d <- data.frame(y=1:7,
+                 X2=c(2.24,3.22,9.59,4.4,3.54,6.81,5.05),
+                 X3=c(1,1,1,1,0,0,1),
+                 X4=c(44.69,37.41,68.54,38.85,35.9,27.02,41.84),
+                 X1=factor(c("a","b","a","c","c","a","b"),
+                     levels=c("c","a","b")))
> ## define special functions prop and cluster
> prop <- function(x)x
> cluster <- function(x)x
> ## We pass a formula and the data
> e <- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
+                   data=d,
+                   specials=c("prop","cluster"))
> ## The first element is the response
> e$response
  y
1 1
2 2
3 3
4 4
5 5
6 6
7 7
> ## The other elements are the design, i.e., model.matrix for the non-special covariates
> e$design
    X2    X4
1 2.24 44.69
2 3.22 37.41
3 9.59 68.54
4 4.40 38.85
5 3.54 35.90
6 6.81 27.02
7 5.05 41.84
attr(,"levels")
named list()
> ## and a data.frame for the special covariates
> e$prop
  prop(X1)
1        a
2        b
3        a
4        c
5        c
6        a
7        b
> ## The special covariates can be returned as a model.matrix 
> e2 <- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
+                    data=d,
+                    specials=c("prop","cluster"),
+                    specials.design=TRUE)
> e2$prop
  prop(X1)a prop(X1)b
1         1         0
2         0         1
3         1         0
4         0         0
5         0         0
6         1         0
7         0         1
attr(,"levels")
attr(,"levels")$`prop(X1)`
[1] "c" "a" "b"

> ## and the non-special covariates can be returned as a data.frame
> e3 <- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
+                    data=d,
+                    specials=c("prop","cluster"),
+                    specials.design=TRUE,
+                    unspecials.design=FALSE)
> e3$design
    X2    X4
1 2.24 44.69
2 3.22 37.41
3 9.59 68.54
4 4.40 38.85
5 3.54 35.90
6 6.81 27.02
7 5.05 41.84
> 
> 
> 
> cleanEx()
> nameEx("splinePlot.lrm")
> ### * splinePlot.lrm
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: splinePlot.lrm
> ### Title: Plot predictions of logistic regression
> ### Aliases: splinePlot.lrm
> 
> ### ** Examples
> 
> data(Diabetes)
> Diabetes$hypertension=  1*(Diabetes$bp.1s>140)
> library(rms)
Loading required package: Hmisc
Loading required package: lattice
Loading required package: survival
Loading required package: Formula
Loading required package: ggplot2

Attaching package: 'Hmisc'

The following objects are masked from 'package:base':

    format.pval, units

Loading required package: SparseM

Attaching package: 'SparseM'

The following object is masked from 'package:base':

    backsolve

> uu <- datadist(Diabetes)
> options(datadist="uu")
> fit=lrm(hypertension~rcs(age)+gender+hdl,data=Diabetes)
> splinePlot.lrm(fit,xvar="age",xvalues=seq(30,50,1))
    age gender hdl      yhat      lower     upper
 1:  30 female  46 0.1181281 0.06915692 0.1945298
 2:  31 female  46 0.1222887 0.07097099 0.2026202
 3:  32 female  46 0.1274372 0.07328942 0.2124205
 4:  33 female  46 0.1337681 0.07654325 0.2234243
 5:  34 female  46 0.1415141 0.08117780 0.2352156
 6:  35 female  46 0.1509557 0.08768447 0.2474965
 7:  36 female  46 0.1624320 0.09663224 0.2601346
 8:  37 female  46 0.1762614 0.10854389 0.2732752
 9:  38 female  46 0.1924278 0.12337668 0.2874529
10:  39 female  46 0.2107508 0.14062495 0.3034965
11:  40 female  46 0.2309323 0.15931785 0.3223931
12:  41 female  46 0.2525344 0.17813660 0.3449623
13:  42 female  46 0.2749702 0.19584856 0.3712977
14:  43 female  46 0.2975134 0.21179959 0.4002984
15:  44 female  46 0.3193248 0.22603789 0.4297350
16:  45 female  46 0.3394911 0.23904673 0.4568048
17:  46 female  46 0.3572352 0.25140623 0.4791015
18:  47 female  46 0.3724798 0.26352247 0.4961385
19:  48 female  46 0.3853942 0.27552042 0.5083401
20:  49 female  46 0.3962123 0.28731612 0.5164715
21:  50 female  46 0.4052123 0.29867197 0.5214975
    age gender hdl      yhat      lower     upper
> 
> 
> 
> cleanEx()

detaching 'package:rms', 'package:SparseM', 'package:Hmisc',
  'package:ggplot2', 'package:Formula', 'package:survival',
  'package:lattice'

> nameEx("stripes")
> ### * stripes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: stripes
> ### Title: Background and grid color control.
> ### Aliases: stripes
> ### Keywords: survival
> 
> ### ** Examples
> 
> 
> 
> plot(0,0)
> backGround(bg="beige",fg="red",vertical=0,horizontal=0)
> 
> plot(0,0)
> stripes(col=c("yellow","green"),gridcol="red",xlim=c(-1,1),horizontal=seq(0,1,.1))
> stripes(col=c("yellow","green"),gridcol="red",horizontal=seq(0,1,.1))
> 
> 
> 
> 
> cleanEx()
> nameEx("summary.ci")
> ### * summary.ci
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.ci
> ### Title: Summarize confidence intervals
> ### Aliases: summary.ci
> 
> ### ** Examples
> 
> library(lava)
> m <- lvm(Y~X)
> m <- categorical(m,Y~X,K=4)
> set.seed(4)
> d <- sim(m,24)
> ci.mean(Y~X,data=d)
 X mean CI-95%      
 0 1.12 [0.14;2.10] 
 1 0.22 [-0.41;0.86]
 2 0.05 [-1.64;1.74]
 3 0.44 [0.02;0.87] 
> x <- summary(ci.mean(Y~X,data=d),digits=2)
 X mean CI-95%      
 0 1.12 [0.14;2.10] 
 1 0.22 [-0.41;0.86]
 2 0.05 [-1.64;1.74]
 3 0.44 [0.02;0.87] 
> x
 X   mean   CI-95%        
 "0" "1.12" "[0.14;2.10]" 
 "1" "0.22" "[-0.41;0.86]"
 "2" "0.05" "[-1.64;1.74]"
 "3" "0.44" "[0.02;0.87]" 
> x <- summary(ci.mean(Y~X,data=d),format="(u,l)",digits=2)
 X mean CI-95%      
 0 1.12 (0.14,2.10) 
 1 0.22 (-0.41,0.86)
 2 0.05 (-1.64,1.74)
 3 0.44 (0.02,0.87) 
> x <- summary(ci.mean(Y~X,data=d),format="(u,l)",digits=1,se=TRUE)
 X mean se  CI-95%    
 0 1.1  0.4 (0.1,2.1) 
 1 0.2  0.2 (-0.4,0.9)
 2 0.0  0.5 (-1.6,1.7)
 3 0.4  0.2 (0.0,0.9) 
> x <- summary(ci.mean(Y~X,data=d),format="(u,l)",digits=1,handler="format")
 X mean CI-95%     
 0 1.12 ( 0.14,2.1)
 1 0.22 (-0.41,0.9)
 2 0.05 (-1.64,1.7)
 3 0.44 ( 0.02,0.9)
> x <- summary(ci.mean(Y~X,data=d),format="(u,l)",digits=1,handler="prettyNum")
 X mean CI-95%    
 0 1.1  (0.1,2.1) 
 1 0.2  (-0.4,0.9)
 2 0.05 (-1.6,1.7)
 3 0.4  (0.02,0.9)
> 
> 
> 
> cleanEx()

detaching 'package:lava'

> nameEx("summary.regressionTable")
> ### * summary.regressionTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.regressionTable
> ### Title: Formatting regression tables
> ### Aliases: summary.regressionTable print.summary.regressionTable
> 
> ### ** Examples
> 
> library(survival)
> data(pbc)
> pbc$edema <- factor(pbc$edema,levels=c("0","0.5","1"),labels=c("0","0.5","1"))
> fit = coxph(Surv(time,status!=0)~age+sex+edema+log(bili)+log(albumin)+log(protime),
+             data=pbc)
> u=summary(regressionTable(fit))
      Variable Units Missing HazardRatio        CI.95   p-value
1          age             0        1.02  [1.01;1.04]   0.00254
2          sex     m       0         Ref                       
3                  f                0.77  [0.50;1.18]   0.23464
4        edema     0       0         Ref                       
5                0.5                1.40  [0.92;2.14]   0.11607
6                  1                2.67  [1.54;4.63]   < 0.001
7    log(bili)             0        2.30  [1.98;2.67]   < 0.001
8 log(albumin)             0        0.07  [0.02;0.24]   < 0.001
9 log(protime)             2        5.00 [1.16;21.55]   0.03095
> u$regressionTable
      Variable Units Missing HazardRatio        CI.95   p-value
1          age             0        1.02  [1.01;1.04]   0.00254
2          sex     m       0         Ref                       
3                  f                0.77  [0.50;1.18]   0.23464
4        edema     0       0         Ref                       
5                0.5                1.40  [0.92;2.14]   0.11607
6                  1                2.67  [1.54;4.63]   < 0.001
7    log(bili)             0        2.30  [1.98;2.67]   < 0.001
8 log(albumin)             0        0.07  [0.02;0.24]   < 0.001
9 log(protime)             2        5.00 [1.16;21.55]   0.03095
> u$rawTable
      Variable Units Missing HazardRatio      Lower      Upper       Pvalue
1          age             0  1.02262728 1.00787854  1.0375918 2.538350e-03
2          sex     m       0  1.00000000 1.00000000  1.0000000 1.000000e+00
3                  f          0.77160701 0.50315193  1.1832954 2.346395e-01
4        edema     0       0  1.00000000 1.00000000  1.0000000 1.000000e+00
5                0.5          1.40427549 0.91949181  2.1446517 1.160724e-01
6                  1          2.67055994 1.54125453  4.6273281 4.610551e-04
7    log(bili)             0  2.29801668 1.97527593  2.6734901 4.482123e-27
8 log(albumin)             0  0.07169386 0.02182819  0.2354758 1.402908e-05
9 log(protime)             2  4.99711387 1.15887822 21.5476886 3.094964e-02
> summary(regressionTable(fit),handler="prettyNum")
      Variable Units Missing HazardRatio        CI.95   p-value
1          age             0        1.02  [1.01;1.04]   0.00254
2          sex     m       0         Ref                       
3                  f                0.77  [0.50;1.18]   0.23464
4        edema     0       0         Ref                       
5                0.5                1.40  [0.92;2.14]   0.11607
6                  1                2.67  [1.54;4.63]   < 0.001
7    log(bili)             0        2.30  [1.98;2.67]   < 0.001
8 log(albumin)             0       0.072 [0.022;0.24]   < 0.001
9 log(protime)             2        5.00 [1.16;21.55]   0.03095
      Variable Units Missing HazardRatio        CI.95   p-value
1          age             0        1.02  [1.01;1.04]   0.00254
2          sex     m       0         Ref                       
3                  f                0.77  [0.50;1.18]   0.23464
4        edema     0       0         Ref                       
5                0.5                1.40  [0.92;2.14]   0.11607
6                  1                2.67  [1.54;4.63]   < 0.001
7    log(bili)             0        2.30  [1.98;2.67]   < 0.001
8 log(albumin)             0       0.072 [0.022;0.24]   < 0.001
9 log(protime)             2        5.00 [1.16;21.55]   0.03095
> summary(regressionTable(fit),handler="format")
      Variable Units Missing HazardRatio         CI.95   p-value
1          age             0       1.023 [1.008; 1.04]   0.00254
2          sex     m       0         Ref                        
3                  f               0.772 [0.503; 1.18]   0.23464
4        edema     0       0         Ref                        
5                0.5               1.404 [0.919; 2.14]   0.11607
6                  1               2.671 [1.541; 4.63]   < 0.001
7    log(bili)             0       2.298 [1.975; 2.67]   < 0.001
8 log(albumin)             0       0.072 [0.022; 0.24]   < 0.001
9 log(protime)             2       4.997 [1.159;21.55]   0.03095
      Variable Units Missing HazardRatio         CI.95   p-value
1          age             0       1.023 [1.008; 1.04]   0.00254
2          sex     m       0         Ref                        
3                  f               0.772 [0.503; 1.18]   0.23464
4        edema     0       0         Ref                        
5                0.5               1.404 [0.919; 2.14]   0.11607
6                  1               2.671 [1.541; 4.63]   < 0.001
7    log(bili)             0       2.298 [1.975; 2.67]   < 0.001
8 log(albumin)             0       0.072 [0.022; 0.24]   < 0.001
9 log(protime)             2       4.997 [1.159;21.55]   0.03095
> summary(regressionTable(fit),handler="sprintf",digits=c(2,2),pValue.stars=TRUE)
      Variable Units Missing HazardRatio        CI.95 p-value signif
1          age             0        1.02  [1.01;1.04]   <0.01     **
2          sex     m       0         Ref                            
3                  f                0.77  [0.50;1.18]   0.235       
4        edema     0       0         Ref                            
5                0.5                1.40  [0.92;2.14]   0.116       
6                  1                2.67  [1.54;4.63]   <0.01    ***
7    log(bili)             0        2.30  [1.98;2.67]   <0.01    ***
8 log(albumin)             0        0.07  [0.02;0.24]   <0.01    ***
9 log(protime)             2        5.00 [1.16;21.55]   0.031      *
      Variable Units Missing HazardRatio        CI.95 p-value signif
1          age             0        1.02  [1.01;1.04]   <0.01     **
2          sex     m       0         Ref                            
3                  f                0.77  [0.50;1.18]   0.235       
4        edema     0       0         Ref                            
5                0.5                1.40  [0.92;2.14]   0.116       
6                  1                2.67  [1.54;4.63]   <0.01    ***
7    log(bili)             0        2.30  [1.98;2.67]   <0.01    ***
8 log(albumin)             0        0.07  [0.02;0.24]   <0.01    ***
9 log(protime)             2        5.00 [1.16;21.55]   0.031      *
> 
> 
> 
> cleanEx()

detaching 'package:survival'

> nameEx("summary.univariateTable")
> ### * summary.univariateTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.univariateTable
> ### Title: Preparing univariate tables for publication
> ### Aliases: summary.univariateTable
> 
> ### ** Examples
> 
> data(Diabetes)
> u <- univariateTable(gender~age+location+Q(BMI)+height+weight,
+                 data=Diabetes)
> summary(u)
  Variable        Level    female (n=234)      male (n=169)     Total (n=403)
1      age    mean (sd)       45.8 (16.6)       48.3 (15.8)       46.9 (16.3)
2 location   Buckingham        114 (48.7)         86 (50.9)        200 (49.6)
3                Louisa        120 (51.3)         83 (49.1)        203 (50.4)
4      BMI median [iqr] 29.5 [25.4, 34.0] 25.9 [23.1, 30.1] 27.8 [24.1, 32.2]
5               missing                 5                 1                 6
6   height    mean (sd)        63.7 (2.8)        69.1 (2.9)        66.0 (3.9)
7               missing                 5                 0                 5
8   weight    mean (sd)      174.5 (41.2)      181.9 (38.8)      177.6 (40.3)
9               missing                 0                 1                 1
  p-value
1 0.13994
2        
3 0.74223
4 < 1e-04
5        
6 < 1e-04
7        
8 0.06777
9        
> summary(u,n=NULL)
  Variable        Level            female              male             Total
1      age    mean (sd)       45.8 (16.6)       48.3 (15.8)       46.9 (16.3)
2 location   Buckingham        114 (48.7)         86 (50.9)        200 (49.6)
3                Louisa        120 (51.3)         83 (49.1)        203 (50.4)
4      BMI median [iqr] 29.5 [25.4, 34.0] 25.9 [23.1, 30.1] 27.8 [24.1, 32.2]
5               missing                 5                 1                 6
6   height    mean (sd)        63.7 (2.8)        69.1 (2.9)        66.0 (3.9)
7               missing                 5                 0                 5
8   weight    mean (sd)      174.5 (41.2)      181.9 (38.8)      177.6 (40.3)
9               missing                 0                 1                 1
  p-value
1 0.13994
2        
3 0.74223
4 < 1e-04
5        
6 < 1e-04
7        
8 0.06777
9        
> summary(u,pvalue.digits=2,"age"="Age (years)","height"="Body height (cm)")
          Variable        Level    female (n=234)      male (n=169)
1      Age (years)    mean (sd)       45.8 (16.6)       48.3 (15.8)
2         location   Buckingham        114 (48.7)         86 (50.9)
3                        Louisa        120 (51.3)         83 (49.1)
4              BMI median [iqr] 29.5 [25.4, 34.0] 25.9 [23.1, 30.1]
5                       missing                 5                 1
6 Body height (cm)    mean (sd)        63.7 (2.8)        69.1 (2.9)
7                       missing                 5                 0
8           weight    mean (sd)      174.5 (41.2)      181.9 (38.8)
9                       missing                 0                 1
      Total (n=403) p-value
1       46.9 (16.3)   0.140
2        200 (49.6)        
3        203 (50.4)   0.742
4 27.8 [24.1, 32.2]   <0.01
5                 6        
6        66.0 (3.9)   <0.01
7                 5        
8      177.6 (40.3)   0.068
9                 1        
> 
> u2 <- univariateTable(location~age+AgeGroups+gender+height+weight,
+                 data=Diabetes)
> summary(u2)
    Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1        age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3) 0.78473
2  AgeGroups       <40          77 (38.5)      83 (40.9)    160 (39.7)        
3                40-50          43 (21.5)      39 (19.2)     82 (20.3)        
4                50-60          29 (14.5)      40 (19.7)     69 (17.1)        
5                60-70          32 (16.0)      24 (11.8)     56 (13.9)        
6                  >70           19 (9.5)       17 (8.4)      36 (8.9) 0.49238
7     gender    female         114 (57.0)     120 (59.1)    234 (58.1)        
8                 male          86 (43.0)      83 (40.9)    169 (41.9) 0.74223
9     height mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9) 0.01549
10             missing                  3              2             5        
11    weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3) 0.58067
12             missing                  0              1             1        
> summary(u2,drop.reference=TRUE)
    Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1        age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3) 0.78473
2  AgeGroups     40-50          43 (21.5)      39 (19.2)     82 (20.3)        
3                50-60          29 (14.5)      40 (19.7)     69 (17.1)        
4                60-70          32 (16.0)      24 (11.8)     56 (13.9)        
5                  >70           19 (9.5)       17 (8.4)      36 (8.9) 0.49238
6     gender      male          86 (43.0)      83 (40.9)    169 (41.9) 0.74223
7     height mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9) 0.01549
8              missing                  3              2             5        
9     weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3) 0.58067
10             missing                  0              1             1        
> ## same but more flexible
> summary(u2,drop.reference=c("binary"))
    Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1        age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3) 0.78473
2  AgeGroups       <40          77 (38.5)      83 (40.9)    160 (39.7)        
3                40-50          43 (21.5)      39 (19.2)     82 (20.3)        
4                50-60          29 (14.5)      40 (19.7)     69 (17.1)        
5                60-70          32 (16.0)      24 (11.8)     56 (13.9)        
6                  >70           19 (9.5)       17 (8.4)      36 (8.9) 0.49238
7     gender      male          86 (43.0)      83 (40.9)    169 (41.9) 0.74223
8     height mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9) 0.01549
9              missing                  3              2             5        
10    weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3) 0.58067
11             missing                  0              1             1        
> ## same but even more flexible
> summary(u2,drop.reference=c("gender"))
    Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1        age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3) 0.78473
2  AgeGroups       <40          77 (38.5)      83 (40.9)    160 (39.7)        
3                40-50          43 (21.5)      39 (19.2)     82 (20.3)        
4                50-60          29 (14.5)      40 (19.7)     69 (17.1)        
5                60-70          32 (16.0)      24 (11.8)     56 (13.9)        
6                  >70           19 (9.5)       17 (8.4)      36 (8.9) 0.49238
7     gender      male          86 (43.0)      83 (40.9)    169 (41.9) 0.74223
8     height mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9) 0.01549
9              missing                  3              2             5        
10    weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3) 0.58067
11             missing                  0              1             1        
> 
> 
> 
> 
> 
> cleanEx()
> nameEx("sutable")
> ### * sutable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: sutable
> ### Title: Fast summary of a univariate table
> ### Aliases: sutable
> 
> ### ** Examples
> 
> data(Diabetes)
> sutable(gender~age+location+Q(BMI)+height+weight,data=Diabetes,BMI="Body mass index (kg/m^2)")
                  Variable        Level    female (n=234)      male (n=169)
1                      age    mean (sd)       45.8 (16.6)       48.3 (15.8)
2                 location   Buckingham        114 (48.7)         86 (50.9)
3                                Louisa        120 (51.3)         83 (49.1)
4 Body mass index (kg/m^2) median [iqr] 29.5 [25.4, 34.0] 25.9 [23.1, 30.1]
5                               missing                 5                 1
6                   height    mean (sd)        63.7 (2.8)        69.1 (2.9)
7                               missing                 5                 0
8                   weight    mean (sd)      174.5 (41.2)      181.9 (38.8)
9                               missing                 0                 1
      Total (n=403) p-value
1       46.9 (16.3) 0.13994
2        200 (49.6)        
3        203 (50.4) 0.74223
4 27.8 [24.1, 32.2] < 1e-04
5                 6        
6        66.0 (3.9) < 1e-04
7                 5        
8      177.6 (40.3) 0.06777
9                 1        
> 
> 
> 
> cleanEx()
> nameEx("table2x2")
> ### * table2x2
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: table2x2
> ### Title: 2x2 table calculus for teaching
> ### Aliases: table2x2
> 
> ### ** Examples
> 
> table2x2(table("marker"=rbinom(100,1,0.4),"response"=rbinom(100,1,0.1)))
_____________________________

2x2 contingency table
_____________________________

            response0     response1     Sum
marker0            55             2      57
marker1            36             7      43
--                 --            --      --
Sum                91             9     100

_____________________________

Statistics
_____________________________


a= 55 
b= 2 
c= 36 
d= 7

p1=a/(a+b)= 0.9649 
p2=c/(c+d)= 0.8372 

_____________________________

Risk difference
_____________________________

Risk difference = RD = p1-p2 = 0.1277
Standard error = SE.RD = sqrt(p1*(1-p1)/(a+b)+p2*(1-p2)/(c+d)) = 0.1277
Lower 95%-confidence limit: = RD - 1.96 * SE.RD = 0.007464
Upper 95%-confidence limit: = RD + 1.96 * SE.RD = 0.2479

The estimated risk difference is 12.8%  (CI_95%: [0.7;24.8]).

_____________________________

Risk ratio
_____________________________

Risk ratio = RR = p1/p2 = 1.1525
Standard error = SE.RR = sqrt((1-p1)/a+(1-p2)/c)= 1.1525
Lower 95%-confidence limit: = RR * exp(- 1.96 * SE.RR) = 1.0012
Upper 95%-confidence limit: = RR * exp(1.96 * SE.RR) = 1.3268

The estimated risk ratio is 1.153 (CI_95%: [1.001;1.327]).

_____________________________

Odds ratio
_____________________________

Odds ratio = OR = (p1/(1-p1))/(p2/(1-p2)) = 5.3472
Standard error = SE.OR = sqrt((1/a+1/b+1/c+1/d)) = 0.8299
Lower 95%-confidence limit: = OR * exp(- 1.96 * SE.OR) = 1.0512
Upper 95%-confidence limit: = OR * exp(1.96 * SE.OR) = 27.2009

The estimated odds ratio is 5.347 (CI_95%: [1.051;27.201]).

_____________________________

Chi-square test
_____________________________

Warning in chisq.test(table2x2) :
  Chi-squared approximation may be incorrect

	Pearson's Chi-squared test with Yates' continuity correction

data:  table2x2
X-squared = 3.4458, df = 1, p-value = 0.06341


_____________________________

Fisher's exact test
_____________________________


	Fisher's Exact Test for Count Data

data:  table2x2
p-value = 0.03641
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  0.9318097 54.6441933
sample estimates:
odds ratio 
  5.260574 

> table2x2(matrix(c(71,18,38,8),ncol=2),stats="table")
_____________________________

2x2 contingency table
_____________________________

                  response: no     response: yes     Sum
exposure: no                71                38     109
exposure: yes               18                 8      26
--                          --                --      --
Sum                         89                46     135

_____________________________

Statistics
_____________________________


a= 71 
b= 38 
c= 18 
d= 8

p1=a/(a+b)= 0.6514 
p2=c/(c+d)= 0.6923 
> table2x2(matrix(c(71,18,38,8),ncol=2),stats=c("rr","fisher"))

_____________________________

Risk ratio
_____________________________

Risk ratio = RR = p1/p2 = 0.9409
Standard error = SE.RR = sqrt((1-p1)/a+(1-p2)/c)= 0.9409
Lower 95%-confidence limit: = RR * exp(- 1.96 * SE.RR) = 0.7035
Upper 95%-confidence limit: = RR * exp(1.96 * SE.RR) = 1.2583

The estimated risk ratio is 0.941 (CI_95%: [0.704;1.258]).

_____________________________

Fisher's exact test
_____________________________


	Fisher's Exact Test for Count Data

data:  table2x2
p-value = 0.8193
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.2851706 2.2411406
sample estimates:
odds ratio 
 0.8315358 

> 
> 
> 
> cleanEx()
> nameEx("trace")
> ### * trace
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: trace
> ### Title: trace data
> ### Aliases: trace
> ### Keywords: datasets
> 
> ### ** Examples
> 
> 
> data(trace)
> Units(trace,list("age"="years"))
     Time  smoking    sex age ObsTime dead
1       0    Never Female  40     360    0
2     180    Never Female  40     360    0
3     360    Never Female  40     360    0
4     540    Never Female  40     360    0
5     720    Never Female  40     360    0
6     900    Never Female  40     360    0
7    1080    Never Female  40     360    0
8    1260    Never Female  40     360    0
9    1440    Never Female  40     360    0
10   1620    Never Female  40     245    1
11   1800    Never Female  40     180    0
12   1980    Never Female  40     180    0
13   2160    Never Female  40     180    0
14   2340    Never Female  40     180    0
15   2520    Never Female  40     180    0
16   2700    Never Female  40     180    0
17   2880    Never Female  40     180    0
18   3060    Never Female  40     180    0
19   3240    Never Female  40     180    0
20   3420    Never Female  40     180    0
21   3600    Never Female  40     180    0
22   3780    Never Female  40     180    0
23   3960    Never Female  40     180    0
24   4140    Never Female  40     180    0
25   4320    Never Female  40     180    0
26   4500    Never Female  40     180    0
27   4680    Never Female  40     180    0
28   4860    Never Female  40     180    0
29   5040    Never Female  40     180    0
30   5220    Never Female  40     152    0
31      0  Current Female  40       7    1
32      0 Previous Female  40    2590    3
33    180 Previous Female  40    2520    0
34    360 Previous Female  40    2520    0
35    540 Previous Female  40    2520    0
36    720 Previous Female  40    2369    1
37    900 Previous Female  40    2340    0
38   1080 Previous Female  40    2340    0
39   1260 Previous Female  40    2340    0
40   1440 Previous Female  40    2340    0
41   1620 Previous Female  40    2340    0
42   1800 Previous Female  40    2340    0
43   1980 Previous Female  40    2340    0
44   2160 Previous Female  40    2340    0
45   2340 Previous Female  40    2340    0
46   2520 Previous Female  40    2340    0
47   2700 Previous Female  40    2340    0
48   2880 Previous Female  40    2340    0
49   3060 Previous Female  40    2340    0
50   3240 Previous Female  40    2326    1
51   3420 Previous Female  40    2160    0
52   3600 Previous Female  40    2125    1
53   3780 Previous Female  40    1980    0
54   3960 Previous Female  40    1930    1
55   4140 Previous Female  40    1800    0
56   4320 Previous Female  40    1800    0
57   4500 Previous Female  40    1800    0
58   4680 Previous Female  40    1800    0
59   4860 Previous Female  40    1800    0
60   5040 Previous Female  40    1676    0
61   5220 Previous Female  40    1620    0
62   5400 Previous Female  40    1245    0
63   5580 Previous Female  40     316    0
64      0    Never   Male  40    2700    0
65    180    Never   Male  40    2700    0
66    360    Never   Male  40    2700    0
67    540    Never   Male  40    2586    1
68    720    Never   Male  40    2520    0
69    900    Never   Male  40    2520    0
70   1080    Never   Male  40    2520    0
71   1260    Never   Male  40    2520    0
72   1440    Never   Male  40    2494    1
73   1620    Never   Male  40    2340    0
74   1800    Never   Male  40    2340    0
75   1980    Never   Male  40    2340    0
76   2160    Never   Male  40    2246    0
77   2340    Never   Male  40    2160    0
78   2520    Never   Male  40    2160    0
79   2700    Never   Male  40    2160    0
80   2880    Never   Male  40    2160    0
81   3060    Never   Male  40    2160    0
82   3240    Never   Male  40    2160    0
83   3420    Never   Male  40    2160    0
84   3600    Never   Male  40    2160    0
85   3780    Never   Male  40    2160    0
86   3960    Never   Male  40    2160    0
87   4140    Never   Male  40    2160    0
88   4320    Never   Male  40    1994    1
89   4500    Never   Male  40    1980    0
90   4680    Never   Male  40    1980    0
91   4860    Never   Male  40    1980    0
92   5040    Never   Male  40    1862    0
93   5220    Never   Male  40    1311    0
94   5400    Never   Male  40     755    0
95   5580    Never   Male  40     237    0
96      0  Current   Male  40    1800    0
97    180  Current   Male  40    1738    1
98    360  Current   Male  40    1620    0
99    540  Current   Male  40    1620    0
100   720  Current   Male  40    1620    0
101   900  Current   Male  40    1620    0
102  1080  Current   Male  40    1620    0
103  1260  Current   Male  40    1620    0
104  1440  Current   Male  40    1620    0
105  1620  Current   Male  40    1620    0
106  1800  Current   Male  40    1620    0
107  1980  Current   Male  40    1620    0
108  2160  Current   Male  40    1620    0
109  2340  Current   Male  40    1620    0
110  2520  Current   Male  40    1620    0
111  2700  Current   Male  40    1620    0
112  2880  Current   Male  40    1620    0
113  3060  Current   Male  40    1620    0
114  3240  Current   Male  40    1620    0
115  3420  Current   Male  40    1620    0
116  3600  Current   Male  40    1620    0
117  3780  Current   Male  40    1496    1
118  3960  Current   Male  40    1437    1
119  4140  Current   Male  40    1260    0
120  4320  Current   Male  40    1260    0
121  4500  Current   Male  40    1260    0
122  4680  Current   Male  40    1260    0
123  4860  Current   Male  40    1213    1
124  5040  Current   Male  40    1012    0
125  5220  Current   Male  40     705    0
126  5400  Current   Male  40     430    0
127  5580  Current   Male  40      46    0
128     0 Previous   Male  40   16761    3
129   180 Previous   Male  40   16560    0
130   360 Previous   Male  40   16536    1
131   540 Previous   Male  40   16164    2
132   720 Previous   Male  40   16006    1
133   900 Previous   Male  40   15780    1
134  1080 Previous   Male  40   15570    1
135  1260 Previous   Male  40   15308    1
136  1440 Previous   Male  40   15131    1
137  1620 Previous   Male  40   14910    2
138  1800 Previous   Male  40   14760    0
139  1980 Previous   Male  40   14760    0
140  2160 Previous   Male  40   14760    0
141  2340 Previous   Male  40   14760    0
142  2520 Previous   Male  40   14722    1
143  2700 Previous   Male  40   14466    1
144  2880 Previous   Male  40   14068    3
145  3060 Previous   Male  40   13860    0
146  3240 Previous   Male  40   13526    2
147  3420 Previous   Male  40   13500    0
148  3600 Previous   Male  40   13488    1
149  3780 Previous   Male  40   13109    2
150  3960 Previous   Male  40   12960    0
151  4140 Previous   Male  40   12960    0
152  4320 Previous   Male  40   12960    0
153  4500 Previous   Male  40   12960    0
154  4680 Previous   Male  40   12960    0
155  4860 Previous   Male  40   12750    2
156  5040 Previous   Male  40   10864    1
157  5220 Previous   Male  40    7570    0
158  5400 Previous   Male  40    5237    1
159  5580 Previous   Male  40    2408    0
160  5760 Previous   Male  40     372    0
161     0    Never Female  45     910    1
162   180    Never Female  45     900    0
163   360    Never Female  45     900    0
164   540    Never Female  45     900    0
165   720    Never Female  45     900    0
166   900    Never Female  45     900    0
167  1080    Never Female  45     900    0
168  1260    Never Female  45     900    0
169  1440    Never Female  45     872    1
170  1620    Never Female  45     720    0
171  1800    Never Female  45     720    0
172  1980    Never Female  45     720    0
173  2160    Never Female  45     720    0
174  2340    Never Female  45     720    0
175  2520    Never Female  45     720    0
176  2700    Never Female  45     720    0
177  2880    Never Female  45     720    0
178  3060    Never Female  45     720    0
179  3240    Never Female  45     720    0
180  3420    Never Female  45     720    0
181  3600    Never Female  45     720    0
182  3780    Never Female  45     720    0
183  3960    Never Female  45     720    0
184  4140    Never Female  45     720    0
185  4320    Never Female  45     720    0
186  4500    Never Female  45     720    0
187  4680    Never Female  45     720    0
188  4860    Never Female  45     720    0
189  5040    Never Female  45     720    0
190  5220    Never Female  45     552    0
191  5400    Never Female  45     337    0
192  5580    Never Female  45      28    0
193     0  Current Female  45     360    0
194   180  Current Female  45     360    0
195   360  Current Female  45     360    0
196   540  Current Female  45     360    0
197   720  Current Female  45     360    0
198   900  Current Female  45     360    0
199  1080  Current Female  45     189    2
200     0 Previous Female  45    5400    0
201   180 Previous Female  45    5400    0
202   360 Previous Female  45    5400    0
203   540 Previous Female  45    5400    0
204   720 Previous Female  45    5400    0
205   900 Previous Female  45    5384    1
206  1080 Previous Female  45    5220    0
207  1260 Previous Female  45    5220    0
208  1440 Previous Female  45    5072    1
209  1620 Previous Female  45    4954    1
210  1800 Previous Female  45    4788    1
211  1980 Previous Female  45    4680    0
212  2160 Previous Female  45    4680    0
213  2340 Previous Female  45    4680    0
214  2520 Previous Female  45    4589    1
215  2700 Previous Female  45    4500    0
216  2880 Previous Female  45    4500    0
217  3060 Previous Female  45    4337    2
218  3240 Previous Female  45    4140    0
219  3420 Previous Female  45    4140    0
220  3600 Previous Female  45    4121    1
221  3780 Previous Female  45    3960    0
222  3960 Previous Female  45    3960    0
223  4140 Previous Female  45    3960    0
224  4320 Previous Female  45    3960    0
225  4500 Previous Female  45    3960    0
226  4680 Previous Female  45    3960    0
227  4860 Previous Female  45    3960    0
228  5040 Previous Female  45    3148    0
229  5220 Previous Female  45    2220    0
230  5400 Previous Female  45    1440    0
231  5580 Previous Female  45     311    0
232     0    Never   Male  45    3767    1
233   180    Never   Male  45    3600    0
234   360    Never   Male  45    3444    1
235   540    Never   Male  45    3420    0
236   720    Never   Male  45    3420    0
237   900    Never   Male  45    3373    1
238  1080    Never   Male  45    3060    0
239  1260    Never   Male  45    3060    0
240  1440    Never   Male  45    3060    0
241  1620    Never   Male  45    3060    0
242  1800    Never   Male  45    3060    0
243  1980    Never   Male  45    3060    0
244  2160    Never   Male  45    3060    0
245  2340    Never   Male  45    3060    0
246  2520    Never   Male  45    2972    1
247  2700    Never   Male  45    2880    0
248  2880    Never   Male  45    2769    1
249  3060    Never   Male  45    2700    0
250  3240    Never   Male  45    2700    0
251  3420    Never   Male  45    2700    0
252  3600    Never   Male  45    2700    0
253  3780    Never   Male  45    2700    0
254  3960    Never   Male  45    2700    0
255  4140    Never   Male  45    2700    0
256  4320    Never   Male  45    2700    0
257  4500    Never   Male  45    2700    0
258  4680    Never   Male  45    2700    0
259  4860    Never   Male  45    2700    0
260  5040    Never   Male  45    2674    0
261  5220    Never   Male  45    2428    0
262  5400    Never   Male  45    1748    0
263  5580    Never   Male  45     749    0
264  5760    Never   Male  45      30    0
265     0  Current   Male  45    3600    0
266   180  Current   Male  45    3600    0
267   360  Current   Male  45    3600    0
268   540  Current   Male  45    3600    0
269   720  Current   Male  45    3600    0
270   900  Current   Male  45    3465    1
271  1080  Current   Male  45    3242    1
272  1260  Current   Male  45    3101    1
273  1440  Current   Male  45    3060    0
274  1620  Current   Male  45    3060    0
275  1800  Current   Male  45    3060    0
276  1980  Current   Male  45    3060    0
277  2160  Current   Male  45    3060    0
278  2340  Current   Male  45    3060    0
279  2520  Current   Male  45    3060    0
280  2700  Current   Male  45    3060    0
281  2880  Current   Male  45    3060    0
282  3060  Current   Male  45    3060    0
283  3240  Current   Male  45    3060    0
284  3420  Current   Male  45    3007    1
285  3600  Current   Male  45    2738    1
286  3780  Current   Male  45    2687    1
287  3960  Current   Male  45    2520    0
288  4140  Current   Male  45    2520    0
289  4320  Current   Male  45    2491    1
290  4500  Current   Male  45    2340    0
291  4680  Current   Male  45    2340    0
292  4860  Current   Male  45    2340    0
293  5040  Current   Male  45    2113    0
294  5220  Current   Male  45    1460    0
295  5400  Current   Male  45    1108    0
296  5580  Current   Male  45     281    0
297  5760  Current   Male  45      38    0
298     0 Previous   Male  45   27641    9
299   180 Previous   Male  45   27066    1
300   360 Previous   Male  45   26864    2
301   540 Previous   Male  45   26359    3
302   720 Previous   Male  45   26083    1
303   900 Previous   Male  45   25811    1
304  1080 Previous   Male  45   25740    0
305  1260 Previous   Male  45   25360    3
306  1440 Previous   Male  45   25036    2
307  1620 Previous   Male  45   24840    0
308  1800 Previous   Male  45   24837    1
309  1980 Previous   Male  45   24357    2
310  2160 Previous   Male  45   24290    1
311  2340 Previous   Male  45   24011    2
312  2520 Previous   Male  45   23592    1
313  2700 Previous   Male  45   23400    0
314  2880 Previous   Male  45   23334    1
315  3060 Previous   Male  45   23220    0
316  3240 Previous   Male  45   23062    2
317  3420 Previous   Male  45   22860    0
318  3600 Previous   Male  45   22493    4
319  3780 Previous   Male  45   22140    0
320  3960 Previous   Male  45   22058    2
321  4140 Previous   Male  45   21618    3
322  4320 Previous   Male  45   21180    2
323  4500 Previous   Male  45   20628    3
324  4680 Previous   Male  45   20237    1
325  4860 Previous   Male  45   20037    1
326  5040 Previous   Male  45   17319    2
327  5220 Previous   Male  45   12459    1
328  5400 Previous   Male  45    6812    1
329  5580 Previous   Male  45    1969    0
330  5760 Previous   Male  45      24    0
331     0    Never Female  50     540    0
332   180    Never Female  50     540    0
333   360    Never Female  50     540    0
334   540    Never Female  50     540    0
335   720    Never Female  50     540    0
336   900    Never Female  50     540    0
337  1080    Never Female  50     540    0
338  1260    Never Female  50     540    0
339  1440    Never Female  50     540    0
340  1620    Never Female  50     540    0
341  1800    Never Female  50     540    0
342  1980    Never Female  50     540    0
343  2160    Never Female  50     540    0
344  2340    Never Female  50     540    0
345  2520    Never Female  50     540    0
346  2700    Never Female  50     540    0
347  2880    Never Female  50     540    0
348  3060    Never Female  50     540    0
349  3240    Never Female  50     540    0
350  3420    Never Female  50     540    0
351  3600    Never Female  50     540    0
352  3780    Never Female  50     540    0
353  3960    Never Female  50     540    0
354  4140    Never Female  50     540    0
355  4320    Never Female  50     540    0
356  4500    Never Female  50     540    0
357  4680    Never Female  50     540    0
358  4860    Never Female  50     540    0
359  5040    Never Female  50     540    0
360  5220    Never Female  50     540    0
361  5400    Never Female  50     327    0
362  5580    Never Female  50     180    0
363  5760    Never Female  50      62    0
364     0  Current Female  50    1260    0
365   180  Current Female  50    1260    0
366   360  Current Female  50    1260    0
367   540  Current Female  50    1260    0
368   720  Current Female  50    1260    0
369   900  Current Female  50    1260    0
370  1080  Current Female  50    1260    0
371  1260  Current Female  50    1260    0
372  1440  Current Female  50    1260    0
373  1620  Current Female  50    1260    0
374  1800  Current Female  50    1260    0
375  1980  Current Female  50    1260    0
376  2160  Current Female  50    1260    0
377  2340  Current Female  50    1260    0
378  2520  Current Female  50    1260    0
379  2700  Current Female  50    1260    0
380  2880  Current Female  50    1260    0
381  3060  Current Female  50    1260    0
382  3240  Current Female  50    1260    0
383  3420  Current Female  50    1260    0
384  3600  Current Female  50    1260    0
385  3780  Current Female  50    1260    0
386  3960  Current Female  50    1260    0
387  4140  Current Female  50    1255    1
388  4320  Current Female  50    1080    0
389  4500  Current Female  50    1080    0
390  4680  Current Female  50    1080    0
391  4860  Current Female  50    1024    0
392  5040  Current Female  50     900    0
393  5220  Current Female  50     715    0
394  5400  Current Female  50     363    0
395  5580  Current Female  50       9    0
396     0 Previous Female  50    9210    5
397   180 Previous Female  50    9180    0
398   360 Previous Female  50    9121    1
399   540 Previous Female  50    9000    0
400   720 Previous Female  50    8979    1
401   900 Previous Female  50    8642    1
402  1080 Previous Female  50    8604    1
403  1260 Previous Female  50    8322    1
404  1440 Previous Female  50    8280    0
405  1620 Previous Female  50    8280    0
406  1800 Previous Female  50    8280    0
407  1980 Previous Female  50    8280    0
408  2160 Previous Female  50    8269    1
409  2340 Previous Female  50    8100    0
410  2520 Previous Female  50    8100    0
411  2700 Previous Female  50    8100    0
412  2880 Previous Female  50    7941    1
413  3060 Previous Female  50    7868    2
414  3240 Previous Female  50    7560    0
415  3420 Previous Female  50    7421    1
416  3600 Previous Female  50    7380    0
417  3780 Previous Female  50    7380    0
418  3960 Previous Female  50    7380    0
419  4140 Previous Female  50    7380    0
420  4320 Previous Female  50    7220    1
421  4500 Previous Female  50    7200    0
422  4680 Previous Female  50    7033    1
423  4860 Previous Female  50    7020    0
424  5040 Previous Female  50    6146    1
425  5220 Previous Female  50    4428    0
426  5400 Previous Female  50    2707    0
427  5580 Previous Female  50    1328    0
428  5760 Previous Female  50     262    0
429     0    Never   Male  50    6736    1
430   180    Never   Male  50    6660    0
431   360    Never   Male  50    6660    0
432   540    Never   Male  50    6660    0
433   720    Never   Male  50    6549    1
434   900    Never   Male  50    6480    0
435  1080    Never   Male  50    6480    0
436  1260    Never   Male  50    6480    0
437  1440    Never   Male  50    6480    0
438  1620    Never   Male  50    6362    1
439  1800    Never   Male  50    6300    0
440  1980    Never   Male  50    6300    0
441  2160    Never   Male  50    6300    0
442  2340    Never   Male  50    6300    0
443  2520    Never   Male  50    6166    1
444  2700    Never   Male  50    6120    0
445  2880    Never   Male  50    6120    0
446  3060    Never   Male  50    6120    0
447  3240    Never   Male  50    6114    1
448  3420    Never   Male  50    5940    0
449  3600    Never   Male  50    5940    0
450  3780    Never   Male  50    5940    0
451  3960    Never   Male  50    5894    1
452  4140    Never   Male  50    5760    0
453  4320    Never   Male  50    5760    0
454  4500    Never   Male  50    5760    0
455  4680    Never   Male  50    5760    0
456  4860    Never   Male  50    5760    0
457  5040    Never   Male  50    5107    0
458  5220    Never   Male  50    3422    1
459  5400    Never   Male  50    2113    0
460  5580    Never   Male  50    1449    0
461  5760    Never   Male  50     113    0
462     0  Current   Male  50    7413    2
463   180  Current   Male  50    7380    0
464   360  Current   Male  50    7380    0
465   540  Current   Male  50    7380    0
466   720  Current   Male  50    7338    1
467   900  Current   Male  50    7200    0
468  1080  Current   Male  50    7179    1
469  1260  Current   Male  50    6861    1
470  1440  Current   Male  50    6631    3
471  1620  Current   Male  50    6146    1
472  1800  Current   Male  50    5935    2
473  1980  Current   Male  50    5760    0
474  2160  Current   Male  50    5672    1
475  2340  Current   Male  50    5580    0
476  2520  Current   Male  50    5580    0
477  2700  Current   Male  50    5580    0
478  2880  Current   Male  50    5561    1
479  3060  Current   Male  50    5400    0
480  3240  Current   Male  50    5303    1
481  3420  Current   Male  50    5220    0
482  3600  Current   Male  50    5220    0
483  3780  Current   Male  50    5220    0
484  3960  Current   Male  50    5220    0
485  4140  Current   Male  50    5220    0
486  4320  Current   Male  50    5047    1
487  4500  Current   Male  50    4901    1
488  4680  Current   Male  50    4860    0
489  4860  Current   Male  50    4860    0
490  5040  Current   Male  50    4758    0
491  5220  Current   Male  50    3041    1
492  5400  Current   Male  50    1539    0
493  5580  Current   Male  50     489    0
494     0 Previous   Male  50   42632   13
495   180 Previous   Male  50   41833    5
496   360 Previous   Male  50   41177    3
497   540 Previous   Male  50   40766    1
498   720 Previous   Male  50   40517    2
499   900 Previous   Male  50   40156    1
500  1080 Previous   Male  50   40025    2
501  1260 Previous   Male  50   39361    6
502  1440 Previous   Male  50   38608    1
503  1620 Previous   Male  50   38510    1
504  1800 Previous   Male  50   38151    4
505  1980 Previous   Male  50   37478    1
506  2160 Previous   Male  50   37411    1
507  2340 Previous   Male  50   36992    2
508  2520 Previous   Male  50   36854    1
509  2700 Previous   Male  50   36720    0
510  2880 Previous   Male  50   36097    7
511  3060 Previous   Male  50   35202    2
512  3240 Previous   Male  50   34826    3
513  3420 Previous   Male  50   34309    3
514  3600 Previous   Male  50   33234    6
515  3780 Previous   Male  50   32607    4
516  3960 Previous   Male  50   31891    1
517  4140 Previous   Male  50   31553    3
518  4320 Previous   Male  50   30906    3
519  4500 Previous   Male  50   30384    3
520  4680 Previous   Male  50   30022    2
521  4860 Previous   Male  50   29490    3
522  5040 Previous   Male  50   25911    4
523  5220 Previous   Male  50   18502    0
524  5400 Previous   Male  50   11015    2
525  5580 Previous   Male  50    4338    0
526  5760 Previous   Male  50     339    0
527     0    Never Female  55    3581    3
528   180    Never Female  55    3420    0
529   360    Never Female  55    3420    0
530   540    Never Female  55    3181    3
531   720    Never Female  55    2880    0
532   900    Never Female  55    2792    1
533  1080    Never Female  55    2700    0
534  1260    Never Female  55    2700    0
535  1440    Never Female  55    2700    0
536  1620    Never Female  55    2662    1
537  1800    Never Female  55    2520    0
538  1980    Never Female  55    2520    0
539  2160    Never Female  55    2520    0
540  2340    Never Female  55    2520    0
541  2520    Never Female  55    2520    0
542  2700    Never Female  55    2415    1
543  2880    Never Female  55    2185    1
544  3060    Never Female  55    2160    0
545  3240    Never Female  55    2160    0
546  3420    Never Female  55    2160    0
547  3600    Never Female  55    2160    0
548  3780    Never Female  55    2160    0
549  3960    Never Female  55    2127    1
550  4140    Never Female  55    1828    1
551  4320    Never Female  55    1800    0
552  4500    Never Female  55    1800    0
553  4680    Never Female  55    1800    0
554  4860    Never Female  55    1800    0
555  5040    Never Female  55    1749    0
556  5220    Never Female  55    1079    1
557  5400    Never Female  55     554    0
558  5580    Never Female  55     339    0
559     0  Current Female  55    1693    1
560   180  Current Female  55    1620    0
561   360  Current Female  55    1580    1
562   540  Current Female  55    1440    0
563   720  Current Female  55    1440    0
564   900  Current Female  55    1440    0
565  1080  Current Female  55    1440    0
566  1260  Current Female  55    1440    0
567  1440  Current Female  55    1323    1
568  1620  Current Female  55    1260    0
569  1800  Current Female  55    1260    0
570  1980  Current Female  55    1260    0
571  2160  Current Female  55    1260    0
572  2340  Current Female  55    1260    0
573  2520  Current Female  55    1260    0
574  2700  Current Female  55    1097    1
575  2880  Current Female  55    1080    0
576  3060  Current Female  55    1080    0
577  3240  Current Female  55    1080    0
578  3420  Current Female  55    1080    0
579  3600  Current Female  55    1080    0
580  3780  Current Female  55    1080    0
581  3960  Current Female  55    1080    0
582  4140  Current Female  55    1080    0
583  4320  Current Female  55    1080    0
584  4500  Current Female  55     923    1
585  4680  Current Female  55     900    0
586  4860  Current Female  55     900    0
587  5040  Current Female  55     900    1
588  5220  Current Female  55     570    0
589  5400  Current Female  55     401    0
590  5580  Current Female  55     184    0
591  5760  Current Female  55      85    0
592     0 Previous Female  55   15198    5
593   180 Previous Female  55   15095    1
594   360 Previous Female  55   14871    1
595   540 Previous Female  55   14607    1
596   720 Previous Female  55   14580    0
597   900 Previous Female  55   14357    2
598  1080 Previous Female  55   14220    0
599  1260 Previous Female  55   14220    0
600  1440 Previous Female  55   14146    1
601  1620 Previous Female  55   13973    1
602  1800 Previous Female  55   13821    1
603  1980 Previous Female  55   13680    0
604  2160 Previous Female  55   13680    0
605  2340 Previous Female  55   13520    2
606  2520 Previous Female  55   13278    2
607  2700 Previous Female  55   12713    3
608  2880 Previous Female  55   12272    2
609  3060 Previous Female  55   11877    2
610  3240 Previous Female  55   11633    1
611  3420 Previous Female  55   11412    1
612  3600 Previous Female  55   11334    1
613  3780 Previous Female  55   11160    0
614  3960 Previous Female  55   11007    1
615  4140 Previous Female  55   10980    0
616  4320 Previous Female  55   10582    3
617  4500 Previous Female  55   10151    3
618  4680 Previous Female  55    9777    2
619  4860 Previous Female  55    9540    0
620  5040 Previous Female  55    8212    4
621  5220 Previous Female  55    5839    0
622  5400 Previous Female  55    3436    0
623  5580 Previous Female  55    1151    0
624  5760 Previous Female  55      74    0
625     0    Never   Male  55   11338    2
626   180    Never   Male  55   10983    2
627   360    Never   Male  55   10800    0
628   540    Never   Male  55   10776    1
629   720    Never   Male  55   10369    3
630   900    Never   Male  55   10080    0
631  1080    Never   Male  55    9897    2
632  1260    Never   Male  55    9523    2
633  1440    Never   Male  55    9360    0
634  1620    Never   Male  55    9360    0
635  1800    Never   Male  55    9360    0
636  1980    Never   Male  55    9298    1
637  2160    Never   Male  55    9051    1
638  2340    Never   Male  55    8947    1
639  2520    Never   Male  55    8820    0
640  2700    Never   Male  55    8652    1
641  2880    Never   Male  55    8640    0
642  3060    Never   Male  55    8640    0
643  3240    Never   Male  55    8560    1
644  3420    Never   Male  55    8341    2
645  3600    Never   Male  55    8100    0
646  3780    Never   Male  55    7882    2
647  3960    Never   Male  55    7740    0
648  4140    Never   Male  55    7738    1
649  4320    Never   Male  55    7560    0
650  4500    Never   Male  55    7560    0
651  4680    Never   Male  55    7387    1
652  4860    Never   Male  55    7380    0
653  5040    Never   Male  55    6683    2
654  5220    Never   Male  55    3966    1
655  5400    Never   Male  55    2424    0
656  5580    Never   Male  55     971    0
657  5760    Never   Male  55     243    0
658     0  Current   Male  55   11662    4
659   180  Current   Male  55   11344    1
660   360  Current   Male  55   11179    1
661   540  Current   Male  55   11160    0
662   720  Current   Male  55   11160    0
663   900  Current   Male  55   11127    2
664  1080  Current   Male  55   10679    1
665  1260  Current   Male  55   10352    1
666  1440  Current   Male  55   10241    2
667  1620  Current   Male  55    9900    0
668  1800  Current   Male  55    9780    2
669  1980  Current   Male  55    9540    0
670  2160  Current   Male  55    9540    0
671  2340  Current   Male  55    9475    1
672  2520  Current   Male  55    9360    0
673  2700  Current   Male  55    9238    2
674  2880  Current   Male  55    9000    0
675  3060  Current   Male  55    9000    0
676  3240  Current   Male  55    9000    0
677  3420  Current   Male  55    8843    2
678  3600  Current   Male  55    8443    2
679  3780  Current   Male  55    8280    0
680  3960  Current   Male  55    8256    1
681  4140  Current   Male  55    8100    0
682  4320  Current   Male  55    8067    1
683  4500  Current   Male  55    7920    0
684  4680  Current   Male  55    7920    0
685  4860  Current   Male  55    7920    0
686  5040  Current   Male  55    6686    0
687  5220  Current   Male  55    3904    0
688  5400  Current   Male  55    2373    0
689  5580  Current   Male  55     909    0
690  5760  Current   Male  55      41    0
691     0 Previous   Male  55   53772   13
692   180 Previous   Male  55   52815    5
693   360 Previous   Male  55   51978    6
694   540 Previous   Male  55   50813    7
695   720 Previous   Male  55   49681    4
696   900 Previous   Male  55   48581    7
697  1080 Previous   Male  55   47493    5
698  1260 Previous   Male  55   46324    7
699  1440 Previous   Male  55   45303    4
700  1620 Previous   Male  55   44451    5
701  1800 Previous   Male  55   43876    4
702  1980 Previous   Male  55   43113    5
703  2160 Previous   Male  55   41299   11
704  2340 Previous   Male  55   40275    2
705  2520 Previous   Male  55   39743    6
706  2700 Previous   Male  55   38665    5
707  2880 Previous   Male  55   37911    2
708  3060 Previous   Male  55   37022    6
709  3240 Previous   Male  55   36681    1
710  3420 Previous   Male  55   36141    6
711  3600 Previous   Male  55   34952    4
712  3780 Previous   Male  55   34385    5
713  3960 Previous   Male  55   33572    3
714  4140 Previous   Male  55   33085    3
715  4320 Previous   Male  55   32298    6
716  4500 Previous   Male  55   31459    3
717  4680 Previous   Male  55   30740    4
718  4860 Previous   Male  55   29583    8
719  5040 Previous   Male  55   25986    5
720  5220 Previous   Male  55   18272    2
721  5400 Previous   Male  55   10304    3
722  5580 Previous   Male  55    3483    2
723  5760 Previous   Male  55     289    0
724     0    Never Female  60    4363   10
725   180    Never Female  60    3987    2
726   360    Never Female  60    3780    0
727   540    Never Female  60    3588    2
728   720    Never Female  60    3420    0
729   900    Never Female  60    3420    0
730  1080    Never Female  60    3420    0
731  1260    Never Female  60    3420    0
732  1440    Never Female  60    3420    0
733  1620    Never Female  60    3420    0
734  1800    Never Female  60    3420    0
735  1980    Never Female  60    3420    0
736  2160    Never Female  60    3420    0
737  2340    Never Female  60    3420    0
738  2520    Never Female  60    3420    0
739  2700    Never Female  60    3420    0
740  2880    Never Female  60    3218    2
741  3060    Never Female  60    3051    1
742  3240    Never Female  60    2880    0
743  3420    Never Female  60    2880    0
744  3600    Never Female  60    2880    0
745  3780    Never Female  60    2718    1
746  3960    Never Female  60    2700    0
747  4140    Never Female  60    2700    0
748  4320    Never Female  60    2700    0
749  4500    Never Female  60    2700    0
750  4680    Never Female  60    2601    2
751  4860    Never Female  60    2166    1
752  5040    Never Female  60    2094    0
753  5220    Never Female  60    1784    0
754  5400    Never Female  60     999    0
755  5580    Never Female  60     209    1
756     0  Current Female  60    3960    3
757   180  Current Female  60    3780    0
758   360  Current Female  60    3738    1
759   540  Current Female  60    3600    0
760   720  Current Female  60    3505    1
761   900  Current Female  60    3401    1
762  1080  Current Female  60    3240    0
763  1260  Current Female  60    3069    1
764  1440  Current Female  60    3060    0
765  1620  Current Female  60    2896    2
766  1800  Current Female  60    2700    0
767  1980  Current Female  60    2645    1
768  2160  Current Female  60    2520    0
769  2340  Current Female  60    2418    1
770  2520  Current Female  60    2340    0
771  2700  Current Female  60    2323    1
772  2880  Current Female  60    2049    1
773  3060  Current Female  60    1980    0
774  3240  Current Female  60    1980    0
775  3420  Current Female  60    1980    0
776  3600  Current Female  60    1980    0
777  3780  Current Female  60    1980    0
778  3960  Current Female  60    1916    1
779  4140  Current Female  60    1800    0
780  4320  Current Female  60    1800    0
781  4500  Current Female  60    1800    0
782  4680  Current Female  60    1775    1
783  4860  Current Female  60    1620    0
784  5040  Current Female  60    1538    0
785  5220  Current Female  60    1178    1
786  5400  Current Female  60     995    0
787  5580  Current Female  60     596    0
788  5760  Current Female  60     136    0
789     0 Previous Female  60   21876   16
790   180 Previous Female  60   21042    1
791   360 Previous Female  60   20550    4
792   540 Previous Female  60   19908    3
793   720 Previous Female  60   19476    1
794   900 Previous Female  60   19264    1
795  1080 Previous Female  60   18964    4
796  1260 Previous Female  60   18416    1
797  1440 Previous Female  60   18063    5
798  1620 Previous Female  60   17404    1
799  1800 Previous Female  60   17094    2
800  1980 Previous Female  60   16730    2
801  2160 Previous Female  60   16409    1
802  2340 Previous Female  60   16023    3
803  2520 Previous Female  60   15750    1
804  2700 Previous Female  60   15489    2
805  2880 Previous Female  60   15116    3
806  3060 Previous Female  60   14386    4
807  3240 Previous Female  60   13673    3
808  3420 Previous Female  60   13438    1
809  3600 Previous Female  60   13168    1
810  3780 Previous Female  60   12968    2
811  3960 Previous Female  60   12506    2
812  4140 Previous Female  60   12361    1
813  4320 Previous Female  60   11953    3
814  4500 Previous Female  60   11408    5
815  4680 Previous Female  60   10455    3
816  4860 Previous Female  60    9776    4
817  5040 Previous Female  60    8161    3
818  5220 Previous Female  60    5453    0
819  5400 Previous Female  60    3378    1
820  5580 Previous Female  60    1445    0
821  5760 Previous Female  60     126    0
822     0    Never   Male  60   13393    6
823   180    Never   Male  60   12981    2
824   360    Never   Male  60   12780    0
825   540    Never   Male  60   12608    4
826   720    Never   Male  60   11902    1
827   900    Never   Male  60   11568    2
828  1080    Never   Male  60   11520    0
829  1260    Never   Male  60   11395    2
830  1440    Never   Male  60   10981    2
831  1620    Never   Male  60   10720    1
832  1800    Never   Male  60   10465    1
833  1980    Never   Male  60   10321    1
834  2160    Never   Male  60   10260    0
835  2340    Never   Male  60   10260    0
836  2520    Never   Male  60   10068    3
837  2700    Never   Male  60    9720    0
838  2880    Never   Male  60    9613    1
839  3060    Never   Male  60    9410    1
840  3240    Never   Male  60    9187    2
841  3420    Never   Male  60    8650    2
842  3600    Never   Male  60    8640    0
843  3780    Never   Male  60    8640    0
844  3960    Never   Male  60    8569    2
845  4140    Never   Male  60    8044    2
846  4320    Never   Male  60    7920    0
847  4500    Never   Male  60    7920    0
848  4680    Never   Male  60    7884    1
849  4860    Never   Male  60    7740    0
850  5040    Never   Male  60    7013    0
851  5220    Never   Male  60    4802    1
852  5400    Never   Male  60    2432    2
853  5580    Never   Male  60    1034    0
854  5760    Never   Male  60     145    0
855     0  Current   Male  60   19740   14
856   180  Current   Male  60   18848    1
857   360  Current   Male  60   18643    1
858   540  Current   Male  60   18212    6
859   720  Current   Male  60   17289    1
860   900  Current   Male  60   17280    0
861  1080  Current   Male  60   17280    0
862  1260  Current   Male  60   16784    5
863  1440  Current   Male  60   16311    1
864  1620  Current   Male  60   16022    2
865  1800  Current   Male  60   15721    2
866  1980  Current   Male  60   15378    2
867  2160  Current   Male  60   14793    3
868  2340  Current   Male  60   14370    3
869  2520  Current   Male  60   13842    2
870  2700  Current   Male  60   13527    1
871  2880  Current   Male  60   13306    2
872  3060  Current   Male  60   13064    2
873  3240  Current   Male  60   12725    1
874  3420  Current   Male  60   12189    4
875  3600  Current   Male  60   11713    2
876  3780  Current   Male  60   11059    3
877  3960  Current   Male  60   10980    0
878  4140  Current   Male  60   10813    1
879  4320  Current   Male  60   10557    3
880  4500  Current   Male  60   10144    1
881  4680  Current   Male  60   10080    0
882  4860  Current   Male  60    9948    2
883  5040  Current   Male  60    8748    2
884  5220  Current   Male  60    5090    2
885  5400  Current   Male  60    3395    0
886  5580  Current   Male  60    1531    0
887  5760  Current   Male  60     125    0
888     0 Previous   Male  60   61784   34
889   180 Previous   Male  60   59912    7
890   360 Previous   Male  60   58174    9
891   540 Previous   Male  60   57128    4
892   720 Previous   Male  60   55820   12
893   900 Previous   Male  60   54140    6
894  1080 Previous   Male  60   53195    5
895  1260 Previous   Male  60   52417    6
896  1440 Previous   Male  60   51231    5
897  1620 Previous   Male  60   50207    6
898  1800 Previous   Male  60   49047    7
899  1980 Previous   Male  60   47767   10
900  2160 Previous   Male  60   46011    5
901  2340 Previous   Male  60   44775   10
902  2520 Previous   Male  60   43428    6
903  2700 Previous   Male  60   42267    7
904  2880 Previous   Male  60   40951    7
905  3060 Previous   Male  60   39357    9
906  3240 Previous   Male  60   37704   11
907  3420 Previous   Male  60   36114    5
908  3600 Previous   Male  60   35420    7
909  3780 Previous   Male  60   33482   12
910  3960 Previous   Male  60   31941    5
911  4140 Previous   Male  60   30716    6
912  4320 Previous   Male  60   29785    6
913  4500 Previous   Male  60   28710    6
914  4680 Previous   Male  60   28009    1
915  4860 Previous   Male  60   27238    9
916  5040 Previous   Male  60   23853    3
917  5220 Previous   Male  60   16648    3
918  5400 Previous   Male  60    9016    2
919  5580 Previous   Male  60    3911    1
920  5760 Previous   Male  60     747    0
921     0    Never Female  65   11661    8
922   180    Never Female  65   11193    2
923   360    Never Female  65   10880    2
924   540    Never Female  65   10620    0
925   720    Never Female  65   10620    0
926   900    Never Female  65   10336    3
927  1080    Never Female  65   10080    0
928  1260    Never Female  65   10080    0
929  1440    Never Female  65    9983    1
930  1620    Never Female  65    9448    3
931  1800    Never Female  65    8876    3
932  1980    Never Female  65    8640    0
933  2160    Never Female  65    8640    0
934  2340    Never Female  65    8521    1
935  2520    Never Female  65    8460    0
936  2700    Never Female  65    8249    2
937  2880    Never Female  65    7858    2
938  3060    Never Female  65    7723    1
939  3240    Never Female  65    7510    1
940  3420    Never Female  65    7380    0
941  3600    Never Female  65    7249    1
942  3780    Never Female  65    7081    1
943  3960    Never Female  65    6694    3
944  4140    Never Female  65    6480    0
945  4320    Never Female  65    6440    1
946  4500    Never Female  65    6300    0
947  4680    Never Female  65    6249    1
948  4860    Never Female  65    6038    1
949  5040    Never Female  65    5548    0
950  5220    Never Female  65    3943    2
951  5400    Never Female  65    2626    0
952  5580    Never Female  65    1035    0
953  5760    Never Female  65     198    0
954  5940    Never Female  65      31    0
955     0  Current Female  65    5680    4
956   180  Current Female  65    5364    1
957   360  Current Female  65    4991    2
958   540  Current Female  65    4324    4
959   720  Current Female  65    4112    1
960   900  Current Female  65    3878    2
961  1080  Current Female  65    3600    0
962  1260  Current Female  65    3600    0
963  1440  Current Female  65    3466    1
964  1620  Current Female  65    3060    3
965  1800  Current Female  65    2880    0
966  1980  Current Female  65    2880    0
967  2160  Current Female  65    2862    1
968  2340  Current Female  65    2700    0
969  2520  Current Female  65    2585    1
970  2700  Current Female  65    2520    0
971  2880  Current Female  65    2520    0
972  3060  Current Female  65    2347    1
973  3240  Current Female  65    2340    0
974  3420  Current Female  65    2094    2
975  3600  Current Female  65    1980    0
976  3780  Current Female  65    1980    0
977  3960  Current Female  65    1980    0
978  4140  Current Female  65    1980    0
979  4320  Current Female  65    1903    1
980  4500  Current Female  65    1800    0
981  4680  Current Female  65    1800    0
982  4860  Current Female  65    1696    1
983  5040  Current Female  65    1278    0
984  5220  Current Female  65     808    0
985  5400  Current Female  65     503    0
986  5580  Current Female  65      78    0
987     0 Previous Female  65   25412   19
988   180 Previous Female  65   24858    3
989   360 Previous Female  65   24262    4
990   540 Previous Female  65   23289    6
991   720 Previous Female  65   22511    2
992   900 Previous Female  65   22186    2
993  1080 Previous Female  65   21483    6
994  1260 Previous Female  65   20753    1
995  1440 Previous Female  65   20276    6
996  1620 Previous Female  65   19469    2
997  1800 Previous Female  65   19079    3
998  1980 Previous Female  65   18397    4
999  2160 Previous Female  65   17759    2
1000 2340 Previous Female  65   17476    3
1001 2520 Previous Female  65   16737    4
1002 2700 Previous Female  65   16253    3
1003 2880 Previous Female  65   15252    4
1004 3060 Previous Female  65   14746    3
1005 3240 Previous Female  65   14375    3
1006 3420 Previous Female  65   13730    5
1007 3600 Previous Female  65   13140    0
1008 3780 Previous Female  65   13140    0
1009 3960 Previous Female  65   12740    5
1010 4140 Previous Female  65   12041    4
1011 4320 Previous Female  65   10578    8
1012 4500 Previous Female  65   10000    2
1013 4680 Previous Female  65    9528    2
1014 4860 Previous Female  65    9116    3
1015 5040 Previous Female  65    7938    4
1016 5220 Previous Female  65    5566    2
1017 5400 Previous Female  65    3647    0
1018 5580 Previous Female  65    1352    0
1019 5760 Previous Female  65     174    0
1020    0    Never   Male  65   18157   18
1021  180    Never   Male  65   16918    3
1022  360    Never   Male  65   16414    5
1023  540    Never   Male  65   15553    3
1024  720    Never   Male  65   15159    2
1025  900    Never   Male  65   14673    2
1026 1080    Never   Male  65   14352    3
1027 1260    Never   Male  65   13759    2
1028 1440    Never   Male  65   13079    5
1029 1620    Never   Male  65   12780    0
1030 1800    Never   Male  65   12780    0
1031 1980    Never   Male  65   12780    0
1032 2160    Never   Male  65   12632    2
1033 2340    Never   Male  65   12385    1
1034 2520    Never   Male  65   12150    1
1035 2700    Never   Male  65   11933    1
1036 2880    Never   Male  65   11245    5
1037 3060    Never   Male  65   10531    2
1038 3240    Never   Male  65   10351    1
1039 3420    Never   Male  65   10014    3
1040 3600    Never   Male  65    9644    1
1041 3780    Never   Male  65    9448    2
1042 3960    Never   Male  65    9047    2
1043 4140    Never   Male  65    8246    4
1044 4320    Never   Male  65    7978    3
1045 4500    Never   Male  65    7519    1
1046 4680    Never   Male  65    7380    0
1047 4860    Never   Male  65    7184    2
1048 5040    Never   Male  65    6174    2
1049 5220    Never   Male  65    4148    0
1050 5400    Never   Male  65    1898    0
1051 5580    Never   Male  65     550    0
1052    0  Current   Male  65   28568   22
1053  180  Current   Male  65   26953    9
1054  360  Current   Male  65   25826    2
1055  540  Current   Male  65   25396    2
1056  720  Current   Male  65   24541    9
1057  900  Current   Male  65   23279    3
1058 1080  Current   Male  65   22702    4
1059 1260  Current   Male  65   22084    4
1060 1440  Current   Male  65   21352    3
1061 1620  Current   Male  65   20425    5
1062 1800  Current   Male  65   19707    4
1063 1980  Current   Male  65   19260    0
1064 2160  Current   Male  65   19260    0
1065 2340  Current   Male  65   18915    5
1066 2520  Current   Male  65   17927    3
1067 2700  Current   Male  65   17817    1
1068 2880  Current   Male  65   17357    2
1069 3060  Current   Male  65   16954    3
1070 3240  Current   Male  65   16668    2
1071 3420  Current   Male  65   16075    2
1072 3600  Current   Male  65   15707    4
1073 3780  Current   Male  65   15099    2
1074 3960  Current   Male  65   14907    1
1075 4140  Current   Male  65   14371    4
1076 4320  Current   Male  65   13823    2
1077 4500  Current   Male  65   13586    1
1078 4680  Current   Male  65   13167    3
1079 4860  Current   Male  65   12591    3
1080 5040  Current   Male  65   10683    3
1081 5220  Current   Male  65    7298    2
1082 5400  Current   Male  65    4523    0
1083 5580  Current   Male  65    1941    1
1084 5760  Current   Male  65      89    1
1085    0 Previous   Male  65   59232   48
1086  180 Previous   Male  65   56223   14
1087  360 Previous   Male  65   54284    7
1088  540 Previous   Male  65   52410   10
1089  720 Previous   Male  65   51093    8
1090  900 Previous   Male  65   49977    4
1091 1080 Previous   Male  65   48286   12
1092 1260 Previous   Male  65   46949    4
1093 1440 Previous   Male  65   45954    6
1094 1620 Previous   Male  65   44999    5
1095 1800 Previous   Male  65   43996    7
1096 1980 Previous   Male  65   41901   16
1097 2160 Previous   Male  65   39662   11
1098 2340 Previous   Male  65   38256    7
1099 2520 Previous   Male  65   36593    8
1100 2700 Previous   Male  65   34971    9
1101 2880 Previous   Male  65   32853   12
1102 3060 Previous   Male  65   31701    5
1103 3240 Previous   Male  65   30453    6
1104 3420 Previous   Male  65   29451    5
1105 3600 Previous   Male  65   28138   12
1106 3780 Previous   Male  65   26424    8
1107 3960 Previous   Male  65   24574    9
1108 4140 Previous   Male  65   23695    5
1109 4320 Previous   Male  65   22543    4
1110 4500 Previous   Male  65   21998    5
1111 4680 Previous   Male  65   21139    4
1112 4860 Previous   Male  65   20073    7
1113 5040 Previous   Male  65   18659    2
1114 5220 Previous   Male  65   12335    5
1115 5400 Previous   Male  65    6488    4
1116 5580 Previous   Male  65    2214    0
1117 5760 Previous   Male  65     298    0
1118    0    Never Female  70   20464   27
1119  180    Never Female  70   19154    3
1120  360    Never Female  70   18582    4
1121  540    Never Female  70   18004    4
1122  720    Never Female  70   17042    5
1123  900    Never Female  70   16517    1
1124 1080    Never Female  70   16131    3
1125 1260    Never Female  70   15378    5
1126 1440    Never Female  70   14293    7
1127 1620    Never Female  70   13365    3
1128 1800    Never Female  70   12883    4
1129 1980    Never Female  70   12028    3
1130 2160    Never Female  70   11305    8
1131 2340    Never Female  70   10324    1
1132 2520    Never Female  70   10128    1
1133 2700    Never Female  70    9967    1
1134 2880    Never Female  70    9777    1
1135 3060    Never Female  70    9554    1
1136 3240    Never Female  70    9449    1
1137 3420    Never Female  70    9092    3
1138 3600    Never Female  70    8820    0
1139 3780    Never Female  70    8774    1
1140 3960    Never Female  70    8217    3
1141 4140    Never Female  70    8040    1
1142 4320    Never Female  70    7822    1
1143 4500    Never Female  70    7740    0
1144 4680    Never Female  70    7571    3
1145 4860    Never Female  70    7153    1
1146 5040    Never Female  70    5829    3
1147 5220    Never Female  70    3561    2
1148 5400    Never Female  70    2302    0
1149 5580    Never Female  70     760    0
1150 5760    Never Female  70      95    0
1151    0  Current Female  70   10447   17
1152  180  Current Female  70    9449    5
1153  360  Current Female  70    8790    2
1154  540  Current Female  70    8572    2
1155  720  Current Female  70    7970    2
1156  900  Current Female  70    7742    2
1157 1080  Current Female  70    7420    2
1158 1260  Current Female  70    7190    1
1159 1440  Current Female  70    7020    0
1160 1620  Current Female  70    6864    2
1161 1800  Current Female  70    6660    0
1162 1980  Current Female  70    6660    0
1163 2160  Current Female  70    6350    2
1164 2340  Current Female  70    6235    1
1165 2520  Current Female  70    5946    3
1166 2700  Current Female  70    5437    1
1167 2880  Current Female  70    5278    2
1168 3060  Current Female  70    5040    0
1169 3240  Current Female  70    5040    0
1170 3420  Current Female  70    4930    1
1171 3600  Current Female  70    4500    3
1172 3780  Current Female  70    4291    1
1173 3960  Current Female  70    4140    0
1174 4140  Current Female  70    4030    2
1175 4320  Current Female  70    3742    1
1176 4500  Current Female  70    3600    0
1177 4680  Current Female  70    3364    2
1178 4860  Current Female  70    3199    1
1179 5040  Current Female  70    2852    0
1180 5220  Current Female  70    2020    3
1181 5400  Current Female  70     820    1
1182 5580  Current Female  70     313    0
1183 5760  Current Female  70      69    0
1184    0 Previous Female  70   25809   29
1185  180 Previous Female  70   24420    4
1186  360 Previous Female  70   23544    5
1187  540 Previous Female  70   22035    8
1188  720 Previous Female  70   21340    3
1189  900 Previous Female  70   20345    8
1190 1080 Previous Female  70   19620    0
1191 1260 Previous Female  70   19308    2
1192 1440 Previous Female  70   18705    7
1193 1620 Previous Female  70   17419    7
1194 1800 Previous Female  70   15529   10
1195 1980 Previous Female  70   14921    2
1196 2160 Previous Female  70   13976    5
1197 2340 Previous Female  70   13498    4
1198 2520 Previous Female  70   12663    2
1199 2700 Previous Female  70   12375    4
1200 2880 Previous Female  70   11148    5
1201 3060 Previous Female  70   10564    4
1202 3240 Previous Female  70   10143    2
1203 3420 Previous Female  70    9823    1
1204 3600 Previous Female  70    9507    2
1205 3780 Previous Female  70    9360    0
1206 3960 Previous Female  70    8832    4
1207 4140 Previous Female  70    8570    1
1208 4320 Previous Female  70    7935    6
1209 4500 Previous Female  70    7203    1
1210 4680 Previous Female  70    6741    4
1211 4860 Previous Female  70    6289    2
1212 5040 Previous Female  70    5755    0
1213 5220 Previous Female  70    4304    0
1214 5400 Previous Female  70    2861    1
1215 5580 Previous Female  70     913    0
1216 5760 Previous Female  70     132    0
1217    0    Never   Male  70   25331   26
1218  180    Never   Male  70   23422   10
1219  360    Never   Male  70   22210    7
1220  540    Never   Male  70   20948    5
1221  720    Never   Male  70   20339    2
1222  900    Never   Male  70   20063    3
1223 1080    Never   Male  70   19120    6
1224 1260    Never   Male  70   18140    4
1225 1440    Never   Male  70   17677    1
1226 1620    Never   Male  70   17622    1
1227 1800    Never   Male  70   16867    6
1228 1980    Never   Male  70   15732    8
1229 2160    Never   Male  70   14629    3
1230 2340    Never   Male  70   13376    7
1231 2520    Never   Male  70   12693    4
1232 2700    Never   Male  70   11961    4
1233 2880    Never   Male  70   11128    5
1234 3060    Never   Male  70   10554    4
1235 3240    Never   Male  70    9587    4
1236 3420    Never   Male  70    8821    6
1237 3600    Never   Male  70    8272    1
1238 3780    Never   Male  70    7870    2
1239 3960    Never   Male  70    7399    4
1240 4140    Never   Male  70    6816    2
1241 4320    Never   Male  70    6660    0
1242 4500    Never   Male  70    6660    0
1243 4680    Never   Male  70    6616    2
1244 4860    Never   Male  70    6223    2
1245 5040    Never   Male  70    5430    1
1246 5220    Never   Male  70    4056    1
1247 5400    Never   Male  70    2226    2
1248 5580    Never   Male  70     847    0
1249 5760    Never   Male  70      26    0
1250    0  Current   Male  70   35036   45
1251  180  Current   Male  70   32102   13
1252  360  Current   Male  70   30340    6
1253  540  Current   Male  70   29246    4
1254  720  Current   Male  70   28387    7
1255  900  Current   Male  70   27529    3
1256 1080  Current   Male  70   26343    8
1257 1260  Current   Male  70   25337    5
1258 1440  Current   Male  70   24324    5
1259 1620  Current   Male  70   23557    4
1260 1800  Current   Male  70   22150    9
1261 1980  Current   Male  70   21046    4
1262 2160  Current   Male  70   20374    5
1263 2340  Current   Male  70   19235    7
1264 2520  Current   Male  70   18039    8
1265 2700  Current   Male  70   17088    2
1266 2880  Current   Male  70   16178    9
1267 3060  Current   Male  70   15300    0
1268 3240  Current   Male  70   14936    5
1269 3420  Current   Male  70   14197    4
1270 3600  Current   Male  70   13269    4
1271 3780  Current   Male  70   12232    7
1272 3960  Current   Male  70   11118    7
1273 4140  Current   Male  70   10370    2
1274 4320  Current   Male  70    9581    7
1275 4500  Current   Male  70    8293    6
1276 4680  Current   Male  70    7438    3
1277 4860  Current   Male  70    7087    2
1278 5040  Current   Male  70    5920    3
1279 5220  Current   Male  70    4024    2
1280 5400  Current   Male  70    2651    2
1281 5580  Current   Male  70    1034    0
1282 5760  Current   Male  70     153    0
1283    0 Previous   Male  70   60809   60
1284  180 Previous   Male  70   55997   23
1285  360 Previous   Male  70   51604   23
1286  540 Previous   Male  70   48552   11
1287  720 Previous   Male  70   45886   18
1288  900 Previous   Male  70   44062    5
1289 1080 Previous   Male  70   42042   15
1290 1260 Previous   Male  70   40003    9
1291 1440 Previous   Male  70   38680    8
1292 1620 Previous   Male  70   37053   11
1293 1800 Previous   Male  70   35132    7
1294 1980 Previous   Male  70   34000    8
1295 2160 Previous   Male  70   32038   11
1296 2340 Previous   Male  70   30299    9
1297 2520 Previous   Male  70   28829   10
1298 2700 Previous   Male  70   27051    7
1299 2880 Previous   Male  70   25473    8
1300 3060 Previous   Male  70   24143    8
1301 3240 Previous   Male  70   22733    9
1302 3420 Previous   Male  70   21332    7
1303 3600 Previous   Male  70   20094    6
1304 3780 Previous   Male  70   18822    8
1305 3960 Previous   Male  70   17269   11
1306 4140 Previous   Male  70   15764    6
1307 4320 Previous   Male  70   14698    4
1308 4500 Previous   Male  70   14100    3
1309 4680 Previous   Male  70   13332    6
1310 4860 Previous   Male  70   11973    8
1311 5040 Previous   Male  70    9553    7
1312 5220 Previous   Male  70    5834    0
1313 5400 Previous   Male  70    2901    2
1314 5580 Previous   Male  70     784    1
1315 5760 Previous   Male  70      90    0
1316    0    Never Female  75   26170   43
1317  180    Never Female  75   24389    7
1318  360    Never Female  75   22720   10
1319  540    Never Female  75   20328   14
1320  720    Never Female  75   18776    6
1321  900    Never Female  75   17284   10
1322 1080    Never Female  75   15909    6
1323 1260    Never Female  75   14935    4
1324 1440    Never Female  75   14399    2
1325 1620    Never Female  75   14178    1
1326 1800    Never Female  75   13167    7
1327 1980    Never Female  75   12620    2
1328 2160    Never Female  75   11840    4
1329 2340    Never Female  75   11306    4
1330 2520    Never Female  75   10814    2
1331 2700    Never Female  75   10451    1
1332 2880    Never Female  75   10113    8
1333 3060    Never Female  75    8370    7
1334 3240    Never Female  75    7353    3
1335 3420    Never Female  75    7200    0
1336 3600    Never Female  75    7200    0
1337 3780    Never Female  75    6897    3
1338 3960    Never Female  75    6331    3
1339 4140    Never Female  75    5993    2
1340 4320    Never Female  75    5669    1
1341 4500    Never Female  75    5244    2
1342 4680    Never Female  75    4999    3
1343 4860    Never Female  75    4411    2
1344 5040    Never Female  75    3980    0
1345 5220    Never Female  75    2945    2
1346 5400    Never Female  75    2079    0
1347 5580    Never Female  75    1022    0
1348 5760    Never Female  75     121    0
1349    0  Current Female  75    8234   11
1350  180  Current Female  75    7216    1
1351  360  Current Female  75    7030    2
1352  540  Current Female  75    6634    2
1353  720  Current Female  75    6421    2
1354  900  Current Female  75    5890    2
1355 1080  Current Female  75    5760    0
1356 1260  Current Female  75    5760    0
1357 1440  Current Female  75    5268    5
1358 1620  Current Female  75    4631    2
1359 1800  Current Female  75    4104    3
1360 1980  Current Female  75    3815    1
1361 2160  Current Female  75    3642    2
1362 2340  Current Female  75    3420    0
1363 2520  Current Female  75    3420    0
1364 2700  Current Female  75    3420    0
1365 2880  Current Female  75    3295    2
1366 3060  Current Female  75    3060    0
1367 3240  Current Female  75    2551    4
1368 3420  Current Female  75    2340    0
1369 3600  Current Female  75    2114    2
1370 3780  Current Female  75    1980    0
1371 3960  Current Female  75    1843    2
1372 4140  Current Female  75    1441    1
1373 4320  Current Female  75    1440    0
1374 4500  Current Female  75    1179    2
1375 4680  Current Female  75     924    2
1376 4860  Current Female  75     720    0
1377 5040  Current Female  75     435    1
1378 5220  Current Female  75      61    0
1379    0 Previous Female  75   20981   29
1380  180 Previous Female  75   18720    8
1381  360 Previous Female  75   17711    5
1382  540 Previous Female  75   16627    3
1383  720 Previous Female  75   16078    6
1384  900 Previous Female  75   14982    5
1385 1080 Previous Female  75   14264    5
1386 1260 Previous Female  75   13679    1
1387 1440 Previous Female  75   13073    3
1388 1620 Previous Female  75   12854    3
1389 1800 Previous Female  75   12378    2
1390 1980 Previous Female  75   11652    5
1391 2160 Previous Female  75   10894    3
1392 2340 Previous Female  75   10444    3
1393 2520 Previous Female  75    9959    1
1394 2700 Previous Female  75    9045    7
1395 2880 Previous Female  75    8449    5
1396 3060 Previous Female  75    7727    1
1397 3240 Previous Female  75    7337    3
1398 3420 Previous Female  75    6839    3
1399 3600 Previous Female  75    6218    2
1400 3780 Previous Female  75    6051    2
1401 3960 Previous Female  75    5258    5
1402 4140 Previous Female  75    4743    2
1403 4320 Previous Female  75    4500    0
1404 4500 Previous Female  75    4397    2
1405 4680 Previous Female  75    3993    1
1406 4860 Previous Female  75    3914    1
1407 5040 Previous Female  75    3221    0
1408 5220 Previous Female  75    2010    1
1409 5400 Previous Female  75    1012    2
1410 5580 Previous Female  75     392    0
1411 5760 Previous Female  75      11    0
1412    0    Never   Male  75   21907   37
1413  180    Never   Male  75   20288    5
1414  360    Never   Male  75   19135    7
1415  540    Never   Male  75   17742    9
1416  720    Never   Male  75   16440    5
1417  900    Never   Male  75   15117   13
1418 1080    Never   Male  75   13086    7
1419 1260    Never   Male  75   12286    1
1420 1440    Never   Male  75   11994    5
1421 1620    Never   Male  75   11340    0
1422 1800    Never   Male  75   10965    4
1423 1980    Never   Male  75   10156    5
1424 2160    Never   Male  75    9435    4
1425 2340    Never   Male  75    8831    1
1426 2520    Never   Male  75    8484    4
1427 2700    Never   Male  75    7595    5
1428 2880    Never   Male  75    6731    5
1429 3060    Never   Male  75    6068    2
1430 3240    Never   Male  75    5746    3
1431 3420    Never   Male  75    4695    7
1432 3600    Never   Male  75    3950    4
1433 3780    Never   Male  75    3174    3
1434 3960    Never   Male  75    2477    3
1435 4140    Never   Male  75    2192    1
1436 4320    Never   Male  75    2160    0
1437 4500    Never   Male  75    2008    1
1438 4680    Never   Male  75    1882    2
1439 4860    Never   Male  75    1620    0
1440 5040    Never   Male  75    1514    0
1441 5220    Never   Male  75     921    1
1442 5400    Never   Male  75     360    0
1443 5580    Never   Male  75     227    1
1444    0  Current   Male  75   31192   54
1445  180  Current   Male  75   27831   15
1446  360  Current   Male  75   25029   13
1447  540  Current   Male  75   23637    9
1448  720  Current   Male  75   21723    9
1449  900  Current   Male  75   19895    9
1450 1080  Current   Male  75   18618    7
1451 1260  Current   Male  75   17083    9
1452 1440  Current   Male  75   15287    8
1453 1620  Current   Male  75   14531    7
1454 1800  Current   Male  75   13349    3
1455 1980  Current   Male  75   12744    4
1456 2160  Current   Male  75   11691   11
1457 2340  Current   Male  75    9612    7
1458 2520  Current   Male  75    8793    4
1459 2700  Current   Male  75    8251    2
1460 2880  Current   Male  75    7796    3
1461 3060  Current   Male  75    7268    3
1462 3240  Current   Male  75    6606    6
1463 3420  Current   Male  75    5185    7
1464 3600  Current   Male  75    4531    2
1465 3780  Current   Male  75    4183    2
1466 3960  Current   Male  75    3815    2
1467 4140  Current   Male  75    3234    4
1468 4320  Current   Male  75    2868    1
1469 4500  Current   Male  75    2494    3
1470 4680  Current   Male  75    2113    1
1471 4860  Current   Male  75    1980    0
1472 5040  Current   Male  75    1714    1
1473 5220  Current   Male  75    1308    1
1474 5400  Current   Male  75     932    0
1475 5580  Current   Male  75     365    0
1476 5760  Current   Male  75      80    0
1477    0 Previous   Male  75   36634   62
1478  180 Previous   Male  75   31998   15
1479  360 Previous   Male  75   29932    8
1480  540 Previous   Male  75   29155    9
1481  720 Previous   Male  75   26853   12
1482  900 Previous   Male  75   24796    8
1483 1080 Previous   Male  75   23246   11
1484 1260 Previous   Male  75   21501    8
1485 1440 Previous   Male  75   20503    4
1486 1620 Previous   Male  75   19546   10
1487 1800 Previous   Male  75   17695    8
1488 1980 Previous   Male  75   16195   10
1489 2160 Previous   Male  75   14749    5
1490 2340 Previous   Male  75   13467    8
1491 2520 Previous   Male  75   12275    5
1492 2700 Previous   Male  75   11555    4
1493 2880 Previous   Male  75   10188   10
1494 3060 Previous   Male  75    8743    5
1495 3240 Previous   Male  75    7913    5
1496 3420 Previous   Male  75    7225    4
1497 3600 Previous   Male  75    6810    1
1498 3780 Previous   Male  75    6177    5
1499 3960 Previous   Male  75    5475    2
1500 4140 Previous   Male  75    5063    4
1501 4320 Previous   Male  75    4505    3
1502 4500 Previous   Male  75    4110    1
1503 4680 Previous   Male  75    3831    2
1504 4860 Previous   Male  75    3474    2
1505 5040 Previous   Male  75    3108    0
1506 5220 Previous   Male  75    2309    2
1507 5400 Previous   Male  75    1253    0
1508 5580 Previous   Male  75     380    0
1509    0    Never Female  80   30132   57
1510  180    Never Female  80   27079   14
1511  360    Never Female  80   24683   12
1512  540    Never Female  80   22777   11
1513  720    Never Female  80   20760    9
1514  900    Never Female  80   19562    9
1515 1080    Never Female  80   17915    6
1516 1260    Never Female  80   16971    8
1517 1440    Never Female  80   15326    6
1518 1620    Never Female  80   14322    9
1519 1800    Never Female  80   12603    9
1520 1980    Never Female  80   11373    3
1521 2160    Never Female  80   10326    6
1522 2340    Never Female  80    9621    4
1523 2520    Never Female  80    9039    3
1524 2700    Never Female  80    8320    6
1525 2880    Never Female  80    7439    4
1526 3060    Never Female  80    6544    5
1527 3240    Never Female  80    5948    2
1528 3420    Never Female  80    5354    4
1529 3600    Never Female  80    4903    1
1530 3780    Never Female  80    4760    2
1531 3960    Never Female  80    4253    3
1532 4140    Never Female  80    3652    5
1533 4320    Never Female  80    2930    1
1534 4500    Never Female  80    2772    1
1535 4680    Never Female  80    2476    3
1536 4860    Never Female  80    2015    2
1537 5040    Never Female  80    1289    3
1538 5220    Never Female  80     660    1
1539 5400    Never Female  80     360    0
1540 5580    Never Female  80     303    1
1541 5760    Never Female  80      31    0
1542    0  Current Female  80    9419   20
1543  180  Current Female  80    8457    3
1544  360  Current Female  80    7713    4
1545  540  Current Female  80    7353    2
1546  720  Current Female  80    6984    1
1547  900  Current Female  80    6564    2
1548 1080  Current Female  80    6268    2
1549 1260  Current Female  80    6100    1
1550 1440  Current Female  80    5704    3
1551 1620  Current Female  80    5237    1
1552 1800  Current Female  80    5220    0
1553 1980  Current Female  80    4597    4
1554 2160  Current Female  80    4223    3
1555 2340  Current Female  80    3636    4
1556 2520  Current Female  80    2890    3
1557 2700  Current Female  80    2700    0
1558 2880  Current Female  80    2700    0
1559 3060  Current Female  80    2553    2
1560 3240  Current Female  80    1883    4
1561 3420  Current Female  80    1620    0
1562 3600  Current Female  80    1620    0
1563 3780  Current Female  80    1620    0
1564 3960  Current Female  80    1468    3
1565 4140  Current Female  80    1080    0
1566 4320  Current Female  80    1080    0
1567 4500  Current Female  80    1080    0
1568 4680  Current Female  80     941    1
1569 4860  Current Female  80     900    0
1570 5040  Current Female  80     900    0
1571 5220  Current Female  80     653    0
1572 5400  Current Female  80     417    1
1573    0 Previous Female  80   14240   27
1574  180 Previous Female  80   12898    6
1575  360 Previous Female  80   12340    2
1576  540 Previous Female  80   11831    3
1577  720 Previous Female  80   11373    1
1578  900 Previous Female  80   11236    3
1579 1080 Previous Female  80   10427    5
1580 1260 Previous Female  80    9473    5
1581 1440 Previous Female  80    8486    6
1582 1620 Previous Female  80    7784    3
1583 1800 Previous Female  80    7302    2
1584 1980 Previous Female  80    6589    3
1585 2160 Previous Female  80    6220    3
1586 2340 Previous Female  80    5689    4
1587 2520 Previous Female  80    4938    3
1588 2700 Previous Female  80    4461    4
1589 2880 Previous Female  80    3676    3
1590 3060 Previous Female  80    2779    5
1591 3240 Previous Female  80    2485    1
1592 3420 Previous Female  80    2166    3
1593 3600 Previous Female  80    1735    1
1594 3780 Previous Female  80    1579    1
1595 3960 Previous Female  80    1281    1
1596 4140 Previous Female  80    1260    0
1597 4320 Previous Female  80    1075    2
1598 4500 Previous Female  80     693    2
1599 4680 Previous Female  80     540    0
1600 4860 Previous Female  80     540    0
1601 5040 Previous Female  80     540    0
1602 5220 Previous Female  80     540    0
1603 5400 Previous Female  80     420    1
1604 5580 Previous Female  80     175    0
1605    0    Never   Male  80   18997   39
1606  180    Never   Male  80   16694    9
1607  360    Never   Male  80   15192    7
1608  540    Never   Male  80   13851    6
1609  720    Never   Male  80   12746    8
1610  900    Never   Male  80   11470    5
1611 1080    Never   Male  80   10770    4
1612 1260    Never   Male  80   10124    4
1613 1440    Never   Male  80    9577    3
1614 1620    Never   Male  80    8457    8
1615 1800    Never   Male  80    7167    4
1616 1980    Never   Male  80    7020    0
1617 2160    Never   Male  80    6892    1
1618 2340    Never   Male  80    6458    3
1619 2520    Never   Male  80    6259    2
1620 2700    Never   Male  80    5557    4
1621 2880    Never   Male  80    4995    2
1622 3060    Never   Male  80    4759    2
1623 3240    Never   Male  80    4287    3
1624 3420    Never   Male  80    3632    3
1625 3600    Never   Male  80    3309    2
1626 3780    Never   Male  80    2788    4
1627 3960    Never   Male  80    2096    2
1628 4140    Never   Male  80    1892    1
1629 4320    Never   Male  80    1616    2
1630 4500    Never   Male  80    1350    1
1631 4680    Never   Male  80     820    3
1632 4860    Never   Male  80     720    0
1633 5040    Never   Male  80     655    0
1634 5220    Never   Male  80     519    0
1635 5400    Never   Male  80     308    1
1636 5580    Never   Male  80     106    0
1637    0  Current   Male  80   22681   46
1638  180  Current   Male  80   19852   11
1639  360  Current   Male  80   17814    9
1640  540  Current   Male  80   16286    9
1641  720  Current   Male  80   14505    9
1642  900  Current   Male  80   13304    8
1643 1080  Current   Male  80   11766    7
1644 1260  Current   Male  80   10893    3
1645 1440  Current   Male  80    9765    8
1646 1620  Current   Male  80    8586    4
1647 1800  Current   Male  80    8320    4
1648 1980  Current   Male  80    7476    2
1649 2160  Current   Male  80    7044    3
1650 2340  Current   Male  80    6502    4
1651 2520  Current   Male  80    6086    1
1652 2700  Current   Male  80    5749    3
1653 2880  Current   Male  80    5076    4
1654 3060  Current   Male  80    4633    1
1655 3240  Current   Male  80    4246    2
1656 3420  Current   Male  80    3870    2
1657 3600  Current   Male  80    3447    2
1658 3780  Current   Male  80    2766    6
1659 3960  Current   Male  80    2094    4
1660 4140  Current   Male  80    1524    1
1661 4320  Current   Male  80    1398    1
1662 4500  Current   Male  80    1102    1
1663 4680  Current   Male  80     813    2
1664 4860  Current   Male  80     639    1
1665 5040  Current   Male  80     451    0
1666 5220  Current   Male  80      40    0
1667    0 Previous   Male  80   20278   47
1668  180 Previous   Male  80   17855    9
1669  360 Previous   Male  80   15960   14
1670  540 Previous   Male  80   14492    1
1671  720 Previous   Male  80   14112    3
1672  900 Previous   Male  80   13208    7
1673 1080 Previous   Male  80   11764    8
1674 1260 Previous   Male  80   10993    3
1675 1440 Previous   Male  80   10280    2
1676 1620 Previous   Male  80    9884    5
1677 1800 Previous   Male  80    9065    4
1678 1980 Previous   Male  80    8445    3
1679 2160 Previous   Male  80    7359    6
1680 2340 Previous   Male  80    6348    6
1681 2520 Previous   Male  80    5219    5
1682 2700 Previous   Male  80    4855    3
1683 2880 Previous   Male  80    4323    2
1684 3060 Previous   Male  80    3379    6
1685 3240 Previous   Male  80    2869    2
1686 3420 Previous   Male  80    2600    1
1687 3600 Previous   Male  80    2324    3
1688 3780 Previous   Male  80    1811    2
1689 3960 Previous   Male  80    1620    0
1690 4140 Previous   Male  80    1468    2
1691 4320 Previous   Male  80    1152    1
1692 4500 Previous   Male  80    1080    0
1693 4680 Previous   Male  80     865    2
1694 4860 Previous   Male  80     720    0
1695 5040 Previous   Male  80     676    0
1696 5220 Previous   Male  80     432    1
1697 5400 Previous   Male  80     207    1
1698 5580 Previous   Male  80     180    0
1699 5760 Previous   Male  80      81    0
1700    0    Never Female  85   22013   75
1701  180    Never Female  85   18742   19
1702  360    Never Female  85   15910    9
1703  540    Never Female  85   13930    9
1704  720    Never Female  85   12471   10
1705  900    Never Female  85   11074    8
1706 1080    Never Female  85    9939    5
1707 1260    Never Female  85    8892    7
1708 1440    Never Female  85    7590    6
1709 1620    Never Female  85    6702    3
1710 1800    Never Female  85    6380    1
1711 1980    Never Female  85    6152    2
1712 2160    Never Female  85    5418    5
1713 2340    Never Female  85    4823    4
1714 2520    Never Female  85    4270    1
1715 2700    Never Female  85    3862    4
1716 2880    Never Female  85    3420    0
1717 3060    Never Female  85    3150    2
1718 3240    Never Female  85    2952    1
1719 3420    Never Female  85    2664    2
1720 3600    Never Female  85    2112    3
1721 3780    Never Female  85    1980    0
1722 3960    Never Female  85    1775    2
1723 4140    Never Female  85    1620    0
1724 4320    Never Female  85    1483    1
1725 4500    Never Female  85    1421    1
1726 4680    Never Female  85    1174    1
1727 4860    Never Female  85    1023    1
1728 5040    Never Female  85     764    1
1729 5220    Never Female  85     432    2
1730 5400    Never Female  85      41    0
1731    0  Current Female  85    3976   25
1732  180  Current Female  85    2447    6
1733  360  Current Female  85    1823    4
1734  540  Current Female  85    1137    1
1735  720  Current Female  85    1080    0
1736  900  Current Female  85     859    2
1737 1080  Current Female  85     720    0
1738 1260  Current Female  85     427    2
1739 1440  Current Female  85     360    0
1740 1620  Current Female  85     305    1
1741 1800  Current Female  85      68    1
1742    0 Previous Female  85    5450   15
1743  180 Previous Female  85    4390    7
1744  360 Previous Female  85    3540    2
1745  540 Previous Female  85    3254    1
1746  720 Previous Female  85    3152    1
1747  900 Previous Female  85    2966    1
1748 1080 Previous Female  85    2710    1
1749 1260 Previous Female  85    2700    0
1750 1440 Previous Female  85    2700    0
1751 1620 Previous Female  85    2657    1
1752 1800 Previous Female  85    2346    1
1753 1980 Previous Female  85    2298    2
1754 2160 Previous Female  85    1980    0
1755 2340 Previous Female  85    1938    3
1756 2520 Previous Female  85    1411    1
1757 2700 Previous Female  85    1097    2
1758 2880 Previous Female  85     900    0
1759 3060 Previous Female  85     890    1
1760 3240 Previous Female  85     720    0
1761 3420 Previous Female  85     561    1
1762 3600 Previous Female  85     540    0
1763 3780 Previous Female  85     540    0
1764 3960 Previous Female  85     540    0
1765 4140 Previous Female  85     368    1
1766 4320 Previous Female  85     360    0
1767 4500 Previous Female  85     360    0
1768 4680 Previous Female  85     200    1
1769 4860 Previous Female  85     180    0
1770 5040 Previous Female  85      23    0
1771    0    Never   Male  85    9441   27
1772  180    Never   Male  85    7697    5
1773  360    Never   Male  85    6952    5
1774  540    Never   Male  85    5981    4
1775  720    Never   Male  85    4916    7
1776  900    Never   Male  85    3856    3
1777 1080    Never   Male  85    3627    2
1778 1260    Never   Male  85    3108    3
1779 1440    Never   Male  85    2649    2
1780 1620    Never   Male  85    2520    0
1781 1800    Never   Male  85    2374    1
1782 1980    Never   Male  85    2340    0
1783 2160    Never   Male  85    2201    1
1784 2340    Never   Male  85    2144    1
1785 2520    Never   Male  85    1853    1
1786 2700    Never   Male  85    1800    0
1787 2880    Never   Male  85    1800    0
1788 3060    Never   Male  85    1790    1
1789 3240    Never   Male  85    1287    3
1790 3420    Never   Male  85    1027    3
1791 3600    Never   Male  85     540    0
1792 3780    Never   Male  85     394    1
1793 3960    Never   Male  85     360    0
1794 4140    Never   Male  85     227    1
1795 4320    Never   Male  85     180    0
1796 4500    Never   Male  85      91    1
1797    0  Current   Male  85    8324   20
1798  180  Current   Male  85    6806    8
1799  360  Current   Male  85    5876    5
1800  540  Current   Male  85    4739    5
1801  720  Current   Male  85    3741    5
1802  900  Current   Male  85    2976    3
1803 1080  Current   Male  85    2624    4
1804 1260  Current   Male  85    1892    5
1805 1440  Current   Male  85    1260    0
1806 1620  Current   Male  85    1260    0
1807 1800  Current   Male  85    1137    1
1808 1980  Current   Male  85     857    2
1809 2160  Current   Male  85     455    2
1810 2340  Current   Male  85     360    0
1811 2520  Current   Male  85     165    2
1812    0 Previous   Male  85    6947   23
1813  180 Previous   Male  85    5814    4
1814  360 Previous   Male  85    5172    2
1815  540 Previous   Male  85    4424    6
1816  720 Previous   Male  85    3637    5
1817  900 Previous   Male  85    2830    2
1818 1080 Previous   Male  85    2501    2
1819 1260 Previous   Male  85    2318    1
1820 1440 Previous   Male  85    2065    2
1821 1620 Previous   Male  85    1242    5
1822 1800 Previous   Male  85     778    1
1823 1980 Previous   Male  85     720    0
1824 2160 Previous   Male  85     720    0
1825 2340 Previous   Male  85     720    0
1826 2520 Previous   Male  85     656    1
1827 2700 Previous   Male  85     540    0
1828 2880 Previous   Male  85     327    2
1829 3060 Previous   Male  85     180    0
1830 3240 Previous   Male  85     180    0
1831 3420 Previous   Male  85     180    0
1832 3600 Previous   Male  85      98    1
> fit <- glm(dead ~ smoking+sex+age+Time+offset(log(ObsTime)), family="poisson",data=trace)
> rtf <- regressionTable(fit,factor.reference = "inline")
> summary(rtf)
  Variable             Units HazardRatio       CI.95   p-value
1  smoking  Current vs Never        1.09 [1.01;1.19]   0.02863
2          Previous vs Never        1.08 [1.00;1.16]   0.04139
3      sex    Male vs Female        1.09 [1.02;1.16]   0.00632
4      age                          1.07 [1.07;1.08]   < 0.001
5     Time                          1.00 [1.00;1.00]   < 0.001
  Variable             Units HazardRatio       CI.95   p-value
1  smoking  Current vs Never        1.09 [1.01;1.19]   0.02863
2          Previous vs Never        1.08 [1.00;1.16]   0.04139
3      sex    Male vs Female        1.09 [1.02;1.16]   0.00632
4      age                          1.07 [1.07;1.08]   < 0.001
5     Time                          1.00 [1.00;1.00]   < 0.001
> publish(fit)
 Variable    Units HazardRatio       CI.95    p-value 
  smoking    Never         Ref                        
           Current        1.09 [1.01;1.19]   0.028634 
          Previous        1.08 [1.00;1.16]   0.041394 
      sex   Female         Ref                        
              Male        1.09 [1.02;1.16]   0.006317 
      age                 1.07 [1.07;1.08]    < 1e-04 
     Time                 1.00 [1.00;1.00]    < 1e-04 
> 
> 
> 
> 
> cleanEx()
> nameEx("univariateTable")
> ### * univariateTable
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: univariateTable
> ### Title: Univariate table
> ### Aliases: univariateTable utable
> 
> ### ** Examples
> 
> data(Diabetes)
> univariateTable(~age,data=Diabetes)
  Variable     Level       Total
1      age mean (sd) 46.9 (16.3)
> univariateTable(~gender,data=Diabetes)
  Variable  Level      Total
1   gender female 234 (58.1)
2            male 169 (41.9)
> univariateTable(~age+gender+ height+weight,data=Diabetes)
  Variable     Level        Total
1      age mean (sd)  46.9 (16.3)
2   gender    female   234 (58.1)
3               male   169 (41.9)
4   height mean (sd)   66.0 (3.9)
5            missing            5
6   weight mean (sd) 177.6 (40.3)
7            missing            1
> ## same thing but less typing
> utable(~age+gender+ height+weight,data=Diabetes)
  Variable     Level        Total
1      age mean (sd)  46.9 (16.3)
2   gender    female   234 (58.1)
3               male   169 (41.9)
4   height mean (sd)   66.0 (3.9)
5            missing            5
6   weight mean (sd) 177.6 (40.3)
7            missing            1
> 
> ## summary by location: 
> univariateTable(location~Q(age)+gender+height+weight,data=Diabetes)
  Variable        Level Buckingham (n=200)    Louisa (n=203)     Total (n=403)
1      age median [iqr]  45.5 [33.0, 61.0] 44.0 [35.0, 59.0] 45.0 [34.0, 60.0]
2   gender       female         114 (57.0)        120 (59.1)        234 (58.1)
3                  male          86 (43.0)         83 (40.9)        169 (41.9)
4   height    mean (sd)         66.5 (4.0)        65.6 (3.8)        66.0 (3.9)
5               missing                  3                 2                 5
6   weight    mean (sd)       178.7 (43.8)      176.5 (36.7)      177.6 (40.3)
7               missing                  0                 1                 1
  p-value
1 0.79051
2        
3 0.74223
4 0.01549
5        
6 0.58067
7        
> ## continuous variables marked with Q() are (by default) summarized
> ## with median (IQR) and kruskal.test (with two groups equivalent to wilcox.test)
> ## variables not marked with Q() are (by default) summarized
> ## with mean (sd) and anova.glm(...,test="Chisq")
> ## the p-value of anova.glm with only two groups is similar
> ## but not exactly equal to that of a t.test
> ## categorical variables are (by default) summarized by count
> ## (percent) and anova.glm(...,family=binomial,test="Chisq")
> 
> ## export result to csv
> table1 = summary(univariateTable(location~age+gender+height+weight,data=Diabetes),
+ show.pvalues=FALSE)
> # write.csv(table1,file="~/table1.csv",rownames=FALSE)
> 
> ## change labels and values
> utable(location~age+gender+height+weight,data=Diabetes,
+        age="Age (years)",gender="Sex",
+        gender.female="Female",
+        gender.male="Male",
+        height="Body height (inches)",
+        weight="Body weight (pounds)")
              Variable     Level Buckingham (n=200) Louisa (n=203)
1          Age (years) mean (sd)        47.1 (16.7)    46.6 (15.9)
2                  Sex    Female         114 (57.0)     120 (59.1)
3                           Male          86 (43.0)      83 (40.9)
4 Body height (inches) mean (sd)         66.5 (4.0)     65.6 (3.8)
5                        missing                  3              2
6 Body weight (pounds) mean (sd)       178.7 (43.8)   176.5 (36.7)
7                        missing                  0              1
  Total (n=403) p-value
1   46.9 (16.3) 0.78473
2    234 (58.1)        
3    169 (41.9) 0.74223
4    66.0 (3.9) 0.01549
5             5        
6  177.6 (40.3) 0.58067
7             1        
> 
> ## Use quantiles and rank tests for some variables and mean and standard deviation for others
> univariateTable(gender~Q(age)+location+Q(BMI)+height+weight,
+                 data=Diabetes)
  Variable        Level    female (n=234)      male (n=169)     Total (n=403)
1      age median [iqr] 43.0 [32.2, 59.0] 48.0 [36.0, 61.0] 45.0 [34.0, 60.0]
2 location   Buckingham        114 (48.7)         86 (50.9)        200 (49.6)
3                Louisa        120 (51.3)         83 (49.1)        203 (50.4)
4      BMI median [iqr] 29.5 [25.4, 34.0] 25.9 [23.1, 30.1] 27.8 [24.1, 32.2]
5               missing                 5                 1                 6
6   height    mean (sd)        63.7 (2.8)        69.1 (2.9)        66.0 (3.9)
7               missing                 5                 0                 5
8   weight    mean (sd)      174.5 (41.2)      181.9 (38.8)      177.6 (40.3)
9               missing                 0                 1                 1
  p-value
1 0.11817
2        
3 0.74223
4 < 1e-04
5        
6 < 1e-04
7        
8 0.06777
9        
> 
> ## Factor with more than 2 levels
> Diabetes$AgeGroups <- cut(Diabetes$age,
+                           c(19,29,39,49,59,69,92),
+                           include.lowest=TRUE)
> univariateTable(location~AgeGroups+gender+height+weight,
+                 data=Diabetes)
    Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1  AgeGroups   [19,29]          35 (17.5)      31 (15.3)     66 (16.4)        
2              (29,39]          36 (18.0)      42 (20.7)     78 (19.4)        
3              (39,49]          45 (22.5)      43 (21.2)     88 (21.8)        
4              (49,59]          31 (15.5)      38 (18.7)     69 (17.1)        
5              (59,69]          30 (15.0)      32 (15.8)     62 (15.4)        
6              (69,92]          23 (11.5)       17 (8.4)      40 (9.9) 0.79119
7     gender    female         114 (57.0)     120 (59.1)    234 (58.1)        
8                 male          86 (43.0)      83 (40.9)    169 (41.9) 0.74223
9     height mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9) 0.01549
10             missing                  3              2             5        
11    weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3) 0.58067
12             missing                  0              1             1        
> 
> ## Row percent
> univariateTable(location~gender+age+AgeGroups,
+                 data=Diabetes,
+                 column.percent=FALSE)
   Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1    gender    female         114 (48.7)     120 (51.3)   234 (100.0)        
2                male          86 (50.9)      83 (49.1)   169 (100.0)  0.7422
3       age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3)  0.7847
4 AgeGroups   [19,29]          35 (53.0)      31 (47.0)    66 (100.0)        
5             (29,39]          36 (46.2)      42 (53.8)    78 (100.0)        
6             (39,49]          45 (51.1)      43 (48.9)    88 (100.0)        
7             (49,59]          31 (44.9)      38 (55.1)    69 (100.0)        
8             (59,69]          30 (48.4)      32 (51.6)    62 (100.0)        
9             (69,92]          23 (57.5)      17 (42.5)    40 (100.0)  0.7912
> 
> ## change of frequency format
> univariateTable(location~gender+age+AgeGroups,
+                 data=Diabetes,
+                 column.percent=FALSE,
+                 freq.format="percent(x) (n=count(x))")
   Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403) p-value
1    gender    female       48.7 (n=114)   51.3 (n=120) 100.0 (n=234)        
2                male        50.9 (n=86)    49.1 (n=83) 100.0 (n=169)  0.7422
3       age mean (sd)        47.1 (16.7)    46.6 (15.9)   46.9 (16.3)  0.7847
4 AgeGroups   [19,29]        53.0 (n=35)    47.0 (n=31)  100.0 (n=66)        
5             (29,39]        46.2 (n=36)    53.8 (n=42)  100.0 (n=78)        
6             (39,49]        51.1 (n=45)    48.9 (n=43)  100.0 (n=88)        
7             (49,59]        44.9 (n=31)    55.1 (n=38)  100.0 (n=69)        
8             (59,69]        48.4 (n=30)    51.6 (n=32)  100.0 (n=62)        
9             (69,92]        57.5 (n=23)    42.5 (n=17)  100.0 (n=40)  0.7912
> 
> ## changing Labels
> u <- univariateTable(location~gender+AgeGroups+ height + weight,
+                      data=Diabetes,
+                      column.percent=TRUE,
+                      freq.format="count(x) (percent(x))")
> summary(u,"AgeGroups"="Age (years)","height"="Height (inches)")
          Variable     Level Buckingham (n=200) Louisa (n=203) Total (n=403)
1           gender    female         114 (57.0)     120 (59.1)    234 (58.1)
2                       male          86 (43.0)      83 (40.9)    169 (41.9)
3      Age (years)   [19,29]          35 (17.5)      31 (15.3)     66 (16.4)
4                    (29,39]          36 (18.0)      42 (20.7)     78 (19.4)
5                    (39,49]          45 (22.5)      43 (21.2)     88 (21.8)
6                    (49,59]          31 (15.5)      38 (18.7)     69 (17.1)
7                    (59,69]          30 (15.0)      32 (15.8)     62 (15.4)
8                    (69,92]          23 (11.5)       17 (8.4)      40 (9.9)
9  Height (inches) mean (sd)         66.5 (4.0)     65.6 (3.8)    66.0 (3.9)
10                   missing                  3              2             5
11          weight mean (sd)       178.7 (43.8)   176.5 (36.7)  177.6 (40.3)
12                   missing                  0              1             1
   p-value
1         
2  0.74223
3         
4         
5         
6         
7         
8  0.79119
9  0.01549
10        
11 0.58067
12        
> 
> ## more than two groups
> Diabetes$frame=factor(Diabetes$frame,levels=c("small","medium","large"))
> univariateTable(frame~gender+BMI+age,data=Diabetes)
  Variable     Level small (n=104) medium (n=184) large (n=103) Missing (n=12)
1   gender    female     69 (66.3)     116 (63.0)     42 (40.8)       7 (58.3)
2               male     35 (33.7)      68 (37.0)     61 (59.2)       5 (41.7)
3      BMI mean (sd)    24.5 (5.4)     29.2 (5.7)    32.4 (7.0)     29.5 (6.0)
4            missing             2              1             2              1
5      age mean (sd)   42.2 (15.5)    45.7 (15.4)   52.8 (15.8)    53.2 (24.7)
  Total (n=403)   p-value
1    234 (58.1)          
2    169 (41.9) 0.0005723
3    28.8 (6.6)   < 1e-04
4             6          
5   46.9 (16.3)   < 1e-04
> 
> Diabetes$sex=as.numeric(Diabetes$gender)
> univariateTable(frame~sex+gender+BMI+age,
+                 data=Diabetes,freq.format="count(x) (percent(x))")
  Variable     Level small (n=104) medium (n=184) large (n=103) Missing (n=12)
1      sex         1     69 (66.3)     116 (63.0)     42 (40.8)       7 (58.3)
2                  2     35 (33.7)      68 (37.0)     61 (59.2)       5 (41.7)
3   gender    female     69 (66.3)     116 (63.0)     42 (40.8)       7 (58.3)
4               male     35 (33.7)      68 (37.0)     61 (59.2)       5 (41.7)
5      BMI mean (sd)    24.5 (5.4)     29.2 (5.7)    32.4 (7.0)     29.5 (6.0)
6            missing             2              1             2              1
7      age mean (sd)   42.2 (15.5)    45.7 (15.4)   52.8 (15.8)    53.2 (24.7)
  Total (n=403)   p-value
1    234 (58.1)          
2    169 (41.9) 0.0005723
3    234 (58.1)          
4    169 (41.9) 0.0005723
5    28.8 (6.6)   < 1e-04
6             6          
7   46.9 (16.3)   < 1e-04
> 
> ## multiple summary formats
> ## suppose we want for some reason mean (range) for age
> ## and median (range) for BMI.
> ## method 1:
> univariateTable(frame~Q(age)+BMI,
+                 data=Diabetes,
+                 Q.format="mean(x) (range(x))",
+                 summary.format="median(x) (range(x))")
  Variable          Level     small (n=104)    medium (n=184)     large (n=103)
1      age   mean (range) 42.2 (19.0, 84.0) 45.7 (19.0, 89.0) 52.8 (21.0, 92.0)
2      BMI median (range) 23.5 (15.2, 41.7) 28.7 (17.2, 48.6) 30.8 (18.6, 55.8)
3                 missing                 2                 1                 2
     Missing (n=12)     Total (n=403) p-value
1 53.2 (23.0, 91.0) 46.9 (19.0, 92.0) < 1e-04
2 26.9 (23.7, 43.4) 27.8 (15.2, 55.8) < 1e-04
3                 1                 6        
> ## method 2:
> u1 <- summary(univariateTable(frame~age,
+                               data=na.omit(Diabetes),
+                               summary.format="mean(x) (range(x))"))
> u2 <- summary(univariateTable(frame~BMI,
+                               data=na.omit(Diabetes),
+                               summary.format="median(x) (range(x))"))
> publish(rbind(u1,u2),digits=2)
 Variable          Level      small (n=22)     medium (n=72)      large (n=36)     Total (n=130) p-value 
      age   mean (range) 52.7 (20.0, 84.0) 49.2 (20.0, 89.0) 52.7 (23.0, 76.0) 50.8 (20.0, 89.0) 0.41410 
      BMI median (range) 24.6 (17.2, 41.7) 29.0 (17.2, 48.6) 31.9 (22.7, 51.4) 29.7 (17.2, 51.4) 0.00012 
> 
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  3.85 1.92 18.21 NA NA 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
